[ { "title": "Desperate Housewives S01E04", "url": "/posts/english-desperate-housewives-s01e04/", "categories": "English", "tags": "english", "date": "2023-09-20 20:00:00 +0800", "snippet": "Desperate Housewives S01E041–Anybody home?有人在家吗2–Previously on Desperate Housewives《绝望主妇》前情提要3— Susan played with fire… - That’s not my cup.-苏珊玩火 -那不是我的4–And could get burned.最终可能会引火上身5–Go to a spa, go shopping. Find a way to relax.做水疗也好 购物也好 总之放松放松6— Gabrielle… - Get here as fast as you can.-加布丽尔 -那尽快过来7–found herself a playmate.给自己找了个玩伴8–Lynette couldn’t get her kids to stop playing.勒奈特对调皮的孩子们无计可施9–Ma’am do you know why I pulled you over?夫人 知道我为什么拦你吗10–I have a theory.我知道11–If I don’t get some sleep, I’ll be 如果我还是无法入睡12–forced back upstairs out of exhaustion.我迟早会因为疲劳过度 被迫回楼上去睡13–And Bree played hard ball.而布里耍了狠招14–Everyone has a little dirty laundry.每个人都有不可告人的秘密15–When I was alive, I maintained many different identities.我活着的时候 有着多重社会角色 16–Lover, wife and, ultimately, victim.爱人 妻子 最后变成了受害者17–模范母亲自杀内幕18–Yes, labels are important to the living.是的 一个人的称谓很重要19–They dictate how people see themselves.它决定了人们如何给自己定位20–Like my friend Lynette.比如我的朋友勒奈特21–She used to see herself as a career woman,过去她认为自己是一名职业女性22–and a hugely successful one.一名非常成功的女强人23–She was known for her power lunches,她以处理公事时雷厉风行24–her eye-catching presentations,演示报告时巧舌如簧25–and her ruthlessness in wiping out the competition.挫败对手时冷酷无情而闻名于圈内26–But Lynette gave up her career to assume a new label.但勒奈特放弃了事业 并换上一个全新的 称谓27–The incredibly satisfying role of full-time mother.无比幸福满足的全职太太28–Scavo residence. Yes, this is me.斯加沃家 对 我就是29–But, unfortunately for Lynette,很不幸 对勒奈特而言30–this new label frequently fell short of what was advertised.这个称谓总是有点名不副实31–How in the world did they…?他们究竟…32–I left the door to the art supply 我打开了画具柜33–cupboard open for five minutes.不过 5 分钟而已34— That’s all. - Five minutes.-就变成这样了 -5 分钟35–The little girl, why didn’t she say anything?那个小女孩 她为什么一声不吭呢36–Your boys work quickly.你儿子下手太快37–Well, obviously they will be punished for this severely.我保证他们会得到严厉的惩罚38–I hesitate bringing this up, since you 我本来不想说的39–got so ugly about it last time…因为似乎你对此很敏感 可我认为…40–They don’t have attention deficit disorder,他们没有多动症41–and I won’t drug my boys 我不会为了减轻你的工作负担42–just to make your job easier.而让我的孩子吃药 43–I’d rather change teachers.我宁愿给他们换老师44–The boys are in my class because I’m the 他们之所以在我的班级里45–only teacher who can handle them.因为这所学校只有我能对付他们46–What if we separate the twins,把双胞胎分开47–put them in different classes?放在不同的班级如何48–They’re much calmer when they’re not bouncing off one another.他们不待在一起就会安分许多 49–We can try that, but if it doesn’t work,我们不妨试试 如果还是不奏效50–we may no longer be able to accommodate them.我们只好让他们转学51–It suddenly occurred to Lynette,勒奈特发现52–her label was about to change yet again.在之后的几年53–And for the next few years, she would be known as 她将多一个称谓54–the mother of the boys who painted Tiffany Axelrod blue.那就是 蓝魔爪的妈妈55–It looked to be an interesting afternoon on Wisteria Lane.紫藤郡今天下午会很热闹56–A mysterious cassette tape had 因为在我朋友布里手上57–been discovered by my friend Bree.有一盘关于我的神秘磁带58–She had stolen it from her marriage counselor.那是她从婚姻咨询师那里偷来的59–A counselor I’d once spoken to in strictest confidence.可怜我曾经是那么坚信 秘密绝不会泄露 60–So how have you been?最近你感觉如何61–I had the nightmare again.我又做恶梦了62–It’s weird to hear Mary Alice.听到玛丽·艾莉丝的声音感觉怪怪的63— Still the same one? - Yes.-还是之前那个吗 -是的64–But this time I was standing in a river 不过这次我站在河里65–and I saw the girl under the water.水下有个女孩66–She kept screaming “Angela” over and over again.她不停地叫着”安吉拉”67–What do you think the significance of the name “Angela” is?这个名字有什么特殊意义吗 68–Actually, that’s my real name.事实上 那是我的真名69–Her real name?她的真名70–That doesn’t make any sense.这不可能71–I’ve seen her driver’s license. I did not say Angela.我看过她的驾照 没什么安吉拉72–Bree, what does it say in the rest of the tape?布里 带子里还说了什么73–Just more about her nightmares,全是关于她的恶梦74–and this girl she was afraid of.和这个令她不安的女孩75–So what the hell do we do now?我们该怎么办呢76–I think we should show Paul the note.是时候把字条给保罗看了77–Are you sure? He’s gonna freak.你确定吗 他会抓狂的78–It’s now or never.不然以后就没机会了79–I saw what he’s asking for the place.我看到他为房子开的价80–It’s gonna sell quickly.很快就能卖出去81–Can I say something?我想说82— I’m glad Paul’s moving. - Gaby.-保罗总算要搬走了 -加布83–I’m sorry. He’s just always given me the creeps.抱歉 可他总是让我毛骨悚然84–Haven’t you guys noticed, he has this dark thing going on?不觉得他给人感觉阴森森的吗 85–Something about him just feels…他就是挺…86— Malignant? - Yes.-邪恶 -没错87–We’ve all sort of felt it.看来我们都有同感 88–That being said, I do love what he’s done with that lawn.话虽如此 他打理草坪倒是很在行 89–Mom, the dish is clean.妈 碟子刷得够干净了90–I still don’t understand why you don’t just 我不明白你干嘛91–ask him out on an official date date.不直接约他出去 来个正式约会92–I’m trying a new strategy. I’m playing hard to get.我在尝试一种新战术 吊他胃口 93–How long do you think you can keep that up?你觉得自己能撑多久呢94–Maybe until noon.也许只能撑到中午95–Then I’m going to have to run over there 然后我就会跑去96–and beg him to love me.求他爱上我97–Uh, mom, I don’t think you’re 妈妈 看来98–gonna be able to wait that long.你等不了那么久99–You got to be kidding. She washed her car yesterday.搞什么 她昨天才洗过车 100–Oh, no, she’s not.不是吧 真不要脸101–Yep, she’s bringing out the big guns.很好 不择手段的女人102–You better get over there. She’s wearing cotton.你最好赶紧过去 不然她就要脱光了 103–What am I supposed to say? “I saw you half-naked 难道要说”看你快脱光光了 104–and I thought I’d drop by”?所以我来打个招呼”105–What’s that?这是什么106–A piece of Mike’s junk mail we got by mistake.寄给麦克的广告传单 投错了107–I held onto it in case of an emergency.我留着以备不时之需108–God bless you.上帝保佑你109–Hey, Susan.苏珊110–We got this by mistake.这个寄错了111–Oh, thanks.多谢112–I hope it’s not important.但愿不是很要紧的信113–No, it’s just a promotion for the Rialto Film Festival.不 只是里亚尔托电影节的宣传单 114–Well, I guess I’ve done my good deed for the day.我想我已经日行一善了115–I’ll just head back home.我这就回去了116–Bye.再见117— Hey, you like old movies? - I love old movies.-你喜欢老电影吗 -简直爱死了 118–I hate Susan Mayer.我讨厌苏珊·梅尔119–Every time I see those big doe eyes of hers,每次看到她母鹿般的大眼睛120–I swear to god I just want to go out and shoot a deer.我就想出去打死一只鹿 121–What has she done this time?她又做了什么122–She is out there throwing herself at Mike Delfino,她在外面勾引麦克·德尔非诺 123–again.又一次124–Susan likes Mike?苏珊喜欢麦克125–Where the hell have you been, Martha?你没看出来吗 玛莎126–She’s been lusting after him ever since he moved in.从他一搬进来她就盯上他了 127–I got your message. What’s going on?我收到留言 出了什么事128–The boys refuse to be separated.双胞胎不愿意分班129–They refuse? They’re six years old. Make them.不愿意 他们才 6 岁 来硬的啊 130–The school regulations are pretty strict 学校可不准131–about me wrestling with the boys.我对孩子们动粗132–But if you want to give it a shot, be my guest.不过你想试试的话 请便 133–Fine.好吧134–Oh, which one goes and which one stays?哪个走哪个留135–You pick.随你便136–Come on now. Stop it! No. No.听话 住手 别这样137–I’m gonna take the whole table. That’s right.我要把桌子一起搬走 就这样138–Come on now. I mean it.快点放开 我是认真的139–I love taking baths. Especially with you.我喜欢泡澡 尤其是跟你一起140–It’s like taking a vacation from the world.简直像在世外桃源141–I hated taking baths when I was a kid.我小时候很讨厌洗澡142–Of course, back then,因为当时143–the only thing I had to play with was my rubber ducky.我只有橡皮鸭可玩144–Who’s that?谁145–It’s Mr. Solis.是索利斯先生146–Relax. Carlos is at work and he doesn’t ring the doorbell.放心 卡洛斯在上班 而且他有钥匙 147–It’s the cable guy. He’s three hours late.是有线电视修理工 他迟了 3 小时148–Use the side entrance.你从侧门走吧149–Gabrielle knew her vacation from the world had ended.加布丽尔知道世外桃源的假期结束 150–What she didn’t know was John had left behind a souvenir.可她不知道约翰留了个纪念品 151–I’m telling dad didn’t come home last night.爸爸昨晚没回家152— They had a fight. A bad one. - How bad?-他们吵得惊天动地 -有多严重153–Like divorce court bad.离离婚不远了154–Listen to her.看看155–She always overcompensates when she’s worried.她心情不好时总爱忙家务156–If dad moves out and leaves us with her,如果爸爸搬了出去 把我们留给她157–I’ll lose my mind.我还不如死了算了158–Dinner is on the table.晚饭好了159–Mom, where did dad go last night?妈 爸爸昨晚去哪了160–He got a last minute call to speak at 他接到了紧急通知161–a medical conference in Philadelphia.要去费城的一个医学研讨会演讲162–Take your seats.坐下吃饭吧163–This marriage is so over.他们的婚姻完蛋了164–Andrew?安德鲁165–Again sorry I was late.非常抱歉 我迟到了166–The scheduler overbooked me.我把日程安排得太满了167— How long are you going to be? - Almost done.-你还要修多久168–What is that scent? Is that sage and citrus?这是什么味道 是鼠尾草和柑橘吗169–That’s amazing.挺好闻170–Try to hurry. I have stuff to do.快点 我还有事171–Come on.快点172–What’s happening?出什么事了173–The cable guy fell.修理工摔了一跤174–He hit his head on the tub. He may have a concussion.头撞到了浴缸上 有脑震荡的可能 175— It’s almost eight. - He was late.-现在快八点了 -他来晚了176–Mrs. Huber.胡博太太177–Hello, Susan. I made you a pie.苏珊 我给你做了个派 178–Oh, wow! Why?今天是什么日子吗179–Do I need a motive to do something nice?做好事还需要什么理由吗180–I can’t wait for you to try this.快尝尝 我都等不及了181–It’s mincemeat.这是个肉馅派182–Actually, I just had dinner.事实上 我刚吃过晚饭183–That’s ok. You can save it for later.没关系 你可以留着以后吃184–What’s so funny?你笑什么呢185–I was just thinking of that expression,我在想那句话186–“I’ll make mincemeat out of you”.”我给你做了肉馅派”187–Mincemeat used to be an entrap of mostly chopped meat,肉馅派从前是指切碎的肉188–so it was like saying,所以就像是在说189–“I’ll chop you up into little bits.”“我要把你碎尸万段”190–but that was centuries ago.但这种表达方式早就过时了191–Today, mincemeat is mostly made of 现在 肉馅派里面主要是192–fruit, spices and rum.水果 香料和朗姆酒193–There’s no meat in it and still people say,里面已经没有肉了 可人们还是说194–“I’ll make mincemeat out of you.”“我给你做了个肉馅派”(我要用你来做肉馅派)195–I don’t know that people really say that anymore.我想现在没人这么说了196–I do.除了我197–So, Susan, how are you?苏珊 最近过得怎么样198–I’m fine.还不错199–Good. You know, I have a confession to make.很好 有件事我想表示一下歉意200–I’ve always wish I’d been more supportive when Karl left you.卡尔离开的时候我应该多关心关 心你201–Oh, you don’t have to apologize about Karl.你没必要因为卡尔的事跟我道歉202–Really, Karl and I are over.都是过去的事了203— I’ve moved on. - Yes, I know.-我已经开始新的生活了 -我知道204–You’ve moved on to that nice Mike Delfino.你已经开始了和麦克·德尔非诺的新生活 205–He’s quite a catch, isn’t he?他可是个抢手货 是吧206–You like him, don’t you?你不是喜欢他吗207–Ah, sure, as a friend.当然 是很好的朋友208–Oh, Susan.苏珊 拜托209–Being coy is a strategy best employed 只有涉世未深的小姑娘210–by virgins at their first dance.才会扭扭捏捏211–For women of our age,我们都是成年人了212–it’s just annoying.再这样就太幼稚了213–You sure you don’t want pie?你真的不想吃吗214–No, thank you.不想 谢了215–I hope it works out with you and Mike.我希望你和麦克能在一起216–You’ve been so desperate to land him.你拼了命地想把他搞到手217–What? I am not desperate.你说什么 我才没有218–Good lord, Susan,天啊 苏珊219–you burned your rival’s house down.你把你情敌的房子都烧掉了220–If that isn’t desperate,如果这都不算拼命221–I don’t know what is.我还真不知道怎么样才算 222–Mrs. Huber, with all due respect, you’re crazy.胡博太太 恕我直言 你真是疯了 223— What’s that? - I think you recognize it.-这是什么 -我想你知道的224–I found it in the ruins of Eddie’s home.这是我在伊迪家的废墟里找到的225— Well, that’s not… - Shh. My point is this.-这不是 -嘘 我的意思是226–I wasn’t there for you when Karl left,卡尔离开的时候我没在你身边 227–but I am here for you now.而现在 我会陪着你228–As far as I’m concerned, this is our secret.要我说 这件事你知我知 229–And no one ever need know.没必要让别人知道230–Oh, Susan.苏珊231–You don’t know how good it feels 想到可以帮帮你232–to finally be able to help you.我感到太好了233–You look so pale.你的脸色很难看234–Now, I insist you try some of my pie.你一定得尝尝我做的派235–Go on.快张嘴236–Did I mention it’s mincemeat?我有没有说过这是肉馅的237–别进来238— Open the door, please. - Hang on.-快开门 -等等239— What? - May I come in?-干嘛 -我能进去吗240— No. - I want to talk to you.-不行 -我想和你谈谈241— Then talk. - Where were you last night?-就在这说吧 -你昨晚去哪了242— Brian’s. - I just spoke to Brian’s mother.-布莱恩家 -我刚和布莱恩的妈妈聊过243–Tell me again where you were last night,告诉我你去哪了244–and this time don’t lie to me.别撒谎245–Where did you say dad was again? In Philadelphia?你说爸爸在哪来着 费城246–Andrew, don’t change the subject.安德鲁 别转移话题247–Sorry, I thought the subject was telling lies.不好意思 我以为话题是有关说谎呢248–I called dad’s cell phone.我给爸爸打了电话249–I know he moved out.我知道他搬出去了250–Well, it’s just temporary and…这只不过是暂时的251–…I thought it would upset you so I was protecting you.我怕你们难过 我这么做是想保护你们 252–Whatever. You lied.不管怎么说 你撒谎了253–So stop pretending like you have 别装得跟个254–some sort of moral authority.圣人似的255–Andrew, just because I chose not to 安德鲁 我选择不告诉你们256–share my marital problems with you 我们的婚姻出了问题257–doesn’t give you the right to be rude.并不意味着你有权利放肆258–How about driving my father away.把我爸气走的事情呢259–Do I get to be rude then?加上这点够了吧260–What’s this?这是什么东西261— It’s a sock. - It’s a man’s sock.-袜子啊 -是男人的袜子262–I found it under our bed.我在我们的床底下找到的263–It’s not mine.这可不是我的264–Oh, for god sakes, Carlos, it’s Yao Lin’s.拜托 卡洛斯 这是姚琳的265–Our maid wears size 13 gym socks?我们的女佣穿 13 码[47 号]的运动袜266–No, she dusts with them.她用这东西来打扫卫生的 267–See? Socks instead of rags.看到了吧 她用袜子代替抹布268— Susan, hello. - Mrs. Huber.-苏珊你好啊 -胡博太太269–Did you and Mike come together?你和麦克是一起来的吗270–I saw him over in the fresh produce aisle.我看到他在挑水果271–No. Like I told you. We’re just friends.不是 我和你说过了 我们只是朋友 272–Oh.这样啊273–By the way, if I didn’t make it clear yesterday,昨天我已经说得很清楚了274–I absolutely did not do that thing you accuse me of.你根本就是在血口喷人275–Hey, Susan. Hey, Mrs. Huber.你们好啊 苏珊 胡博太太276–Nice to see you, Mike.真高兴见到你 麦克277–Hey. You like Alfred Hitchcock?你喜欢阿尔弗雷德·希区柯克吗278–They’re doing a retrospective at the rialto.剧院有一场回顾展279–Uh… …I’m not really a fan.不太喜欢280–Come on, how can you not like Hitchcock?拜托 你怎么会不喜欢希区柯克呢281–I just, uh, don’t.就是 不太喜欢282–Oh. Ok.那好吧283–Well, uh, nice to see you.很高兴见到你284–You too, Mrs. Huber.还有你 胡博太太285–You’re so silly.你还真是傻286–Pretending not to like him on my account.因为我在这儿就假装不喜欢287–I mean, really.真傻透了288–Will you just drop it?你能不能闭嘴289–You shouldn’t be rude to me.你不应该对我这么粗鲁290–Your secret is not an easy burden to bear.你那个可不是什么小秘密291–That insurance company is putting Eddie through hell.伊迪的保险公司一直在刁难她292— But still I’ve said nothing. - Well…-可我依然守口如瓶 -可是293–The longer it takes for her payment,她的赔偿金来得越晚294–the longer she’ll be staying with me.在我家住的时间就越长295–Eating me out of house and home. Using up my hot water.吃我的 住我的 还用着我的热水 296–What exactly is it you want from me, Mrs. Huber?胡博太太 你到底想怎么样297–Are these together?一起算吗298–Ring it up.一起299–If the school and the pediatrician 既然学校还有儿科医生300–think the twins could be medicated,都建议可以进行药物治疗301–then what’s the problem?你还在担心什么302–I used to run a company with 85 people,从前我管理 85 个人的公司303–and now I can’t wrangle three 现在除了让他们吃药304–small boys without doping them?我没有任何好办法能照顾他们305–Talk about feeling like a failure.还不算失败吗306–Lynette, you are a great mother.勒奈特 你是一个好妈妈307–But, let’s face it,可是 面对现实吧308–your kids are a challenge.他们的确太…具挑战性了309–Thank you. That’s the nicest way you could’ve said that.谢谢你 我知道这已经是最得体的安 慰词了310–You know, the truth is 说句老实话 311–when they’re not making me want to tear my hair out,他们不让我抓狂的时候 312–they’re actually really sweet.还是很可爱的313–I’m afraid if I change the bad stuff,我害怕如果他们的缺点消失了314–I’m going to change the good stuff.可爱的地方也会随之消失315–It’s a tough call.这还真是个两难的选择316–Like this mug.就像这杯子317–I love this mug. If I medicate them,我喜欢这个杯子 如果我把它补好了318–will they still make me a mug like this?它还会是原来的那个杯子吗319–You know, it’s leaking.这杯子在漏水320–Yeah, I know.我知道321–We talked to Paul. We told him 我们和保罗聊过了 我们告诉他322–we need to show him something.有些东西要给他看323–He’s on his way over.他马上就会过来324–So, Paul, we notice that you’re selling the house.保罗 我们看到你的售房告示了325–Yes, too many painful memories. I’m sure you understand.有太多伤心的记忆 你们应该能体 会的326–Before you move, we thought there’s something you should know.在你离开之前 有些事情你 应该知道327–It seems there may be more to Mary Alice’s 玛丽·艾莉丝的死似乎328–death than you are aware of.另有内情329–Remember when you asked us to pack her things?还记不记得你让我们帮忙收拾她的遗物 330–Well, when we did, we found a note.我们清理时 发现一张字条331–And we think that you should have it.你应该看看332–You can see from the postmark,这上面的邮戳日期显示333–Mary Alice probably got it the day she died.是玛丽·艾莉丝死的那天到的 334–我知道你干的好事 真恶心 我要告诉别人335— Paul, are you going to be okay? - No.-保罗 你还好吗 -不336— Have you always cleaned with socks? - Yes.-你经常用袜子打扫吗 -是的337–What is that, a Japanese thing?那是日本人的习惯吗338–I am Chinese.我是中国人339–I don’t like lying.我不喜欢说谎340–I don’t like your ironing, so there.我也不喜欢你烫的衣服 扯平了341–Mrs. Solis, what are you doing here?索利斯夫人 你怎么来了342–Carlos found this under the bed.卡洛斯在床底发现了这个343–Oh, crap.该死的344–It’s ok. It was close call,没事了 虽然很惊险345–but I managed to cover.但是我蒙混过去了346–I got you these, so from now on,我给你买了这个 从现在开始347–we can’t let Carlos see you wearing 不能让卡洛斯348–anything resembling a gym sock.看见你穿任何类似运动袜的东西349–You want me to mow your lawn in sandals.你让我穿拖鞋来除草350–I could lose a toe.那会弄伤我脚趾的351–Imagine what you’d lose if he finds out 如果他发现你除了草坪还做了别的352–you’re trimming more than the hedge.受伤的就不仅仅是脚趾了353–Why are your friends staring at me?你朋友为什么盯着我看 354— Did you tell them about us? - No.-你说了我们的事吗 -当然没有 355–They’re staring ‘cause they think you’re hot.他们盯着你是因为你很性感 356–Oh… Ok.是吗 那好吧357–It’s 9:30. What is your brother thinking?都九点半了 你哥哥干什么去了 358–Want my advice? Call dad.我的建议是 打电话给爸爸359–Tell him to go kick Andrew’s ass.让他把安德鲁揪回来360–I am perfectly capable of handling this without your father.你爸爸不在 我也可以处理好 361— I’m sorry. - Where’s your cell phone?-抱歉 -你的手机呢362–Call Andrew. Find out where he is.打给安德鲁 问问他在哪363–He’ll know you’re behind this.他会知道是你的主意364–He won’t. Just act normal.只要像平常一样说话 他就不知道365–Hey, it’s me. Ah, what’s going on?是我 怎么了366–He knows.他知道了367–Andrew, this is your mother.安德鲁 我是妈妈368–I am rapidly reaching the end of my patience with you.我马上就要失去耐性了 369–Where are you? Are you at a bar?你在哪 你在酒吧吗370–Andrew? Andrew?安德鲁 安德鲁371— Mom? - He hung up on me.-怎么了 妈妈 -他挂我电话372–What are you gonna do?你打算怎么办373–畅饮热舞374–Heath. Lan. Andrew.希勒 兰 安德鲁375–Mom, how did you even know I was here?妈妈 你怎么知道我在这376— You went in my room? - You think that’s bad?-你进我房间了 -不行吗377–Tomorrow morning, I’m cleaning it.明天早上我还要彻底清理呢378–Oh, by the way, Heath.顺便说下 希勒379–I didn’t get a chance to tell you,上个星期在教堂的独奏不错啊380–that was a lovely solo last week at church.当时我都来不及说381–Thank you. We’re out of here.谢谢 我们得走了382–I hope it wasn’t something I said.希望不是我扫了你们的兴383–Well, Andrew, shall we?安德鲁 我们能回去吗384–You just humiliated me in front of my friends.你刚在我朋友面前羞辱了我385— I’m not going anywhere with you. - Fine.-我是不会跟你走的 -好吧386— What are you doing? - I’m staying for the show.-你在这干嘛 -看表演啊387–I’m dying to see what all the fuss is about.我很想知道这到底有什么好看的388–Excuse me, waitress. I’ll have a glass of your house Chardonnay.给我来杯莎当妮白葡萄酒 389–Of course, ma’am.好的 女士390–I’m curious. Andrew,我很好奇 安德鲁391–as you fantasize about this woman,既然你对这女人这么入迷392–do you ever stop and think how 你有没有想过393–she came to be on this runway?她为什么在这工作394–That’s someone’s little girl.她也是别人的女儿395–And that someone probably had a lot of dreams for her.她的家人也对她寄予厚望 396–Dreams that did not include a thong and a pole.但肯定不希望她来跳钢管舞397–It’s not going to work, ok? I’m not budging.随便你怎么说 我不会跟你回去的398–God knows what she’s had to deal with in life.只有上帝知道她过着什么样的生活 399–Abject poverty, drugs, domestic violence,家里一贫如洗 嗑药 忍受家庭暴力 400–maybe even molestation.甚至被人性虐待401–Mom!妈妈402–Now she treats herself the way 像别人糟蹋她一样糟蹋自己403–other men treat her. Like an object. A piece of meat.已经没人的样子了 就像一块肉 404–That does it. Kid, get her out of here.我受够了 小鬼 和她回去吧405–She’s killing it for the rest of us.她妨碍其他人娱乐了406–We’re not here, leave a message.家里没人 请留言407–It’s Mrs. Huber, Susan, are you there?我是胡博太太 苏珊 你在吗408–I can see your lights are on.我看见你家灯还亮着409–I hope you’re not screening. That’s so tacky.我希望你不故意躲着我 手段也太低劣了 410–Listen. I need to talk to you.听着 我得和你谈谈411–My water heater just burst 我家热水器坏了412–and it’s gonna cost me $600 to get a new one.换一台新的要花 600 块413–And I can’t afford that.我可买不起那个414–I’m just beside myself. Call me as soon as you get in.我就在电话旁 尽快回我415–Julie, honey, wake up.朱莉 亲爱的 快醒醒416–We need to talk.我们得谈谈417–Can’t this wait until morning?不能明天再说吗418–I think I’m being blackmailed.我想我被人勒索了419–And when I realized I couldn’t put out the fire, I ran.当时火势已经无法控制 我就跑了 420–I must’ve dropped the measuring cup in the process.我肯定把量杯落下了421–Why do I even let you out of the house?我怎么就让你出去了422–Obviously, I can’t let her get away with this.显然 我不能让她揭发这一切423–The only thing to do is go to the police 我们唯一能做的就是424–and tell them what happened.去找警察说明情况425–You can’t do that.不能这样做426–Julie, I don’t think they’ll throw me in jail.朱莉 我不信他们会抓我去坐牢427–I mean, it was an accident.那完全是个意外428–Dad won’t care if it was an accident.老爸可不管那是不是事故429–You know he’ll just use this as an excuse to reopen custody.他会抓住这点夺回监护权 430— Mom, I don’t want to live with dad. - I know.-妈妈 我不想和爸爸一起住 -我明白431— I need to talk to you. - Cool. Sure.-我们聊聊吧 -当然可以432— You were working tuesday, right? - Yeah.-周二你在这 对吧 -是的433–You remember the cable guy showing up?记得有个线路工人来过吗434–And you usually work till what time, five?你一般工作到几点 五点吗435–Yeah.是的436–Damn it. That means he was in the house for four hours.该死的 那家伙在屋里待了四小时 437–Wait. Now that I think about it,等等 仔细想了想438–I might not have seen him.我好像没看到他439–Either you saw him or you didn’t. Which is it?你到底看没看到他440–I didn’t.我没看见他441–John…约翰442–…did my wife ask you to lie for her?我老婆让你说谎了吗443–Mr. Solis, uh… I really don’t want 索利斯先生 我只是 444–to get in the middle of anything.不想说三道四445–Thank you. That’s all I needed to know.谢了 我明白了446–Let’s run through it one more time.我们再过一遍447–Mom, it’s not brain surgery.妈妈 这又不是脑部手术448–You’ll stand guard while I crawl through Mrs. Huber’s doggie door.你在外面放风 我从她家狗 洞爬进去449–Once inside, I find the measuring cup.爬进去之后 我会拿出量杯450–Simple.就这么简单451–Mm, god. I hate that I’m turning you into a little thief.天哪 我真恨自己让你变成小偷 452–It’s our cup. We’re just taking back what’s ours.那本来就是我们的量杯 物归原主而已 453–That’s right. Ethically,说得好 理论上说454–we have nothing to be ashamed about.我们没有什么好害臊的455–Oh. Wear these. I don’t want you to leave finger prints.戴上这个 我可不想你留下指纹 456–There she goes. Ok. Move.她走了 我们行动吧457–Oh, so glad to be playing frisbee again.真高兴又能和你玩飞盘了458–Here you go. Coming at you 接着 飞过去了459–All right. Back up a little more. There you go.很好 后退一点 你来460–Whoo! All right. Here we go.好的 到你了461–Oh, my, whoops! You better go get that. Yeah. Hah!糟糕 你最好去捡回来462— Mike. - Hey, Susan.-麦克 -好啊 苏珊463–I thought that was you.我在那看到你了464–Uh… Yeah. Julie and I are out tossing a frisbee around,我和朱莉在玩飞盘呢465–and it flew off into Mrs. Huber’s back yard.不小心飞进胡博太太的后院了466–Oh, you need some help?需要我帮忙吗467–No, no, no. Julie’s got it.不用 朱莉已经去捡了468–Ok. I’m glad I ran into you.好的 很高兴能碰到你469–I wanted to make sure things were ok between us.我希望我们之间没事470–The other day, you seemed kind of distant.那天在超市 感觉你在躲着我471–Distant? What do you mean?躲着你 你什么意思472–I mean, you’re not mad at me for some reason, are you?我是说 你没有生我的气吧473–No. No, not at all.不 完全没这回事474–Good. ‘cause I’m gonna take one more shot.那就好 我想再试试475–I got tickets for a Billy Wilder retrospective,我有比利·怀尔德的电影票476–Wednesday night.星期三晚上的477–I’d love to take you with me.我希望你能和我一起去478–You are so sweet. I’d love to go.你太好了 我很乐意479–All right.那好480–Eddie, I thought you’d be at work.伊迪 我以为你去上班了481–I’m not feeling well.我不太舒服482–I got a sunburn the other day washing my car.可能那天洗车晒伤了483–Well, don’t just run off. Come and hang out with us.别就这么走了 和我们一起聊聊吧484— Boy, you are one sick ticket. - What?-别假惺惺的 -你说什么485–It’s not bad enough I have to watch 每天看着你和他486–you throw yourself at him every day.打情骂俏还不够487–Now you want to make sure I see it up close and personal?还要我凑过来看得清楚些吗 488— No, it’s not like that. - I’ve got to take off.-不 事情不是这样 -我得走了489–I’ll call about Wednesday night, ok?周三晚上我会打给你的 行吗490–Edie, wait.伊迪 等等491–Mike and I were gonna go see the movies on Wednesday 麦克和我周三要去看电影 492–and I thought it would be fun if you joined us.希望你能一起去493— You want me to come with you? - Yeah.-你想让我跟你们一起去吗 -是啊 494–Yeah, that’s ok, isn’t it, Mike?可以吗 麦克495–Well, it’s a limited engagement.那场电影门票有限496–And it’s sold out. I’ve only got two tickets.而且票已经卖完了 我只买了两张 497–Edie, wait. You should take my ticket.伊迪 等等 我的票让给你 498–Really? Is that ok with you, Mike?真的吗 你愿意吗 麦克499–Uh, yeah, sure.没问题500–So, uh, what time do you want to pick me up?那你什么时候来接我501–Hang on.稍等502–You think you can have sex with anyone you want, huh?你以为你可以随心所欲跟人上床 对 吧503–Carlos couldn’t help but feel proud of himself.卡洛斯不禁自豪起来504–After all, he’d just defended his honor.毕竟 他维护了自己的尊严505–Or had he?也许还没有506–百老汇音乐剧”玫瑰舞后”507— Are you gay? - Yes. Is that why you’re doing this?-你是同志吗 -是的 你是为这个打我吗 508–“Will you buy some chocolates?”你想买些巧克力吗509–Ladies.女士们510–Hey, Paul, what’s up?保罗 有事吗511–I wanted to apologize for my outburst yesterday.我想为我昨天的失控道歉512–Don’t worry about it. We unloaded a lot on you.别放在心上 是我们给你太大压力了513–I suppose you’re wondering why I 我想你们一定很想知道 为什么我对514–reacted so violently to that note.那个纸条的反应那么强烈515–It did… cross our minds.我们确实想过516–Well, the truth is, Mary Alice was not a well person.老实说 玛丽·艾丽丝当时的状况不太好 517–She was very troubled.她有很多问题518— Troubled? - At first it was harmless.-什么问题 -一开始并无大碍519–She’d leave herself notes, reminders like,她给自己写便条啊 备忘啊 比如520–“pick up the milk”“别忘了买牛奶”521–or “Zach has a dentist appointment.”或者 “扎克约了牙医”522–But over time the notes became ugly.但是时间一长 情况就恶化了523–Hateful messages started showing up.开始出现一些消极的留言524–Mary Alice was writing them to me,玛丽·艾丽丝将它们写给我525–to Zach, to herself.给扎克 也给她自己526— Really? - That’s why I lost it.-真的吗 -这是我失控的原因527–I was reminded of what Zach and I had been through.我回忆起扎克和我过去的遭遇528— Paul, I’m so sorry. - We had no idea.-保罗 真抱歉 -我们完全不知道529–No.是的530–Anyway, I’d appreciate it 无论如何 我希望你们531–if you kept this to yourselves.保守这个秘密 532— For Zach’s sake. - Of course. Of course.-看在扎克的份上 -当然 当然 533–Bye.拜534— I think he’s lying. - Huh. So do I.-我觉得他在撒谎 -我也这么想 535–斯加沃晋升为副总裁536–You didn’t get me! Bang! Bang!你打不到我的 嘣 嘣537–Boys, could you get in here, please?孩子们 过来一下538— He broke my plane. - I did not.-他弄坏了我的飞机 -我没有539–We’ll talk about that later. I need you to take medicine.这件事等会再说 我要你们把药吃了 540–Are we sick?我们病了吗541–Not exactly. There is a special medicine.不算是 这是种特殊的药542–It’s like a vitamin and you’ll take it every day, ok?就像维他命 每天都要吃的 好吗 543–Stay right there.待着别动544–Now open up.把嘴张开545— Here, you… - No.-来 -不要546— Guys, this is a… guys, here… - Nope.-孩子们 这是 张嘴 -不要547–In that moment, Lynette made a decision.在那一刻 勒奈特做了一个决定548–When it came to dealing with her children,想要对付她的孩子们549–medication was no longer an option.不能再依靠药物了550–Of course, given her continuing level of frustration,当然 随着她的挫败感不断加深 551–Lynette also felt a little 勒奈特认为自我治疗552–self-medication couldn’t hurt.也无伤大雅553–So what’s your strategy?你打算怎么办554–Are you just never gonna speak to me again?永远都不跟我说话了吗555–Something like that.差不多556–I suppose I do owe you an apology.我想我欠你一个道歉557–Careful. I wouldn’t want you to strain yourself.是么 我可不想让你逼自己558–I shouldn’t have lied to you about your father.关于你父亲 我不应该说谎559–You two are old enough to handle the truth 你们不是小孩了 我应该告诉你们真相 560–and I’m sorry.对不起561–Keep going.继续562–I’m mad at you for about 7,000 other things.还有另外 7000 件事上 我都在生你的气 563–If you think I’ll apologize for taking 如果你觉得我会为把你拽出564–you out of a strip club, you’re wrong.脱衣舞俱乐部而道歉的话 你就错了565–I consider it one of my finest moments.我认为那是我做得最棒的事之一566–Oh, Andrew.安德鲁567–I know you blame me 我知道你因为568–for what’s happening with your father,你父亲的事怪我569–but it’s not entirely my fault and 但这不全是我的错570–I need you to understand that.我希望你理解571–I do.我理解572–I just… don’t want him to leave.我只是 不想让他走573–Neither do I.我也不想574— Mom. - Yeah?-妈妈 -什么事575–When can I have my door back?我的门什么时候能装上576–Three months.三个月以后 577–Royal Oaks was the scene of a hate crime today.今天皇家橡树区发生了一起报复犯罪 578–Jonathan Lisco, local gay activist 当地的同性恋者 乔纳森·里思科579–and part-time female impersonator,兼职男扮女装的演员580–was brutally attacked in his home.在家中惨遭袭击581–Lisco speculated the attack 里思科怀疑582–was in response to his efforts 这起袭击起因于583–to secure same-sex partner insurance 他曾向他的雇主 即悬崖有限电视台 584–coverage from his employer,力争给同性伴侣的585–Cliffside cable.福利保险586–Police are circulating this sketch of the assailant.警方发布了嫌犯的素描587–The circumstances speak for themselves.事实胜于雄辩588–I’ve taken a strong stance with my company.我已经向我的公司表达了强硬的立场 589–Is there something you want to ask me?你有什么要问我吗590–No.没有591–You took it, didn’t you?你把它偷走了 对吧592–Good evening, Mrs. Huber.晚上好 胡博太太593–It’s my own fault for not hiding the cup.都是我的错 没把杯子藏好594–If you’re capable of arson,你有本事纵火595–obviously you’re capable of breaking and entering.就有本事破门而入596–I don’t know what you’re talking about. Mrs. Huber.我不知道你在说什么597–I suppose you destroyed it.我猜你一定把它销毁了吧598–Again, I don’t know what you’re talking about,再说一遍 我不清楚你在说什么 599–but… yeah, I did.但是 没错 我是把它毁了600–I was going to keep your secret.我本来会替你保守秘密的601–It’s a shame you couldn’t trust me.可惜你不信任我602–You’re a piece of work. Do you know that?你真是麻烦 你知道吗603–Oh, Susan, let’s not be unpleasant.苏珊 我们别闹僵了604–We can go back to the same friendly 我们可以像从前一样605–relationship we’ve always had.维持友善的关系606–I will keep my lawn looking nice.我会修剪好我家的草地607–And I would make sure my music isn’t played too loud.保证家里的音乐不会太大声 608–And if I get some of your mail,如果我收到给你的邮件609–heck, I’ll run it right over,我会马上跑过去给你610–‘cause that’s what good neighbors do.因为这是一个好邻居该做的611–But from now on, when I run into you on the street,但是从现在起 当我在街上碰见你 612–and I say, “good morning, Mrs. Huber”我会说 “早上好 胡博太太”613–or “how are you, Mrs. Huber?”或者 “你好吗 胡博太太”614–Just know that inside 你要知道 在我心里615–I am quietly but decidedly hating your guts.我会一直毅然决然地对你恨之入骨 616–Careful, dear,当心 亲爱的617–let’s not say things we’ll live to regret.别把话说死了618–Good evening, Mrs. Huber.晚安 胡博太太619–He actually said Mary Alice was crazy?他真的说玛丽·艾丽丝疯了620–Not in so many words, but everything Paul said 没说得这么明确 但是保罗说的每句话 621–made it seem like she was schizophrenic.都好像是说 她得了精神分裂症 622–I think he’s hiding something. I know it.凭直觉 我想他在隐瞒什么 623–But wait, what about the tape?等等 那卷录音带呢624–She did say her name was Angela.她说她的真名是安吉拉 625–Mary.Alice was not crazy.玛丽·艾丽丝没疯626–My father was a prosecutor and he always 我父亲是个检察官 他常说 627–said that the simplest explanation 最简单的解释628–was usually right.通常都是对的629–But remember the note said 想想那个纸条630–“I know what you did. It makes me sick.”我知道你干的好事 真恶心 631–And I’m going to tell.”我要告诉别人”632–That’s not something someone writes to themselves.这显然不是写给自己看的 633–That’s a message sent by an enemy.这是仇人所写的634–我知道你干的好事 真恶心 我要告诉别人635–So exactly what is it you hired me to do?你想要我做什么636–It’s very simple really.很简单637–Someone sent that note to my wife 有人写了那张便条给我妻子 638–and I need to know who.我想知道是谁639–What type of person would send such a note?什么人会写这样一张纸条呢 640–Was it an enemy? Of course.是仇人吗 当然641–But what kind? An acquaintance?什么样的仇人呢 是熟人642–A stranger?或是陌生人643–Or how about a neighbor that lives a few feet away?还是相隔咫尺的邻居" }, { "title": "读《Swift 异步与并发编程》", "url": "/posts/book-swift-async/", "categories": "读书", "tags": "books", "date": "2023-08-12 20:00:00 +0800", "snippet": "Swift 在 5.5 版本中加入了 async/await 语法来简化异步编程，他们的基础用法不难，但是如果要深入理解并且结合 Actor 来更好的使用，还是需要对其深入学习。这本王巍写的《Swift 异步与并发编程》，在《Swift 进阶》书籍的基础上，对异步编程进行了更详细的讲解，非常值得一读。对一些基本概念的图文澄清同步同步操作意味着在操作完成之前，运行这个操作的线程都将被占用，直到函数最终被抛出或者返回。在函数返回之前，运行它的线程无法执行其他操作。异步我们将运行在后台线程加载数据的行为称为异步操作，区别于同步，它不会阻塞运行这个函数的线程，带来的好处就是不会阻塞 UI 的更新。串行串行严格按照函数被调用的先后顺序发生，同步和异步都可能会有串行的运行方式。同步串行异步串行并行可以在不同的线程中同时执行多个函数的方式，我们称之为并行。Swift 并发Swift 并发指的是异步和并行代码的组合，这个定义去掉了在同一个线程中多个操作交替运行的并发方式，更易于我们理解。异步函数 Asyncfunc loadSignature() async -&amp;gt; String异步函数的引入，在语法上确保了其使用的正确性。async 会帮助编译器确保两件事情： 它允许我们在函数体内部使用 await 关键字； 它要求其他人在调用这个函数时，使用 await 关键字。await 代表了函数在此处可能会放弃当前线程，它是程序的潜在暂停点。结构化并发对于同步函数来说，线程决定了它的执行环境。而对于异步函数，线程的概念被弱化，异步函数的执行环境交由任务 (Task) 决定。使用 Task.init 可以创建一个执行异步函数的上下文环境。func someSyncMethod() { Task { await loadFromDatabase() await loadSignature() print(&quot;Done&quot;) }}上面函数中的 loadFromDatabase 和 loadSignature 其实是被串行执行的。如果 loadSignature 不依赖上一个函数的运算结果，我们当然希望他们可以并行，来加快获取结果的速度。所用到的方法就是结构化并发，有两种方式可以实现，async let 和 task group。async let 的使用例子如下func someSyncMethod() { Task { async let loadStrings = loadFromDatabase() async let loadSignature = loadSignature() await loadStrings await loadSignature print(&quot;Done&quot;) }}ActorActor 是用来提供封装良好的数据隔离，确保并发代码的安全的。更加详细的介绍在后面的章节会有。异步函数使用 Async 对已有的闭包进行封装对于项目中已有的大量闭包函数，我们可能不能很快的将它们都重写为异步函数，那么一个切实有效的迁移方法就是先对闭包进行封装，让它得以在其他异步函数中使用。封装方法如下：func withUnsafeContinuation&amp;lt;T&amp;gt;(_ fn: (UnsafeContinuation&amp;lt;T, Never&amp;gt;) -&amp;gt; Void) async -&amp;gt; Tfunc withUnsafeThrowingContinuation&amp;lt;T&amp;gt;(_ fn: (UnsafeContinuation&amp;lt;T, Error&amp;gt;) -&amp;gt; Void) async throws -&amp;gt; T比如我们要对一个闭包函数 func load(completion: @escaping ([String]?, Error?) -&amp;gt; Void) 进行封装：func load() async throws -&amp;gt; [String] { try await withUnsafeThrowingContinuation { continuation in load { values, error in if let error { continuation.resume(throwing: error) } else if let values { continuation.resume(returning: values) } else { assertFailure(&quot;Both parameters are nil&quot;) } } }}需要确保 resume 方法被调用且只被调用了一次。运行环境和可抛出错误的函数一样，异步函数也具有“传染性”：由于运行一个异步函数可能会带来潜在的暂停点，因此它必须要用 await 明确标记。而 await 又只能在 async 标记的异步函数中使用。于是，将一个函数转换为异步函数时，往往也意味着它的所有调用者也需要变成异步函数。在最上层提供运行环境的是 Task，它有几种不同的形式，常用的两个 API 如下： 在同步函数中使用 Task 创建异步环境func syncMethod() throws { Task { try await asyncMethod() }} 在 SwiftUI 的 View 上调用 .task modifier，它的调用时机和 onAppear 相同，并且受 View 生命周期的影响，会在 View 的生命周期结束时，取消对应的 Task。var body: some View { ProgressView() .task { try? await load() }}结构化并发在介绍结构化并发之前，我们先来看看什么是结构化编程，即代码拥有单一的入口和出口，我们可以期望代码会在出口处将控制权交还给我们。相对于结构化编程，最典型的是 goto 语句，它是非结构化的，它可以让代码无条件的跳转到某个标签，在多个跳转之后，我们可能就会失去对代码的控制了。结构化并发即是在进行并发操作时，也保证了控制流路径的单一入口和单一出口，得益于异步函数，我们才能更好的实现结构化并发。下面是使用回调导致的非结构化并发 与 使用异步函数的结构化并发的对比：作为对比，先看一个非结构化并发的例子：Task { let t1 = Task { print(&quot;t1: \\(Task.isCancelled)&quot;) } let t2 = Task { print(&quot;t2: \\(Task.isCancelled)&quot;) } t1.cancel() print(&quot;t: \\(Task.isCancelled)&quot;)}// 输出：// t: false// t1: true// t2: false上例中 t1 和 t2 的执行都是在外层 Task 闭包结束后才进行的，它们逃逸出去了。创建结构化并发有两种方式：withTaskGroup 和 async letTask Group在某个异步函数中，我们可以通过 withTaskGroup 为当前的任务添加一组结构化的并发子任务：struct TaskGroupSample { func start() async { print(&quot;Start&quot;) // 1 await withTaskGroup(of: Int.self) { group in for i in 0 ..&amp;lt; 3 { // 2 group.addTask { await work(i) } } print(&quot;Task added&quot;) // 4 for await result in group { print(&quot;Get result: \\(result)&quot;) } // 5 print(&quot;Task ended&quot;) } print(&quot;End&quot;) } private func work(_ value: Int) async -&amp;gt; Int { // 3 print(&quot;Start work \\(value)&quot;) try? await Task.sleep(nanoseconds: UInt64(value) * NSEC_PER_SEC) print(&quot;Work \\(value) done&quot;) return value }}Task { await TaskGroupSample().start()}// 输出：// Start// Task added// Start work 0// Start work 1// Start work 2// Work 0 done// Get result: 0// Work 1 done// Get result: 1// Work 2 done// Get result: 2// Task ended// End由 work 定义的三个异步操作并发执行，它们各自运行在独自的子任务空间中。这些子任务在被添加后即刻开始执行，并最终在离开 group 作用域时再汇集到一起。Async let这是一种简化版的创建结构化并发的方式，不需要像 withTaskGroup 一样的模板代码。上面的例子使用 async let 可以改写为：func start() async { print(&quot;Start&quot;) async let v0 = work(0) async let v1 = work(1) async let v2 = work(2) print(&quot;Task added&quot;) let result = await v0 + v1 + v2 print(&quot;Task ended&quot;) print(&quot;End. Result: \\(result)&quot;)}async let 赋值后，子任务会立即开始执行，即在 await 调用之前，任务已经开始了。Task Group 与 Async let 对比既然 Async let 更加简洁，那是不是可以完全不使用 withTaskGroup 了呢？大多数情况是的。withTaskGroup 有它的独特之处，它可以动态的创建任务，例如上面的例子，我们使用了 for 循环动态地添加了 3 个任务到任务组。它的 API 看起来也更加的严肃，使得并发的结构会更加清晰。协作式任务取消我们知道对于结构化并发可以通过调用 task.cancel() 来取消任务，但是要注意的是任务本身在取消后并不会自动停止，需要我们在任务的实现时通过对 isCancelled 的检查，来自己处理任务取消之后的响应。task.cancel() 做的事情只有两件： 将自身任务的 isCancelled 标识置为 true。 在结构化并发中，如果该任务有子任务，那么取消子任务。自己处理任务取消既然任务自己不会取消，那我们就得负责它的取消行为。可以在任务开始前检查 isCancelled 并返回空值或者抛出错误，来正确的响应对任务的调用。比如在发现任务被取消之后抛出错误：func work() async throws -&amp;gt; String { var s = &quot;&quot; for c in &quot;Hello&quot; { // 检查取消状态 guard !Task.isCancelled else { throw CancellationError() } // ... }}或者使用简化版的 API，这是推荐的做法：func work() async throws -&amp;gt; String { var s = &quot;&quot; for c in &quot;Hello&quot; { // 检查取消状态 try Task.checkCancellation() // ... }}内建 API 的取消一些标准库中的 API 已经做了对任务取消的支持，比如extension Task where Success == Never, Failure == Never { public static func sleep(nanoseconds duration: UInt64) async throws}它们通过抛出错误 CancellationError 来告知调用者任务已被取消。Actor 模型和数据隔离Actor 模型可以用来保证线程安全，避免数据竞争。在多线程并发的操作中，为了保证同一块内存不会被多个线程同时访问，我们可以使用线程锁，但是锁的设计较为复杂，且容易出错。书中举了一个进入房间写正字的例子，通过对比锁和 Actor 模型，我们还可以很明显的发现 Actor 对性能的提升，调用者不需要花更多的时间去等待：线程锁Actoractor 的创建和访问actor 和 class 在结构上是非常相似的，下面是一个 actor 的例子：actor Room { let roomNumber = &quot;101&quot; var visitorCount: Int = 0 init() {} func visit() -&amp;gt; Int { visitorCount += 1 return visitorCount }}可以看到，在 actor 内部访问和修改属性和类是一样的，主要的不同是在外部的调用。例如如下的外部访问，都是不被允许的let room = Room()room.visitorCount += 1room.visit()因为对于 room 这个实例来说，是被 actor 隔离的，外部对它的访问属于跨 actor 访问，只能在异步方法中才可以进行。使用 await 表明这里是一个潜在的暂停点，消息被转发给了 actor 之后，需要等到 actor 可用时才会执行，所以这个异步线程可能需要等待，在此期间它可以去执行别的任务。let room = Room()let visitCount = await room.visit()print(visitCount)print(await room.visitorCount)isolated 和 nonisolated 在 actor 中的声明，默认处于 actor 的隔离域中。 在 actor 外的声明，默认处于 actor 隔离域外。使用关键字 isolated 和 nonisolated，可以做到： 对于 actor 之外的声明，使用 isolated 关键字来明确表示函数体应该运行在该 actor 的隔离域中。 在 actor 中的声明，如果加上 nonisolated，那么它将被置于隔离域外。例如被 isolated 标记的方法，会将方法的实现运行在参数 room 的 actor 中。func reportRoom(room: isolated Room) { print(&quot;Room: \\(room.visitorCount)&quot;)}下面的例子是在一个 actor 中调用该方法：actor Room { func doSometing() async { // `self` 在自身的隔离域中 reportRoom(room: self) let anotherRoom = Room() // anotherRoom 不在 `self` 隔离域中。需要切换隔离域。 await reportRoom(room: anotherRoom) }}由于 actor 隔离域的不同，会发生 actor hopping 的行为。方法会继承上下文的 actor 隔离域，所以第一个 reportRoom 的方法中传入的 self 是在同隔离域的，不需要 await 进行跨 actor 执行。第二个 reportRoom 的方法，由于 anotherRoom 需要的隔离域不同，所以需要使用 await 跨 actor 执行。在方法执行完之后，会重新跳回 self 的隔离域，保持同样的上下文环境。隔离域是根据实例划分的，每一个实例都是一个单独的隔离域。MainActorMainActor 是全局 actor 之一，可以理解为主线程，主要用来隔离 UI 相关的代码。@MainActor 的属性包装，可以做来标记类、属性、方法或者全局属性。对于 MainActor 的切换，同样可以使用 await 来进行跳转，或者使用 @MainActor 来标记 Task，来将整个 Task 闭包切换到 MainActor。Task { @MainActor in ...}并发线程模型在使用异步函数时，我们没见到过自己去调度线程的情况，取而代之的是使用 Task 和 Actor。那么异步函数的线程调度是怎么完成的呢？异步函数与一直在同一线程上运行的同步函数不同，异步函数可能会被 await 分割，并由多个不同的线程协同运行。Swift 并发在底层采用了一种新的调度方式，称为协同式线程池：它使用一个串行队列来调度工作，将函数中剩余的执行内容抽象为轻量级的续体，然后进行调度。实际的工作运行则由一个全局的并行队列来处理，具体的任务可能会被分配到最多与 CPU 核心数量相等的线程中去。书中使用的异步线程模型图示特别的形象，这里直接搬过来： Excerpt FromSwift 异步与并发编程王 巍https://itunes.apple.com/WebObjects/MZStore.woa/wa/viewBook?id=0This material may be protected by copyright.假设我们有下面的代码：func bar1() {}func bar2() async {}func bar3() async { await baz()}func baz() async { bar1()}func foo() async { bar1() await bar2() await bar3()}func method() { Task { await foo() }} 当某个线程执行 method 时，Task.init 首先被入栈，它是一个普通的初始化方法，在执行完毕后立即出栈，method 函数随之结束。通过 Task.init 参数闭包传入的 await foo()，被提交给协同式线程池，如果协同式调度队列正在执行其他工作，那么它被存放在堆上，等待空闲线程： 当有适合的线程可以运行协同式调度队列中的工作时，执行器读取 foo 并将它推入这个线程的栈上，开始执行。需要注意的是，这里的“适合线程”和 method 所在的线程并不需要一致，它可能是另外的空闲线程 (因此我们这里使用的颜色和上面的栈有所不同)： foo 中的第一个调用是一个同步函数 bar1。在异步函数中调用同步函数并没有什么不同，bar1 将被作为新的 frame 被推入栈中执行： 当 bar1 执行完毕后，它对应的 frame 被出栈，控制权回到 foo，准备执行其中的第二个调用 await bar2()： 接下来我们会在这个线程中执行到 await bar2()，它是一个异步函数调用。为了不阻塞当前线程，异步函数 foo 可能会在此处暂停并放弃线程。当前的执行环境 (如 bar2 和 foo 的关系) 会被记录到堆中，以便之后它在调度栈上继续运行。此时，执行器有机会到堆中寻找下一个需要执行的工作。在这里，我们假设它找到的就是 bar2。它将被装载到栈上，替换掉当前的栈空间，当前线程就可以继续执行，而不至于阻塞了：当然，执行器也有可能寻找到其他的工作 (比如最近有优先级更高的任务被加入)，这种情况下 bar2 就将被挂起一段时间，直到调度栈有机会再次寻找下一个工作。不过不论如何，串行调度队列都不会停止工作。它要么会去执行 bar2，要么会去执行其他找到的工作，唯独不会傻傻等待。 当 bar2 执行完毕后，它被从堆上移除。因为在执行 bar2 前，我们在堆上保持了 foo 和 bar2 的关系，因此在 await bar2() 结束后，执行器可以从堆中装载 foo，并发现接下来需要运行的指令。在我们的例子中，await bar3() 将被运行。和 bar2 时的情况类似，底层调度使用 bar3 替换掉栈的内容，并继续在堆上维护返回时要继续执行的续体：需要注意，await bar2() 前后代码可能会运行在不同线程上，除非指定了 MainActor，否则协作式调度队列并不会对具体运行的线程作出保证。 bar3 中的第一个调用是 await baz()。这是一个在异步函数中调用其他的异步函数的情况，实质上它的情况和 foo 中调用 await bar2() 或 await bar3() 是相同的。baz 会替换调度队列所对应的线程的栈： 在这个栈中，同步方法 bar1 的调用依然在当前栈上进行普通的入栈和出栈：在异步函数定义的栈上调用同步函数，所执行的是普通的出入栈操作。因此在 Swift 异步函数中，我们是可以透明地调用 C 或者 Objective-C 的同步函数的。在底层，这种调用就是普通的同步调用。 当 baz 完成后，执行器从堆中找到接下来的续体部分，也就是 bar3，并将它替换到某个线程的栈中。虽然已经多次说明，但笔者依然想再强调一次，此时 bar3 的执行线程可能会和 baz 不同，也可能和 bar3 最早的执行线程不同，(虽然大部分情况下是一致的，但这是一个实现细节) 我们不应该对具体的执行线程进行任何假设： 最后，bar3 的执行也结束了，执行器最终寻找到一开始的 foo，并最终完成整个 Task 的执行：这节内容是本书的最后一章，这里也是本文的最后了。通过阅读本书，对 Swift 异步函数的使用，以及并发编程有了更加深入的认识，也意识到了一些能对已有代码进行重构的点，还是收获颇丰的！" }, { "title": "使用 Fastlane 在 GitLab 上搭建 Pipeline", "url": "/posts/ios-pipeline-gitlab-using-fastlane/", "categories": "iOS", "tags": "pipeline", "date": "2022-05-26 20:00:00 +0800", "snippet": "最近在 GitLab 上面给一个新的工程搭建了一条 Pipeline，所做的事情就是每次有代码提交，都会自动运行测试、安全检查然后打包上传到 TestFlight 以供测试。本以为基本上跟着文档做就会很顺利，不过这过程中还是踩了一些坑的，所以这边记录下来整个过程，希望可以形成一个完整的操作手册，只要一步步来基本就能完成搭建。1. 给自己的工程配置 Fastlane使用 bundler 来安装 Fastlane$ gem install bundler在根目录下创建一个 Gemfile 文件，并将下面内容放进去：source &quot;https://rubygems.org&quot;gem &quot;fastlane&quot;然后执行$ bundle install$ git add Gemfile Gemfile.lockFastlane 装好之后就该配置了，执行初始化之后选择手动配置，然后我们添加一个执行测试的自定义 lane.$ bundle exec fastlane init// Fastfiledefault_platform(:ios)platform :ios do desc &quot;Run tests&quot; lane :tests do run_tests( scheme: &quot;PipelineDemo&quot;, derived_data_path: &quot;~/Library/Developer/Xcode/DerivedData&quot;, ) endend2. 添加 GitLab pipeline 配置GitLab 的 pipeline 配置是通过 .gitlab-ci.yml 文件来完成的，先在工程根目录创建一个配置文件并添加一个 unit_tests 的 stage。stages: - unit_testsvariables: LC_ALL: &quot;en_US.UTF-8&quot; LANG: &quot;en_US.UTF-8&quot;before_script: - gem install bundler - bundle installunit_tests: stage: unit_tests script: - bundle exec fastlane tests tags: - ios有了配置之后，还需要有 runner 来运行。 GitLab Runner is an application that works with GitLab CI/CD to run jobs in a pipeline.这里有两个选项： 可以把 Runner 安装在自己的 macOS 上，等于是把自己的电脑作为服务器来跑 pileline。 使用 GItLab 提供的 shared runner，由 GitLab 管理，超过使用时长是要收费的。如果是个人开发者或者是小团队的话，可以使用第一个选项，配置简单也不需要付费，我个人使用过这种方式，基本按照官方文档 配置就可以了，这里要注意的是要把 shell 换成 Bash 才可以，其他没有什么坑。具体安装完之后的配置可以看这里。我最近做的配置是使用了 GitLab SaaS runner，下面针对这个方式的配置来进行说明。在 .gitlab-ci.yml 中添加对 runner 的指定：.macos_saas_runners: tags: - shared-macos-amd64 image: macos-12-xcode-13unit_tests: extends: - .macos_saas_runners stage: unit_tests ...完成这些，pipeline 应该就可以先工作起来了。3. 使用 match 来管理苹果开发者证书要打包上传到 TestFlight 一定绕不过证书签名这个环节。使用 fastlane match 能够使证书管理更容易。首先创建一个新的 private 的 repo 来存放 certificates 和 profiles。然后在项目根目录下执行 bundle exec fastlane match init，会生成一个 Matchfile 的配置文件，根据需求更改一下 branch 和 type。git_url(&quot;https://github.com/zhiying-fan/ios-certificates.git&quot;)git_branch(&quot;main&quot;)storage_mode(&quot;git&quot;)type(&quot;appstore&quot;) # The default type, can be: appstore, adhoc, enterprise or developmentapp_identifier(&quot;tools.fastlane.app&quot;)username(&quot;user@fastlane.tools&quot;) # Your Apple Developer Portal username然后执行生成证书并上传的命令，这里需要一个有权限创建 destribution 类型证书的开发者账号，权限是要 App Manager/Admin。$ bundle exec fastlane match appstore这个过程中会要求输入自己电脑 keychain 的密码，还会要求输入一个 passphrase，这个很重要一定要记住，是用来加密存放 certificates 的 repo 的，后续解密需要用到它，需要把它放在 CI 的环境变量中。执行成功之后，会自动生成 destribution 类型的 certificates 和 profiles，然后上传到 private repo。4. 在 GitLab 配置 ssh key根据 match 的文档，可以使用 ssh key 来让 pipeline 有权限获取到我们 private repo 的证书。做法是把私钥作为 CI 的环境变量，公钥作为证书 repo 的 deploy key，这个过程类似于我们平时使用 ssh 来和 github 上面的 repo 进行通信。一般我们的电脑上都会有 ssh key，会用来和 github 等的 repo 进行通信。所以这里在一个不同的文件夹下新建一对 ssh key，专门给 CI 用。ssh-keygen -t ed25519 -C &quot;&amp;lt;comment&amp;gt;&quot;Generating public/private ed25519 key pair.Enter file in which to save the key (/home/user/.ssh/id_ed25519): example/.ssh/id_ed25519下一步不要给这个 ssh key 设置 passphrase，因为 CI 上面是不能进行交互的，会带来一些麻烦，这个在 GitLab 的文档中也有提到。有了 ssh key 之后，分别把公钥配置在证书 repo 的 deploy key 中，私钥配置在 CI 的环境变量。配置公钥配置私钥配置 known hosts这一步文档上说的是 good practice，但是其实是必须要做的，不然 pipeline 会卡在 git clone 那一步，也就是不能实质性地访问到证书 repo。因为我们的证书 repo 是放在 gitlab 的，因此执行 ssh-keyscan gitlab.com 来获取 known hosts 的 Value。然后把值放入 CI 环境变量。在 pipeline 中 setup ssh在 sync_code_signing 获取证书之前，需要在 runner 的环境中配置好 ssh，需要执行以下 script 里面的命令。test_flight_build: stage: test_flight script: - eval $(ssh-agent -s) - echo &quot;${SSH_PRIVATE_KEY}&quot; | tr -d &#39;\\r&#39; | ssh-add - - mkdir -p ~/.ssh - chmod 700 ~/.ssh - echo &quot;${SSH_KNOWN_HOSTS}&quot; &amp;gt;&amp;gt; ~/.ssh/known_hosts - chmod 644 ~/.ssh/known_hosts # - fastlane beta tags: - ios only: - /^release-.*$/ - main5. 在 pipeline 中获取证书ssh 配置好之后，使用 fastlane 的 sync_code_signing Action 就能够获取到证书。但是这里在 CI runner 中碰到一个问题，就是默认的 keychain 不能访问使用，因此在此之前需要多加一步 setup_ci ，这个 Action 主要是创建了一个临时的 keychain 以供我们存放证书使用。// Fastfiledesc &quot;Submit a new Beta Build to Apple TestFlight&quot;lane :beta do setup_ci sync_code_signing(readonly: true)end6. Build App有了证书之后就能 Build App 生成 ipa 包了。这里需要注意的是需要修改一下 Xcode 的配置，将 Release 的签名方式改为手动，明确指定 Profile 为我们用 match 生成的 Profile，不然在 pipeline 会报错找不到对应的 profile。添加 build app 的 Action：// Fastfiledesc &quot;Submit a new Beta Build to Apple TestFlight&quot;lane :beta do setup_ci sync_code_signing(readonly: true) build_app( scheme: &quot;PipelineDemo&quot;, export_method: &quot;app-store&quot;, )end7. 生成并配置 App Store Connect API KeyBuild 好之后就可以上传了，这里涉及到苹果服务的 Authentication，即我们需要能够访问到我们自己的苹果开发者账户然后进行上传。Fastlane 提供了四种方式，分别如下： Method 1: App Store Connect API key (recommended) Method 2: Two-step or two-factor authentication Method 3: Application-specific passwords Method 4: Apple ID without 2FA (deprecated)由于现在苹果的 2FA 是强制打开的，所以方式 4 不可行。方式 2 要求提前在上传的机器上获取一个有效的 session，并提供给 Fastlane，由于我们使用的是 SaaS 服务并且 session 很快就会过期，因此在 CI 上其实也是行不通的。方式 3 经过试验，还是会提示需要 2FA 的验证码，所以不行。最后只剩下方式 1 可行，这个也是推荐的方式。生成 API Key到 App Store Connect Keys 的界面，这一步需要有 Admin 权限的账号，并且需要 Account Holder 授权才行。被授权之前长这样，如果看不到 Keys 这个 Tab，说明你不是 Admin。有了权限之后，就可以生成 Key 了。生成之后，记得把下载下来的 API Key 保存好，因为只能下载一次。配置 API KeyAPI Key 的这些信息是可以配置在 CI 的环境变量的，具体怎么知道 Fastlane Action 的哪些参数可以从环境变量获取，可以通过执行 fastlane action action_name 来获取。例如接下来要用到的命令：app_store_connect_api_key 这个 Action 可以生成一个 APP_STORE_CONNECT_API_KEY 以供其他的 Action 使用。从上图中可以看到，它需要的 key_id issuer_id key_content 这些关键信息，都可以从环境变量读取，具体的环境变量的 Key 在后面也有提供。注意这里使用 key_content 而不是 key_filepath 是因为在 CI 上设置值是可行的，目前没有找到在 GitLab 的环境变量中怎么配置文件。因此需要把下载下来的那个 .p8 的 Key 文件转换成 base64 的文本。cat {KEYNAME} | base64然后把这个作为值放在环境变量中，并且把 is_key_content_base64 设置为 true 。// Fastfile desc &quot;Submit a new Beta Build to Apple TestFlight&quot; lane :beta do setup_ci sync_code_signing(readonly: true) build_app( scheme: &quot;PipelineDemo&quot;, export_method: &quot;app-store&quot;, ) app_store_connect_api_key( is_key_content_base64: true, duration: 1200, ) end8. 上传到 TestFlight终于到了最后一步，可以上传了，准备工作都做好了之后，只需要在最后加上 upload_to_testflight 就可以了。完整的配置总结.gitlab-ci.yml.macos_saas_runners: tags: - shared-macos-amd64 image: macos-12-xcode-13stages: - unit_tests - test_flightvariables: LC_ALL: &quot;en_US.UTF-8&quot; LANG: &quot;en_US.UTF-8&quot;before_script: - gem install bundler - bundle installunit_tests: extends: - .macos_saas_runners stage: unit_tests script: - bundle exec fastlane tests tags: - iostest_flight_build: stage: test_flight script: - eval $(ssh-agent -s) - echo &quot;${SSH_PRIVATE_KEY}&quot; | tr -d &#39;\\r&#39; | ssh-add - - mkdir -p ~/.ssh - chmod 700 ~/.ssh - echo &quot;${SSH_KNOWN_HOSTS}&quot; &amp;gt;&amp;gt; ~/.ssh/known_hosts - chmod 644 ~/.ssh/known_hosts - bundle exec fastlane beta tags: - ios only: - /^release-.*$/ - mainFastfiledefault_platform(:ios)platform :ios do desc &quot;Run tests&quot; lane :tests do run_tests( scheme: &quot;PipelineDemo&quot;, derived_data_path: &quot;~/Library/Developer/Xcode/DerivedData&quot;, ) end desc &quot;Submit a new Beta Build to Apple TestFlight&quot; lane :beta do setup_ci sync_code_signing(readonly: true) build_app( scheme: &quot;PipelineDemo&quot;, export_method: &quot;app-store&quot;, ) app_store_connect_api_key( is_key_content_base64: true, duration: 1200, ) upload_to_testflight endendCI 环境变量MATCH_PASSWORD: ******SSH_PRIVATE_KEY: ******SSH_KNOWN_HOSTS: ******APP_STORE_CONNECT_API_KEY_KEY_ID: ******APP_STORE_CONNECT_API_KEY_ISSUER_ID: ******APP_STORE_CONNECT_API_KEY_KEY: ******参考 Fastlane Setup Fastlane GitLab CI Integration GitLab SaaS runners on macOS Fastlane match Generate an SSH key pair Create a project deploy key Using SSH keys with GitLab CI/CD iOS Beta deployment using fastlane Fastlane setup_ci Authenticating with Apple services App Store Connect API" }, { "title": "Desperate Housewives S01E03", "url": "/posts/english-desperate-housewives-s01e03/", "categories": "English", "tags": "english", "date": "2022-05-24 20:00:00 +0800", "snippet": "Desperate Housewives S01E031–She was his wife.她是他妻子2–He deserves to have all the facts.他有权知道事情的真相3–She abandoned her husband and her 但她就这样抛弃了她的丈夫和孩子4–son and I’ll never forgive her.我永远不会原谅她5–It’s the age-old question,又回到老问题上了6–how much do we want to know about our neighbors?我们到底有多想知道邻居的秘密7–You gonna cancel the meeting with the divorce lawyer.请你取消和离婚律师的见面8–We’ll find a marriage councilor.我们去找个婚姻顾问9–I’m Mike Deifino.我是麦克·德尔非诺10–Susan Mayer. I live across the street.我是苏珊·梅尔 我住对面11–If you wanna dating him,想跟他约会12–you’re gonna have to ask him out.得主动约他13–I keep hoping he’ll ask me out.我一直希望他能来约我14–I really hate the way you talk to me.我讨厌你跟我说话的语气15–I hate that I spent $15,000 on your diamond necklace,我讨厌花一万五千块买条钻石项链16–but I’m learning to deal with it.但是我学着接受了17— Do you love him? - I do.-你爱他吗 -当然18–So then why are we here? Why are we doing this?那我们为什么还在这偷情19–Because I don’t want to wake up one morning,因为我可不想某天醒来20–With a sudden urge to blow my brains out.想把自己的脑袋打爆21–After I died,我死了以后22–I began to surrender the parts of 我开始放弃那些23–myself that were no longer necessary.对我来说已经不再重要的东西24–My desires, beliefs, ambitions, doubts –欲望 信念 抱负 猜疑25–every trace of my humanity was discarded.我的七情六欲都已不复存在26–I discovered when moving through eternity,当我迈入永生的瞬间27–it helps to travel lightly.我发现我变得轻松多了28–In fact, I held on to only one thing 但是 我依然保有一样东西29–my memory.那就是我的记忆30–It’s astonishing to look back on the world I left behind 当我回头看身后的世界31–I remember it all –真是令人吃惊32–every single detail.每个细节都历历在目33–Like my friend Bree Van de Kamp.比如我的朋友布里·范德坎普34–I remember the easy confidence of her smile,我还记得她自信的微笑35–the gentle elegance of her hands,优雅的手势36–the refined warmth of her voice.亲和的语气37–But what I remember most about Bree 但最难忘的38–Rex, wasn’t that lovely –雷克斯 晚餐很棒吧39–Was the look of fear in her eyes.是她眼神中的恐惧40–Bree had started to realize her world was unraveling,布里发现她的世界正在分崩离析41–and for a woman who despised loose ends,对于凡事求完美的她来说42–that was unacceptable.这是不可接受的43–Rex. Rex. You need to get up.雷克斯 起来了44–It’s not even light out.天还没亮呢45–Please hurry.快起床46–If the kids see you sleeping down here,如果孩子们看到你睡在这儿47–they’re going to start asking questions.他们会问东问西的48–Let ‘em ask. I don’t care anymore.让他们问好了 我不在乎49–Well, I care.可我在乎50–They don’t need to be burden with our marital problems 没必要让他们察觉出我们之间出问题 了51–While we’re working things out, the least 我们尽快把关系修缮好52–we can do is try to keep up appearances.现在至少需要做些表面功夫53–Oh, yeah. Appearances.是啊 表面功夫54–I keep forgetting about appearances.我都忘了得做做表面功夫55–Oh, Rex, you look so tired.雷克斯你看起很疲惫56–I didn’t sleep.我根本睡不着57–This damn thing is so uncomfortable.这东西睡起来真不舒服58–Well, why don’t you move back upstairs and sleep in our bed?何不搬回楼上 睡我们的床59–We’re in marriage counseling, Bree.我们现在在接受婚姻咨询60–I think that would confuse things.我们需要搞清楚这点61–It’s just–可是62–I miss you.我想你63–I know you do.我知道64–Of course, if I don’t find out start 当然 如果我还是无法入睡65–getting some sleep, pretty soon 我迟早会因为疲劳过度66–I’ll be forced to move back upstairs out of sure exhaustion.被迫搬回楼上去睡67–Yes, Bree was afraid of many things,没错 布里害怕很多事68–but if there was one thing she wasn’t afraid of…但是有一样她从不害怕69–it was a challenge.就是挑战70–The day on Wisteria Lane began like any other.紫藤郡的早晨 平静如往昔71–With a cup of coffee and the moring paper.咖啡和早报 一天的生活便开始了72–Just give me a second….让我安静一会儿73–And while Lynette read the business section.勒奈特开始了经济版的阅读74–And Gabrielle studied the fall collections 加布丽尔在研究秋季时装75–And Bree searched for decorating ideas 布里在报上寻找装饰的小贴士76–Susan scanned the front page and saw something 苏珊在浏览头版时 报纸的日期77–that caught her eye 引起了她的注意78–美景先驱报 2004 年 10 月 15 日79–玛丽·艾莉丝的晚宴80–What’s about time.都几点了81–Be nice. I come bearing snacks.别这样 我带了零食哦82–Lynette, these cards are sticky 勒奈特 这些扑克很黏83–I know. Preston used the three of diamonds 我知道 普雷斯顿用了三张方块84–to took scoop jam out of the jar.去挖罐子里的果酱85–Gorgeous, thankful we have 49 cards to play with.真好 我们还有 49 张牌能玩86–Hello. Sorry I’m late.大家好 对不起我来晚了87–So, Susan and I was just telling the girls,苏珊 我刚才正跟大家说88–I want to throw a dinner party 我想办一个晚宴89— Really? - Yes.-真的吗 -是的90–Well how long have we all lived on this street 我们大家都住这儿很久了91–we’ve never done a big group thing 一直没有机会聚聚92–I think it’s a great idea 这主意不错93–Paul never likes to have people over 保罗从来不欢迎大家过去94–but the heck with him I’m doing it.管他呢 反正我要办一场95–So when is this shindig?晚宴什么时候举行呢96–How about a month from tonight?下个月的今天怎么样97–That would be the 16th. Good for everyone?16 号 大家都有空吗98–Works for me. Should we all make something?我没问题 我们都做点什么呢99–Oh, no. This is my party.不必了 交给我就行100–I’ve been wanting to have everyone over for years.我一直期盼能邀请大家来我家101–I’m so happy we’re finally doing this.我很高兴 这个想法终于快实现了102–It’s gonna be so much fun.肯定会很有趣103–I know. Her dinner.我知道 她的晚宴104–How could we have all forgotten about this?我们怎么把这事儿都给忘了105–We didn’t exactly forget, it’s just usually 我们其实没忘 只是通常106–when the hostess dies the party’s off.如果女主人死了 宴会就自动取消了107–Lynette 勒奈特108–I’m not being flip. I’m just pointing out a reality.不是我无礼 我只是说事实109–Mary Alice was so excited about it.玛丽·艾莉丝很期待这次聚会110–It’s so sad.真是不幸111–I think we should go through with it.我们来帮她办吧112–Really? Wouldn’t that be in poor taste?你确定 这样未免不太合适吧113–No. It’s sort of a way to honor Mary Alice.这也是一个纪念玛丽·艾莉丝的方式114–It was so important to her 这个宴会对她来说很重要115–We could all use a fun night.我们也可以放松下116–Well, good, because I have some new flour 那正好 我购买了新面粉117–that I have been just dying to show off.早就迫不及待想让你们尝尝了118–Lynette?勒奈特119— I’m in. - I’ll make braised lamb shanks.-我同意 -我要做炖羊腿120–I’m still in.我还是同意121–So how many I will be cooking for?我得准备几人份的晚餐呢122–Seven. Three couples and Susan. Does that sound right?7 份 三对夫妻外加苏珊 对吧123–No, it sounds very, very wrong.不 大错特错124–Is there somebody you’d like to invite?你想邀请谁125–I have an idea.我有个想法126–A dinner party.一个晚宴127–Honey, I may be working late.宝贝儿 我可能会工作到很晚128–The Dillman proposal’s a complete mess.德尔曼的建议真是一团糟129–No, no, you promised to be home every night this week.不行 你答应这几晚都会在家陪我的130–I’ll try but I can’t guarantee anything.我只能尽量 但我没法保证131–This is business.做生意就是这样132–Says the prince 王子也是这样说的133–as he rides off into the sunset.然后他就骑着马消失于夕阳中134–Boy the movies ever get that wrong.看来电影说的没错135–You know what your problem is?你知道你的问题出在哪儿吗136–You’re very tense.你太紧张了137–You should go to a spa or go shopping.做水疗也好 购物也好138–Find a way to relax.总之放松放松139–Hello?喂140–Where are you?你在哪141–Algebra.上代数课142–You free at 4:00?你四点能来吗143–I’m not sure. I got track after school.不确定 下课后我要参加田径赛144–Well, get here as fast as you can.那尽快过来145–My husband says I need to relax.我老公说我应该放松一下146–You, uh, want me to keep my gym clothes on like last time?你想让我像上次一样 穿着运动服 去吗147–If you would, please.如果你不介意 当然可以148–A dinner party?晚宴149–Yeah, it’ll be fun.肯定会很有趣150–Bree’s cooking, everyone’s coming.布里做饭 每个人都去151–You know what? I haven’t even had 我都来不及152–a chance to unpack yet, honey.打开行李 亲爱的153–I just, uh, I just need to chill out for the next few days.我只是想清静几天154–Oh, Tom.汤姆155–There’ll be liquor and hors d’oeuvres and 宴会上有酒 开胃小菜156–grownups without children and – and silverware.都是大人 没有孩子 还有银制餐具157–Remember silverware?知道吗 是银制餐具158–Honey, can you take this in for me?亲爱的 帮我把这个收起来好吗159–Have you heard anything I just said?你有没有在听我说160–Yeah, I’m sorry. I’m just – I’m wiped out.对不起 我只是 太累了161–Three cities in six days – my head is just pounding.六天去了三个城市 我的头都快炸了162–I’m not ready for a dinner party.我没有精力再去晚宴了163–I already got a sitter.我已经找好保姆了164–Can you cancel her?不能辞退吗165–Please? Look, let’s just stay in tomorrow night.求你了 你看 我们明晚就待在家166–We can get a bottle of wine and rent a video,开瓶酒 租个碟167–and-I just want to hang out with my best gal.我只想跟我最爱的女人待在一起168–That’s all.就是这样169–I was looking so forward to a night out.我每天都期盼着 晚上可以出去170–I know, sweetie, I’m sorry, but…我知道 亲爱的 我很抱歉 但是171–I’m beat.我也很无奈172–I mean, do you remember what it 还记得173–was like to work a 60-hour week?一周工作 60 小时的时候吗174–A dinner party?晚宴175–Do I have to go?我必须去吗176–Well, given that we’re hosting it, I’d say so.鉴于由我承办 我不得不说 是的177–By the way, you won’t be drinking at this party.补充一下 你在晚宴上不能喝酒178–Why is that?为什么179–Because when you drink, you get chatty.因为你一喝酒 话就多180–No one needs to know that we’re seeing Dr. Goldfine.我们的婚姻咨询没必要让别人知道181–You know, if you spent half as much time working 你知道吗 如果你能把用一半掩盖问题的时 间182–on our problems as you do covering them –来解决问题 那…183–Not a drop.不可能184–You know, this – this is ridiculous.这太可笑了185–And this whole thing about us taking tennis lessons?说我们是去上网球课186–Well, the nurses at your office may start wondering 你诊所的护士已经开始好奇187–why you’re disappearing three times a week.为什么你一周内失踪了三回188–Tennis lessons are a plausible alibi.上网球课是个可信的托辞189–All right so, these tennis lessons we’re taking –那么 我们的网球课190–how are we doing?进展如何191–My backhand’s improving immensely,我的反手有明显进步192–but you’re still having problems with your serve.但你的发球还存在很大问题193–Of course.好吧194–A dinner party?晚宴195–It’s tomorrow night, so if you could 明天晚上举行 所以你能否196–just keep Julie an extra day.帮忙照看朱莉一天197–Fine, but that’s all. Brandi and I leave 行 不过我和布兰迪周末198–sunday for a week up at the cabin.要去小木屋住一周199–What cabin?什么小木屋200–Brandi wanted some place where we could get away.布兰迪希望我们能出去走走201–Escrow just closed yesterday.昨天刚完成一单契约202–You can afford a cabin,你有钱去住小木屋203–but you can’t scrape up child support?却凑不齐孩子的赡养费204–The check is in the mail.支票我已经寄了205–Oh. No, it’s not.没收到啊206–I found my dental guard. I’m ready.护齿套找到了 可以走了207–Stop fighting.别吵了208–We are being as nice as we possibly can to one another.我们已经尽可能友好相处了209–Like I said, stop fighting.听我说 别再吵了210–Excuse me, Brandi.不好意思 布兰迪211–Do you mind?麻烦你捡起来好吗212–Oh, okay.好的213–Wait. Susan, you’re right there. You can pick it up.等等 苏珊 就在你边上 捡一下不就得了214–I could, but she’s the one who threw it.我可以捡 但这是她扔的215–Come on. Don’t be petulant.拜托 别无理取闹了216–Just pick up the stupid can.你就捡一下那该死的罐头吧217–No.我偏不218–I can pick it up.我来捡吧219–Honey, stay out of this.宝贝 你别管220–Fine.很好221–This is so typical.你总是这样222–Oh, I’m sorry. Was that petulant, too?真抱歉 我又无理取闹了223–You know what? You can pick up the damn can yourself.听着 你自己去捡这该死的罐头吧224–Yeah, well, you just go to hell.去死吧你225–You want me to pick it up?需要我帮忙捡吗226–Mrs. Warmington said she looked for 沃明顿太太说她227–mom’s obituary and couldn’t find it.没找到妈妈的讣告228–Did you put one in?你发了吗229–I’ve had other things on my mind, Zack.扎克 我有很多事要忙230–But how could you not do that?你怎么能连讣告都不发231–People are going to think we didn’t care about her.别人会以为我们不在乎她232–I doubt people will give it much thought.我不觉得别人会太在意这事233–Don’t worry about it.别担心234–You never talk about her.你都没谈起过她235–She hasn’t even been dead a month,她去世不到一个月236–and it’s like you’ve totally forgotten she ever existed.你就好像已经把她忘得一干二净237–It’s a little early for this kind of talk.我们不该在这时候谈这个238–Maybe when you die,或许哪天你死了239–I won’t put in an obituary.我也不会登讣告240–That will be your choice to make.你自己决定241–Assuming you outlive me.前提是你得活得比我久242–Mom, it’s no big deal.妈 没什么大不了的243–Carlos and I are driving in for the baptism.我和卡洛斯会赶去洗礼的244–Problem solved.那就搞定啦245–Okay, fine.嗯 好的246–You go with aunt Maria,你和玛利亚姨妈先去247–and I will take Nana to church.随后我会带祖母去教堂的248–Take your clothes off.快脱衣服吧249–Okay. I got to go, mom.好的 妈我还有事250–Yes, right now.对 就现在251–Okay, you can give me directions later. Bye.那你晚点告诉我怎么走 再见252–Hi. How was school?在学校表现如何啊253–Got an a-minus on my biology exam.生物考试得了 A-254–You did?很好255–Well, let’s see what you’ve learned.那就来看看你都学到点什么256–Who’s that?那是谁257–I don’t know.我不认识258–Hey, you!你站住259–So did Mike say anything?麦克没说什么吗260–No, but, god, you should have seen the look on his face.没 但你真应该看看他当时的表情261–I’m sure it’s not that bad.没那么糟吧262–I mean, he’s coming to the party, right?他会来参加晚宴吧263–I left three messages.我留了三条言264–Oh, he’s not going to come. Big surprise.他绝不会来的 毫无悬念265–I did everything but foam at the mouth.我差点就口沫横飞了266–God, I hate when I get that way.天哪 我恨死那样的自己了267–It’s like every time I get within 10 feet 好像每次只要我和卡尔距离不到 10 英尺268–of Carl, I just become this monster.我就表现得像个怪物269–You know what? It’s not going to change until 要知道 只有彻底解决和他的问题270–you resolve your issues with that man.才能改变现状271–What, you mean forgive him?什么 你要我原谅他272–You know, I’ve lived with this bitterness 我在怨念中活得太久了273–so long, I think I’d be lonely without it.没了它反而会让我觉得空虚274–Honey, get a pet.亲爱的 养个宠物吧275–See ya.再见276— Son of a - It’s a business meeting.-哇靠 -这是个商务会议277–It’s a frat party.明显是狐朋狗友大碰头278–Regional manager, corporate manager, head of sales.地区经理 公司经理 销售主管279–Margarita, cigar, sombrero.美酒 雪茄 宽边帽280–Honey, what do you want me to do, sit around 亲爱的 那你想我怎么样281–the hotel the whole time watching cable?整天呆坐在酒店里看电视282–No. But when I say,不 但当我说283–“we’ve been invited to a party,”我们去晚宴吧284–Don’t whine about your exhausting 60-hour week.别老拿你一周工作 60 小时敷衍我285–Put on your dancin’ shoes and take the 穿好你的舞鞋286–mother of your children out for a good time.带着我一起共度美好时光287–Fine. You know what? You’re right.好吧 你说的没错288–Let’s go to that party.我们去参加晚宴吧289–I can’t. I already canceled the sitter.不行啊 我都让保姆别来了290–Okay, well, we’ll throw the next one.那就我们来办下一次聚会291–Throw a dinner party?办一次晚宴292–I don’t even have time to wash my face.我都没时间洗脸293–No, you know what?这样吧294–I’m going to go to this one.这次我会去295–You can stay home and babysit the kids.你待在家带孩子296–Fine.好吧297–I can handle that.我应付得来298–Thank you.谢谢299–Gabrielle spent her morning searching 加布丽尔整个早上都在找300–for the mysterious little girl.那个神秘的小女孩301–Sadly for her,悲剧的是302–the mystery was solved a bit too quickly.女孩找到了 但没想到如此戏剧性303–What’s going on?怎么了呀304–Have you met Ashley?你认识阿什莉吗305–Found it!找到了306–Babe, this is Sheila Bukowski, our new neighbor.宝贝 这是我们的新邻居希拉·布考斯基307–They just moved into the miller’s old house.他们刚搬进米勒的老房子308–My daughter left her ball in your yard. I’m so sorry.很抱歉我女儿把球丢在你们院子里了309–Oh, oh, no – no problem.没关系310–Nice to meet you, Ashley.很高兴见到你 阿什莉311–She’s shy. She doesn’t say much.她很腼腆 话不多312–Yeah, but I can see her little mind working away.但我看得出她的小脑瓜精灵得很313–Nice meeting you.很高兴认识你们314–Come on, Ashley.走吧 阿什莉315–Private sessions?单独交流316–I don’t understand. Why do we need private sessions?我不懂我们为什么要单独交流317–Private sessions allow us to work on 单独交流有利于我们318–the personal issues of both partners.解决各自的私人问题319–Oh, well, I don’t have any personal issues.我没什么私人问题320–My only issue is that my husband wants to leave me,我唯一的问题就是我丈夫想离开我321–and how can I work on that if he’s not in the room?要是没有他 我的问题怎么解决322–There are things I need to discuss with 是我想和高德芬博士单独谈谈323–Dr. Goldfine, and I can’t have you there.希望你能回避下324–Why?为什么325–I’m your wife. You can say anything in front of me.我是你老婆 有什么我不能知道的326–All we need is a few more sessions, and I’m sure we can –只要多交流下 我们肯定能327–Damn it, Bree,闭嘴 布里328–a few more sessions isn’t going to fix us.谈几次话根本是徒劳329–This is bigger than that.我们的问题很严重330–Why don’t we do it this way?要不我们试试这样331–Rex, you can take the first half-hour.雷克斯 前半个小时你先来332–Bree, you can take the second.布里 你后半小时再来333–Fine.好吧334–Oh, and, doctor,博士335–if what he’s about to discuss has anything to do with 要是他的讲话内容涉及336–adultery, prostitution, or internet pornography,通奸 卖淫 或是网络色情337–I would really appreciate you taking a moral hard line.我希望您能坚守道德底线338–Hi, Ashley.嗨 阿什莉339–Remember me? We – we met earlier.还记得我吗 我们之前见过340–Aren’t you the little artist?你真是个小画家啊341–What are those – flamingos?那些是什么 火烈鸟342–No.不是343–Well, they’re very pretty.画得很漂亮344–It almost looks like they’re kissing.它们仿佛在接吻345–Funny thing about kissing –其实接吻这件事346–It’s not just for husbands and wives.并不是夫妻间才能做的哦347–Sometimes we kiss our mom or our grandpa.我们有时会亲亲妈妈或者爷爷348–Sometimes we even kiss our dog. Ha ha.有时会亲亲小狗349–Sometimes we even kiss people who are just our friends,有时还会亲吻我们的朋友350–kind of like a high-five on the lips. Right?像是在用嘴唇来击掌 对吗351–Hey, Ash,阿什啊352–I was at the mall, and I saw this.我刚在商场看到这个353–I thought you might like it.我猜你会喜欢354–She’s Hawaiian.她来自夏威夷355–Her name is princess Kahalua,是卡哈鲁瓦公主356–and I think it means “little waterfall,”涵义大概是”小瀑布”357–or “big pond” or something.或者”大海”之类的358–So we’re good, right?那我们没问题了 是吧359–Well, you enjoy your new little friend,你和你的新朋友玩360–and if there’s anything else you need, you just let me know.还需要什么就告诉我361–What I’d really like 我想要的362–is a bike.其实是自行车363–Where did you find that?你在哪儿找到的364–She used this to kill herself.她就是用这自杀的365–Why would you keep it?你为什么还留着366–Why?为什么367–Because I thought we might need it someday.因为我觉得有天会用上368–For what?用在哪里369–Protection.自卫370–I want to talk about mom.我们得谈谈妈妈371–You need to take your medication.你该吃药了372–We are going to talk about mom.我们必须得谈373–Hello, Zack.嗨 扎克374–I hope this isn’t a bad time.希望没打扰到你375–What can I do for you, Mrs. Van de Kamp?范德坎普太太 你来有什么事吗376–Well, I wanted to invite you and your 我想请你和你爸爸377–father to a dinner party tomorrow night.明晚来参加晚宴378–I’m not sure where he is right now.我不知道他现在在哪儿379–Oh. Well, I’m sorry it’s such late notice, but, well,我很抱歉 这么迟才告诉你们380–we weren’t sure that you and your father were 我们不确定你们父子俩381–ready for any kind of social engagement yet,是否调整好情绪参加社交382–but, we’re sort of throwing it in your mother’s honor.这次是我们为纪念你母亲而办的383–Really?真的吗384–Yes, it’s just going to be a casual night with the gang.没错 就是大家聚一聚385–We’re going to eat and tell fun stories about your mom.边吃饭边讲些关于你妈妈的趣事386–Zack… Are you okay?扎克 你还好吗387–Hello, Bree.你好 布里388–Oh, hi, Paul. I was just –你好 保罗 我就是想389–I heard.我都听到了390–Thank you, but we already have plans for tomorrow.谢谢 但我们明天有事391–Oh. That’s too bad.那太遗憾了392–Well, I should go.我该走了393–Thank you, Mrs. Van de Kamp.谢谢您 范德坎普太太394–For what, Zack?谢我什么 扎克395–Remembering my mom.谢谢您还惦记着我妈妈396–That night, Paul gave his son something 那晚 保罗给他儿子一些东西397–to calm his nerves,来抚慰他的紧张398–And the next day, Gabrielle calmed her own nerves 第二天 加布丽尔给新朋友送个礼物399–by giving something to her new best friend.来抚慰自己的紧张400–Here you go.给你的401–Top of the line, 3-speed, aluminum frame,最新款 三倍变速 铝制车身402–handlebar ribbons, and a bell,把手缠绕着丝带 还有个铃403–and you’ll notice it’s royal blue 而且还是宝蓝色的404–to match your pretty little eyes.和你漂亮的眼睛一样405–My eyes are green.我的眼睛是绿色的406–Yeah, well, you’ll be cruising so fast 好吧 你戴上这个407–on this, no one will even notice.飞驰而过 没有人会注意的408–It’s all yours, hon.这些都是你的409–Have fun.玩得开心410–What? What’s wrong?怎么了 有什么不好吗411–I don’t know how to ride a bike.我不会骑车412–What?什么413–Well, then, why did you ask for one?那你为什么向我要一辆414–Why can’t you show me?为什么你不能教教我415–Sure, one of these days.行 改天吧416–What’s wrong with now?为什么不能现在教417–After her talk with Lynette,在她和勒奈特谈过之后418–Susan decided to take a look at her old photo album,苏珊决定看看她以前的相册419–and she began to see herself in a whole new light,她开始重新审视自己420–and the picture wasn’t flattering.但那些照片依然不能让她开心起来421–Yeah, you got Karl. Leave a message.你好 我是卡尔 请留言422–Hey, Karl, it’s me.卡尔 是我423–I was hoping you’d be there.我很希望你在424–Um, listen, we need to talk,听着 我们得谈谈425–so maybe when you drop Julie off tomorrow,明天你送朱莉回来的时候426–we could have a moment.或许我们能谈谈427–It’s important.这很重要428–Give my best to…代我向429–Brandi.布兰迪问好430–Call me.回我电话431–Susan was proud of herself.苏珊为自己感到骄傲432–She was finally ready to let go of her anger.她最终打算不生气了433–Almost.她差点就成功了434–The boys will be hungry at 5:30,孩子们五点半就饿了435–so put the fish sticks in the toaster oven at 5:00.所以五点就要把鱼肉条放进烤箱436–For half an hour. Honey, I know.烤半小时 亲爱的 我知道437–This is the third time you’ve told me.你已经说了三遍了438–Well, if the food’s late, god help you.好吧 如果孩子们没及时吃到饭你可就惨了439–Beautiful, I don’t need a pamphlet.知道了 我不需要一本小册子440–It’s not brain surgery.这又不是什么脑部手术441–They’re just kids, for god sake.拜托 他们只是些孩子442–Preston, would you come here?普雷斯顿 过来一下443–Sweetie,宝贝儿444–you know our rule about eating cookies, right?你知道我们吃小饼干的规矩445–Yeah, we can’t have them after 5:00,是的 我们五点后不能吃446–cause sugar makes us hyper.因为糖会引起多动症447–Yeah, but tonight, anything goes.但是 今晚 什么都可以吃448–Make sure you share with your brothers.和你的兄弟一起吃449–Thanks, mom.谢谢妈妈450–Don’t look at your feet. Don’t look at your feet.不要向下看 别向下看451–Look at the road. Look at the road. Good.看路 看前面的路 不错452–Find your balance. Find your balance.找到平衡点453–Okay, it’s all you. It’s all you! you’re doing great!就这样 你骑得好极了454–Okay, stay to the right. Watch the car.往右骑 小心车455–Watch the car! Watch the car!小心那辆车456–Oh! Are you okay?你没有受伤吧457–Yeah. Let’s go again.我很好 我们再来一遍458–Oh, honey, these heels don’t have another block in them.亲爱的 我穿着这鞋可不行459–What about tomorrow?明天怎么样460–Well, you won’t be around tomorrow, ‘cause you have school.明天你就不能在这玩了 因为你 要去学校461–I’m homeschooled.我是在家学习的462–I’m always around.我可以经常出来玩463–It was in that moment that Gabrielle 那一瞬间加布丽尔464–realized this ride was far from over.意识到这只是个开始465–I’m coming!我来了466–Karl, what are you doing here? I asked you to come tomorrow.卡尔 怎么是你 我让你明天来467–You said you wanted to talk. It sounded important.你说想要谈谈 听起来很重要468–Tomorrow. I’m in a towel.明天吧 我只披了一条浴巾469–We were married 14 years.我们结婚十四年了470–I know what’s under there. Come on.拜托 我有什么没见过471–I’m not really ready for this.我还没有准备好472–I was going to have a whole speech prepared.我打算为这次谈话好好准备一下的473–Brandi and I have plans tomorrow.布兰迪和我明天有其他计划474–I suggest you wing it.我建议你现在就说475–Um, okay.好吧476–Here’s the thing, Karl –是这样的 卡尔477–I was thinking about what happened 我一直在想发生过什么478–in the driveway yesterday,在昨天回家的路上479–and I-I just don’t want to –我并不想480–I don’t want to live like that.要那样的生活481–I don’t want to be that kind of person,我不想变成那种人482–and I just thought if the two of us,我只是想 如果我们两个483–you know, if we had a nice, calm –能够温和的 平静的484–I need an apology, Karl.我需要一个道歉 卡尔485–A what?一个什么486–An apology for the way you ended our marriage.一个道歉 你就那样结束了我们的婚姻487–You never took any responsibility for your behavior.你从来不为你的行为负责488–I don’t know what to say, Susan.我不知道该说什么 苏珊489–The heart wants what it wants.我想得到自己想要的东西490–What does that mean?那是什么意思491–I fell in love.我恋爱了492–While you were married to someone else.当你有家室的时候493–The heart wants what it wants.我的身心不受控制494–Yeah, well, my heart wants to hurt you,我很想伤害你495–But I can control myself.但是我能控制我自己496–I-I don’t want to go back to that ugly place, really,我不想无休止地争论这个问题497–and if you do, I suggest that you get some help.如果你还想 我建议你去寻求帮助498–You know what?你知道吗499–I don’t need an apology.我不需要道歉500–I don’t need anything from you.我不需要你的任何东西501–You’re humiliating yourself.你在自取其辱502–No, you’re the one who’s been humiliated, Karl.你才是那个自取其辱的人 卡尔503–Why don’t you see that?你为什么就视而不见呢504–You walked out on your family.你抛弃了你的家庭505–People think you’re scum, not me,大家都觉得你是人渣 而不是我506–so worry about yourself. I’m okay with me.我没问题 我担心的是你507–I can walk down the street and hold my head high.我可以挺胸抬头地走在大街上508–As the sun slowly settled on Wisteria Lane,紫藤郡的太阳慢慢下山了509–an unsettled Susan racked her brain 还没有着落的苏珊想尽了办法510–to find a way into her own house.如何进家门511–Lying naked in her shrubs,赤裸着躺在了她家的灌木丛中512–it occurred to Susan this could be the 对于苏珊来说这可能是513–most humiliating moment of her life.一生中最丢脸的事514–Susan?苏珊515–She was wrong.她错了516–Uh, whatcha doing?你在干什么517–Locked myself out…把自己反锁在外面518–naked.还赤裸着519–And then I fell.然后我就摔倒了520–So how are you?你呢521–I just got back.我刚刚回来522–I’ve been gone all day,我出去了一整天523–and I got your messages about dinner,收到你的邀请留言524–and, um, I would love to come if that invite still stands.我很高兴参加 只要你还愿意的话525–It’s a date.就这么定了526–All right. I, um…好的527–assume the dress is casual.穿休闲装行吗528–Yeah. It’s – it’s casual.好的 就休闲装529–Thanks for helping me break in.谢谢你帮我破门而入530–Do you think it’ll be hard to replace that screen?你觉得把还能把那个纱窗还能还原吗531–It depends.看情况532–If you nail it in yourself, you might want to wear gloves…如果你要自己钉 你需要一副手套533–Or pants. Pants wouldn’t hurt.还有裤子 穿裤子不会受伤534–Okay, I know what just happened is funny in theory,事实上 我知道刚才的事很可笑535–but I’m nowhere near ready to laugh about it,但是我还没有准备好把这当笑话来说536–so please, no jokes.所以 拜托 不要开玩笑537–Hey, where have you two been?你们两个去哪里了538–Uh, Susan had a problem finding something to wear.苏珊找不到衣服穿539–Oh, is that the kind of thing you meant?你说的是这意思吧540–Pretty much.差不多541–The kids are bouncing off the walls? Huh.孩子们不停地在墙上弹来弹去吗542–Well, I’m sure you can figure a way to put them to bed, Tom.汤姆 我想你有办法让他们去睡觉 的543–I mean, for god sakes, Tom, they’re just kids.拜托 汤姆 他们只是些孩子544–Hey. Are you okay?你还好吗545–Yes, I-I went jogging today,是的 今天我去慢跑了546–and I think I just pushed myself too hard.我觉得我太急于求成了547–Oh, you’re probably not wearing the right shoes.你也许是没有穿对鞋548–Yea, that thought did cross my mind.是的 我也是这么想的549–So Gabrielle says that you and Bree are 加布丽尔说 你和布里550–taking lessons three times a week.一周上三次课551–I’m actually thinking about playing again.我也想有空重新开始练习552–I mean, it’s such great exercise.网球真的有益身体健康553–Mm. That it is.是的554–And my drop shot could use a serious tune-up.我的扣球技术需要好好调整一下555–Think you can give me the number of your pro?你可以把你教练的电话给我吗556–Yeah. I’ll, uh, I’ll give it to you later.可以 我一会给你557–Well, what club does he work out of?他在哪个俱乐部工作558–W-We’re not really taking tennis lessons, Carlos.我们并不是真的上网球课 卡洛斯559–You’re not?不是吗560–That’s a story 那只是编的故事561–Bree concocted to cover the fact that 布里编造出来掩盖事实562–we’re seeing a marriage counselor.我们在看婚姻咨询563–Bree – Bree…布里564–He wouldn’t stop asking about the tennis pro.他不停地打听网球教练565–Bree and I are in marriage counseling.布里和我在做婚姻咨询566–Everyone knows our secret now.所有人都知道这个秘密了567–Did the sky fall?天塌下来了吗568–Has your life come crashing down?你的生活被毁了吗569–If everybody would please take your seats,请大家入座570–dinner is served.晚餐马上就好571–With the winds from the northwest at 4 miles per hour,伴随着每小时四英里的风速572–it’s currently 55 degrees.现在的气温是摄氏五十五度573–Now we go to rich… live on the scene in Westbrook.我们正在维斯布鲁克进行现场报道574–A grisly discovery was made today in Westbrook 今天此地有个可怕的发现575–when a chest was found in Rockwater Lake,有人在岩水湖找到一个木箱576–discovered by a local area businessman and 是当地的一个商人577–his grandson while they were fishing.和他孙子钓鱼的时候发现的578–Investigators recovered a wooden chest 调查员打开了这个木箱579–containing what appears to be human remains.里面似乎是人的遗骸580–Now, a police spokesman says the body was –现在 警方发言人说尸体是581–Okay, I got to break the ice here.好啦 我来说几句582–So you’re in counseling. Big deal.你们在做婚姻咨询 有什么大不了的583–You want humiliation?想知道什么才叫丢人吗584–I’ll give you humiliation.我来告诉你吧585–I locked myself out of my house 我把自己锁在了屋子外面586–stark naked and got caught by Mike.一丝不挂 还被麦克堵了个正着587–Oh, my god. When did this happen?天啊 什么时候的事588–Today, right before the party.今天 就在聚会之前589–What can I say? Right place, right time.我还能说什么 来得早不如来得巧590–I think I can top that. Try getting thrown 你们谁都没法和我比 我曾经因为591–out of Disneyland for lewd behavior.行为下流被人家从迪士尼乐园赶出去592–What? When was this?你说什么 什么时候的事593–When Tom and I were first married,那还是我和汤姆刚结婚的时候594–things got a little out of hand on Mr. Toad’s Wild Ride.我们在疯狂大冒险那里有些把持不住595–You’re kidding.你开玩笑吧596–No. We got perp walked down main street, USA.没有 我们像罪犯一样走过美国小镇大街597–Well, since we’re doing true confessions,好吧 既然大家都在自爆糗事598–Carlos and I once broke a waterbed in Cancoon.我和卡洛斯曾经在坎昆弄坏了一张水床599–How’d you manage that?你们是怎么做到的600–Well, he used to have a thing for spiked heels.有段时间他超喜欢细跟高跟鞋601–I’d just like to make it clear – she was wearing them.我要声明一下 鞋穿在她的脚上602–Rex cries after he ejaculates.雷克斯每次射精之后都会嚎啕大哭603–You think we left too early?我们是不是走得太早了604–I was thinking we left too late.我倒是觉得走得太晚了605–So is, uh, Rex gone for good?雷克斯就这样一走了之吗606–I don’t know.我也不知道607–God, I hope not.希望他还能回来608–I mean, they’ve always been wound a little tight,他们两个总是有些磕磕绊绊609–but I’ve never seen them like that.可这样的场面我还是第一次见到610–Then again, who am I to judge?不过话说回来 我哪有资格评论人家611–You mean people who live in glass 你是说你们同病相怜612–houses shouldn’t throw soda cans?因此不该相互嘲笑讥讽613–Okay, you have got to know that I 你要知道 我只有在614–only get that angry around Karl.面对卡尔的时候才会仪态尽失615–He just treated me so badly at the end.最后那段时间他对我简直差劲透了616–I haven’t been able to get past it.直到现在我都无法释怀617–Well, maybe he did you a big favor.也许他也帮了你个大忙618–What do you mean?什么意思619–Let’s look at Karl as a starter marriage 你可以把卡尔看作是起步婚姻620–you know, boot camp.就像是新兵训练营那样621–Preparing you for something better next time.为接下来更美满的婚姻做准备622–Listen, Mike…听我说 麦克623–About the whole seeing me naked thing, I…有关我赤身裸体地被你撞见的事情 我624–I don’t – I just want to thank you for 我 我只是想谢谢你625–being such a… perfect gentleman.能够表现得如此绅士626–Oh, I wasn’t a perfect gentleman.其实也没有那么绅士627–I might have snuck a peek.我好像偷偷瞄了一眼628–Good night.晚安629–And, um, for what it’s worth…我想做出的评价是630–Wow.哇欧631–How was your night?今晚过得怎么样啊632–We are raising little terrorists.我们养的简直是小恐怖分子633–You know that, don’t you?你知道的 没错吧634–Oh. You didn’t have a good time?这么说你过得不好喽635–Okay, you know what? Drop the act.一边去 你别装蒜了636–I know you gave them cookies.我知道你给他们饼干了637–Oh. Who cracked, anyway?是谁告的密638–Porter.波特639–So how was your, uh, dinner party?你的晚宴怎么样640–Well, there was dinner, but it wasn’t much of a party.吃得倒是还好 不过不怎么开心641–Uh-oh. What happened?怎么了642–I don’t know.我也搞不懂643–Rex announced that he and Bree are in counseling.雷克斯宣布他和布里在进行婚姻咨询644–She retaliated with this whole revelation 她对他进行了报复645–which I won’t even go into now,至于细节我就不想说了646–and the bottom line is he stormed out.总之最后他气得要死 离开了家647–Clearly, there’s trouble in paradise.很明显 即使是完美之家也会遇到麻烦648–Honestly, I’m not that surprised.老实说 我并不怎么惊讶649–Why not?为什么650–I don’t know. I just never got the 我也说不好 不过我总是觉得651–idea that they were really happy.他们并不是真的幸福652–Are we happy?那我们幸福吗653–Man, oh, man.唉 老天啊654–I keep seeing that look on Rex’s face,我一直在想雷克斯脸上的那个表情655–and then him taking off like that.然后他就那样离开了656–Some night.如此波折的夜晚啊657–Then again, I would probably cry, too,但如果要我和那样的女人上床658–if I had to have sex with that woman.我也会嚎啕大哭的659–I mean, you watch a man get torn down like that,那个男人被羞辱得颜面尽失660–it makes you wonder why he let her get away with it.真搞不懂他怎么会让一个女人嚣张成那样661–Believe me, if a woman ever 相信我 如果哪个女人662–humiliated me like that in public,敢在别人面前让我下不来台663–Hm– it would only happen once.我一定要她好看664–So, uh, where are you going?你打算去哪665–I’ll be staying at the motor lodge.去住汽车旅馆666–The hotel by the Interstate has better rates,州际酒店价格比较划算667–and it’s closer to your work.离你上班的地方也近一点668–Fine.好669–I’m packing your swimsuit.我把你的泳衣也装进去吧670–There’s a pool there,酒店里有游泳池671–and I know how swimming relaxes you.游泳可以让你得到放松672–When our kids ask where I am, what are you going to say?孩子问我去哪的时候你打算怎么说673–I could tell them that you went to tennis camp.我可以告诉他们你去网球训练营了674–That was a joke.开个玩笑675–Yeah. I got it.听出来了676–Obviously, if you’ve forgotten anything,当然 如果你落下了什么东西677–you can, um, come right back and get it.你可以 马上回来拿678–Well, I’ll call you.我会给你打电话的679–Rex.雷克斯680–In college, when we first started dating,上大学时 我们刚开始约会那段时光681–people were so jealous of us.大家是多么的嫉妒我们682–We were the golden couple.我们就是金童玉女683–Everybody knew we were going to have this wonderful life.每个人都相信我们会过得幸福美满684–Why is this happening?事情怎么会变成这样685–Because you can’t even let me pack my own suitcase.因为你连收拾行李这种事都要管686–All right, see ya. Have fun.回见 过得开心687–Where are you going?你要去哪688–Just a sec.等会儿689–Mom?妈妈690–Don’t worry. I’m not packing heat.放心吧 我不是去惹麻烦的691–Hey, Brandy, would you scoot a little?布兰迪 你能不能往里坐一点692–Just scoot. Thank you.一点点就好 谢啦693–What are you doing?你这是要干什么694–I’ll be quick.很快就说完695–Brandy, I’m sorry for the way I treated you.布兰迪 抱歉以前我对你态度很差696–It was uncalled for and childish,那些都是没事找事的幼稚行为697–and it won’t happen again.以后不会再这样了698–I have built up a lot of anger towards you, both of you,以前我对你们两个憋了一肚子气699–and I realize now that I just 而我现在意识到700–can’t carry that around anymore,我不能再继续在愤怒中生活701–so apology or no apology,不管你们道歉还是不道歉702–I’m moving on.我都不会再计较了703–Mrs. Mayer?梅尔太太704–Brandy.布兰迪705–Brandy, get in the car.布兰迪 上车706–Mrs. Mayer.梅尔太太707–Please, call me Susan.叫我苏珊就好708–I just wanted you to know 我只是想让你知道709–what happened between me and Karl,我和卡尔之间的事情710–things got out of hand.和你想的不一样711–Because I thought your marriage was over.当时我以为你们已经结束了712–Anyway, I just wanted you to know 不管怎么说 我只是想让你知道713–I’m sorry. I really am.我很抱歉 真的很抱歉714–Thank you.谢谢你715–And though it came from an unexpected source,尽管事情来得很意外716–Susan finally got the apology she’d always wanted.苏珊最终还是得到了她想要的那句对不起717–Hey. Let me take those.我来帮你拿718–You’re wearing a really big hat.你的帽子还真是大719–Yes, I am.没错720–Listen, the kids are watching a video,孩子们在看录像721–which means that we’ve got only about 45 也就是说在他们找到尼莫[海底总动员]722–minutes until they actually find Nemo,之前我们只有四十五分钟了723–so I suggest that we make the most of it.要我说 我们得好好利用这段时间724–By reliving your night out with the guys?用来补偿那个你和别人出去狂欢的夜晚725–Lynette…勒奈特726–I’m trying.我在努力727–You look… ridiculous in that thing.你戴着那东西还真是搞笑728–Sexy ridiculous?性感得好笑吗729–Maybe.也许是吧730–I can live…我可以接受731–with maybe.这句也许732–You know, it’s going to take more than just this one night.你要知道 要解决问题一个晚上可不 够733–I know.我明白734–Looks like we have an audience.原来我们还有观众啊735–Let ‘em look.让他们看吧736–As long as they don’t try and cut in.只要他们不来捣乱就好737–Dr. Goldfine.高德芬博士738–Bree. We’re not scheduled now, are we?布里 你没有预约吧739–I didn’t have time to make an appointment.我没时间预约了740–Rex moved out today.雷克斯今天搬出去了741–Oh, I’m very sorry to hear that,我很抱歉742–but unfortunately, I’m completely booked right now.但是我现在已经预约满了743–I don’t need much time.我不会耽误你太多时间744–It just seems that you have more insight into my situation 只不过 你比我更明白我现在的处境745–than I do, and I just think –所以我想746–Bree, we can’t talk now.布里 我现在没法和你聊天747–If you could just tell me what he told you,只要你告诉我他和你说了些什么748–then I could fix the problem.我就能把问题解决掉749–I can’t do that. It’s completely unethical.无可奉告 那样做是违反职业道德的750–Well, why can’t you –有什么不能的751–That’s my next appointment.我的下一个顾客已经来了752–You really need to go.你得离开这儿了753–Dr. Goldfine, please.高德芬博士 求你了754–Hold on. I’ll go and talk to my client.稍等一下 我去和他谈谈755–Bree searched for Rex’s audiotape 布里寻找着雷克斯的录音记录756–hoping to find answers.想要从中找出答案757–She found answers, all right,她的确找到了答案758–玛丽·艾莉丝759–but to entirely different questions.然而却是另一个问题的答案760–I understand completely.我完全理解761–I’ll – I’ll be out in just a minute.我马上回来762–Bree, I’m – I’m sorry. He can’t wait,布里 很抱歉 他没法等763–but I can see you first thing 不过明天早上八点764–in the morning – 8:00.我可以第一个见你765–8:00.八点对吧766–Sorry to interrupt.抱歉打搅你了767–Bye.再见768–Yes, I remember the world –every detail.没错 我记得这个世界 每一个细节769–And what I remember most is how afraid I was.而我记得最清楚的 是我曾经多么恐惧770–What a waste.还真是浪费771–You see, to live in fear is not to live at all.恐惧的生活跟死了没什么区别772–I wish I could tell this to those I left behind,我希望我可以把这些告诉那些活着的人773–but would it do any good?但是有用吗774–Probably not.或许不会775–I understand now –我现在终于明白776–there will always be those who face their fears…总会有人能勇敢面对他们的恐惧777–And there will always be those who run away.也总会有些人选择逃避" }, { "title": "使用 Page Object Model 来写 UI Test", "url": "/posts/ui-testing-using-page-object-model/", "categories": "iOS", "tags": "test", "date": "2022-05-12 20:00:00 +0800", "snippet": "随着 SwiftUI 的使用，使得现在写 UI Test 也更为容易了一些，一般的视图都能够被分离出来，单独拿出来进行测试。如果再加上 Page Object Model，那么将能够给写 UI Test 锦上添花。下面就来一探究竟吧。本文的示例代码来自于 UI Testing using Page Object pattern in Swift例子使用一个简单的登录界面，大家可以把它简单地想象成这样子：基本的测试写法我们希望测试这个界面的界面元素和登录交互，代码可以长这个样子：final class LoginTests: XCTestCase { var app: XCUIApplication! override func setUp() { continueAfterFailure = false app = XCUIApplication() app.launchArguments = [&quot;testing&quot;] app.launch() } func testLoginFlow() { let email = app.textFields[&quot;email&quot;] email.tap() email.typeText(&quot;cmecid@gmail.com&quot;) let pwd = app.secureTextFields[&quot;password&quot;] pwd.tap() pwd.typeText(&quot;pwd&quot;) app.buttons[&quot;login&quot;].tap() let message = app.staticTexts[&quot;Hello World!&quot;] XCTAssertTrue(message.waitForExistence(timeout: 5)) }}在测试 case 执行前，获取到 app 实例，然后启动 app。在测试方法中，通过查找界面元素，获取到输入 email 和 password 的 TextField，并且点击他们输入测试文本，然后找到 login 的 Button 点击它，期望是在按钮点击之后，切换到一个新的界面，显示 Hello World! 的文本。这是一个基本的登录操作的流程。上面的测试代码，是有可优化的点的。比如 setUp 方法中的 app 环境，我们几乎在每个 UI 测试中都会用到它，因此它是可以被抽取的；还有假使这个登录流程需要作为某一个 UI 测试的前置操作，会被复用到，那么势必会出现重复代码。下面就通过两次优化，来引出 Page Object Model。抽取 UI Test 的基类通过把 setUp 和 tearDown 的代码抽取出来，让子类继承，来简化每次测试前后的代码书写。class UITestCase: XCTestCase { var app: XCUIApplication! override func setUp() { continueAfterFailure = false app = XCUIApplication() app.launchArguments = [&quot;testing&quot;] app.launch() } override func tearDown() { let screenshot = XCUIScreen.main.screenshot() let attachment = XCTAttachment(screenshot: screenshot) attachment.lifetime = .deleteOnSuccess add(attachment) app.terminate() }}在 setUp 阶段启动 app，在 tearDown 阶段，如果有测试失败的话，保存失败场景的截图，便于 Debug。通过继承 UITestCase ，LoginTests 可以简化为：final class LoginTests: UITestCase { func testLoginFlow() { let email = app.textFields[&quot;email&quot;] email.tap() email.typeText(&quot;cmecid@gmail.com&quot;) let pwd = app.secureTextFields[&quot;password&quot;] pwd.tap() pwd.typeText(&quot;pwd&quot;) app.switches[&quot;rememberMe&quot;].tap() app.buttons[&quot;login&quot;].doubleTap() app.buttons[&quot;login&quot;].twoFingerTap() let message = app.staticTexts[&quot;Hello World!&quot;] XCTAssertTrue(message.waitForExistence(timeout: 5)) }}使用 Page Object ModelPage Object 是按照界面来进行封装，封装的类只提供当前界面的一些元素和交互方法，而测试用例来复杂消费他们，然后构建整个交互流程。protocol Screen { var app: XCUIApplication { get }}struct LoginScreen: Screen { let app: XCUIApplication private enum Identifiers { static let email = &quot;email&quot; static let password = &quot;password&quot; static let login = &quot;login&quot; static let error = &quot;error&quot; } func typeEmail(_ email1: String) -&amp;gt; Self { let email = app.textFields[Identifiers.email] email.tap() email.typeText(email1) return self } func tapLoginExpectingError() -&amp;gt; Self { app.buttons[Identifiers.login].tap() let error = app.staticTexts[Identifiers.error] XCTAssertTrue(error.waitForExistence(timeout: 5)) return self } func tapLogin() -&amp;gt; MessageScreen { app.buttons[Identifiers.login].tap() return MessageScreen(app: app) } func typePassword(_ password: String) -&amp;gt; Self { let pwd = app.secureTextFields[Identifiers.password] pwd.tap() pwd.typeText(password) return self }}LoginScreen 这个结构体，只包含登录界面的元素和一些交互方法，它把每个交互都单独定义了方法，这样不论测试用例想如何进行验证，都是比较灵活的。然后我们还有一个登录成功之后的 MessageScreen。struct MessageScreen: Screen { let app: XCUIApplication func verifyMessage(_ message: String) -&amp;gt; Self { let message = app.staticTexts[message] XCTAssertTrue(message.waitForExistence(timeout: 5)) return self }}以上所有的方法，都返回了自己或者其他的 Screen，这样方便我们进行链式调用来组合一些元素和交互，例如 tapLogin 方法返回了 MessageScreen，这也是符合交互逻辑的。正常情况下，点击完登录应该跳转到 Message 界面。最终我们的 UI Test 就变成了这样：final class LoginTests: UITestCase { func testLoginFlow() { LoginScreen(app: app) .typeEmail(&quot;Cmecid@gmail.com&quot;) .typePassword(&quot;password&quot;) .tapLoginExpectingError() .typeEmail(&quot;Cmecid@gmail.com&quot;) .typePassword(&quot;pwd&quot;) .tapLogin() .verifyMessage(&quot;Hello World!&quot;) }}这样的调用逻辑是非常清晰的，并且各个页面都能被复用，每个页面里面的具体细节都被隐藏了起来。例子中使用的是 Screen 而非 Page，这是因为 Page Object 这个概念是从 Web 来的，所以示例的作者使用了 Screen 代替了 Page，其实在项目实践中，并不一定每一个类都要代表一个 Screen，它可以是对一个 UI Component 的测试，因为我们往往会把一些可复用组件进行拆分，所以对小组件单独进行测试也是不错的实践。是否在 Page 中进行断言大家会发现，在文中的示例其实是在 Page 的方法中加入了断言语句，而在测试用例中只是调用了相应的方法。还有一种观点是 Page 应该只负责提供界面元素和交互方法，而不加断言，让测试方法自己去决定想要怎么断言。Martin Fowler 在他的文章中指出了这两种方法的优缺点： 在 Page 中写断言，优点是可以避免重复的断言语句，提供更符合上下文的错误信息，以及更符合 TellDontAsk 风格的 API。 而缺点则是，使得 Page 的职责不再单一，混杂了断言语句的逻辑，会使得 Page 变得更大更复杂。因为示例的场景比较简单，因此看起来在 Page 中写断言还是挺清晰的，但是随着页面和逻辑变得更复杂，它的弊端会不会展现出来呢？Martin Fowler 个人更偏向于不在 Page 中写断言，大家可以根据自己的想法和项目情况，来进行选择。目前个人觉得在页面不复杂的情况下，在 Page 中写断言是更清晰的。参考 PageObject UI Testing using Page Object pattern in Swift" }, { "title": "Desperate Housewives S01E02", "url": "/posts/english-desperate-housewives-s01e02/", "categories": "English", "tags": "english", "date": "2022-04-26 20:00:00 +0800", "snippet": "Desperate Housewives S01E021–Previously on Desperate Housewives《绝望主妇》前情提要2–If Mary Alice was having some sort of crisis,如果当时玛丽·艾莉丝有危机3–we’d have known.我们会发现的4–She lives 50 feet away, for god’s sakes.她住的那么近5–Gabby, the woman killed herself.加布 那个女人都已经自杀了6–Something must have been going on.这事没这么简单7–Every time I’m around that man, he tries to grab my ass.每次我在那男人周围 他都想捏我的屁股8–I made over $200,000 doing business with him last year.去年我从他那赚了二十万9–If he wants to grab your ass, you let him.如果他想捏你的屁股 让他捏10–Why aren’t you happy?那你为什么不开心11–Turns out I wanted all the wrong things.看来我得到的都不是真正想要的12–What’s that?那是什么13–It’s a letter addressed to Mary Alice.一封给玛丽·艾莉丝的信14–[我知道你干的好事 真恶心 我要告诉别人]15–Oh, Mary Alice, what did you do?玛丽·艾莉丝 你做了什么16–An odd thing happens when we die.人死后会发生一件很有趣的事17–Our senses vanish.几种感官相继消失18–Taste, touch, smell, and sound 味觉 触觉 嗅觉和听觉19–become a distant memory,都成了遥远的记忆20–but our sight –除了视觉21–ah, our sight expands,我们的视野反而开阔许多22–and we can suddenly see the world 我们能把曾身处的世界23–we’ve left behind so clearly.看得很清楚24–Of course, most of what’s visible to the dead 当然 逝者所能看到的东西25–could also be seen by the living,生者也能看见26–if they’d only take the time to look.只要他们肯花时间27–Like my friend Gabrielle.比如我朋友加布丽尔28–I should have seen how unhappy she was,我早该看见她有多不开心29–but I didn’t.但我没有30–I only saw her clothes from Paris…我只看见她那些巴黎定制的时装31–and her platinum jewelry…那些铂金珠宝32–and her brand-new diamond watch.和崭新的钻石表33–Had I looked closer,如果我仔细观察34–I’d have seen that Gabrielle was a drowning woman 我会看见加布丽尔是一个溺水的女人35–desperately in search of a life raft.急切地寻找着救生筏36–Luckily for her, she found one.幸运的是 她找到一个37–Of course, Gabrielle only saw her young gardener 加布丽尔只是让年轻的园丁38–as a way to infuse her life with a little excitement.给她的生活添点色彩39–But now she was about to discover 不过她马上就会发现40–just how exciting her life could get.她的生活会如此多姿多彩41–Damn it.该死42–Come on, come on, come on! Hurry up! Let’s go!快点快点 赶紧 过来43–Where are the rest of my clothes?我别的衣服呢44–I’ll find them. Just get out.我来找 赶紧出去45–Where?从哪46— Out the window. - What?-窗户 -什么47–Go, go, go, go, go!快点快点48–Hi, honey. You’re home early.亲爱的 你今天真早49–My meeting got canceled.我的会议取消了50–Didn’t you take a shower this morning?你早上不是洗了澡吗51–I, uh, I just finished a workout.我刚运动了一会52–Where’s John?约翰在哪53–John?约翰54–Yeah. That’s his truck out front.他的推车停在外边呢55–Gabrielle was panicked.加布丽尔很惊慌56–She knew if her husband discovered her secret,她知道如果她丈夫发现了她的秘密57–she would feel the full force of his wrath.她能想象他暴怒的样子58–Hey, Mr. Solis.索利斯先生59–Hey, John, take care of that ficus yet?约翰 那颗榕树弄好了没60— I’ll get to it as soon as I’m done here. - All right.-我把这做完了就去 -很好61–But she was quickly reminded that…不过她马上想到62–What Carlos couldn’t see…只要没被卡洛斯发现63–Yeah, sure. No problem.当然 没问题64–couldn’t hurt her.一切都会安然无恙65–The peaceful facade of Wisteria Lane had recently been shattered,紫藤郡平静的表面已经被打破66–first by my suicide…首先是我自杀67–and then by the discovery of a note among my belongings 然后是我遗物中的纸条被发现68–that suggested a suspicious reason for my desperate act.暗示我自杀的原因很可疑69–My friends gathered to discuss its implications.我的朋友们聚在一起探讨它的含义70–I think we should give it to Paul.我觉得我们应该把这个给保罗71–He’s still mourning, Susan.他还在悲痛中 苏珊72–He’ll probably freak out.他会吓坏的73–It doesn’t matter. She was his wife.这不是关键 她是他妻子74–He deserves to have all the facts.他应该知道事情的真相75–Well, we could do it gently.我们可以说的随意点76–We could tell him about it over coffee and pastry.比如在闲聊的时候告诉他77–That would be fun.真有意思78–“Paul, we have proof your wife killed herself”保罗 我们发现你老婆自杀79–over some deep, dark secret.是因为她有不可告人的秘密80–Another bear claw?”还要些熊爪糕吗”81–We could always call the police.我们可以报警82–Maybe it’s just some sort of sick joke.可能只是个变态玩笑83–Well, if it was a joke, it was in very poor taste.如果这是个玩笑 那也太低级了84–No, this was serious. I know it was.不 我敢肯定这是认真的85–We got to find out what was going on.我们得弄明白到底发生了什么86–Let’s say we do.就算弄明白了87–There’s a chance we’re not going to like what we find.也可能不是我们想要的结果88–Well, isn’t it worse to be in the dark?总比一头雾水的好89–I mean, imagining she did all these horrible things.想着她也许做了什么可怕的事情90–It’s the age-old question, isn’t it?又回到老问题上了91–How much do we really want to know about our neighbors?我们对邻居到底有多好奇92–My friends were right to be concerned.朋友们的担心是对的93–They knew that every family has its secrets,她们知道每个家庭都有秘密94–and as my son and husband could have told them,我儿子和丈夫的经验是95–you need to think carefully before digging them up.挖出这些秘密前得反复斟酌96–After talking for hours,讨论了数小时之后97–my friends still hadn’t agreed on 我的朋友们还是不知道98–what to do with the note.该如何处理这张纸条99–So they decided to talk about it in the morning 她们决定先睡个好觉100–after a good night’s rest.早上再来讨论101–But no one could fall sleep that night.不过那天晚上没人能睡得着102–They each kept thinking of my suicide 她们都猜测我自杀的原因103–and how terribly alone I must have felt.以及我曾经历过的孤独104–You see, loneliness was something 孤独这东西105–my friends understood all too well.她们再熟悉不过了106–It’s okay. I’m up.没关系 我醒着107–Good.很好108–I have a question for you.我有一个问题想问你109–OK.好吧110–Do you remember when you proposed?你还记得你求婚的时候吗111–For god’s sake –我的天112–We sat on Skyline Drive and drank a bottle of apple wine,我们在长空大道喝着苹果酒113–and when we finished it, you turned to me, and you said,喝完你突然对我说114–“if you marry me, Bree Mason,”如果你嫁给我 布里·梅森115–I promise to love you for the rest of my life.”我保证会爱你一辈子”116–And even though I was engaged to Ty Grant,尽管那时我已经和泰·格兰特订婚了117–and even though my father didn’t like you,尽管我父亲并不喜欢你118–I said yes.我也同意了119–That was a long time ago.那是很久以前的事了120–You’re going to cancel the meeting with that divorce lawyer,你得取消和离婚律师的会面121–and we’re going to find ourselves a marriage counselor.我们去找一个婚姻顾问122— Bree… - You promised.-布里 -你保证过的123–All right.好吧124–Good. I’m going to go, uh, make myself some warm milk.很好 我去热点牛奶125–Would you like something to drink?你要喝点什么吗126–Anything but apple wine.只要不是苹果酒就行127–Susan awoke that night alone and parched,苏珊那晚孤独地醒着 很口渴128–but as she gazed out her window,她注视着窗户外面129–she saw the tall drink of water she needed to quinch her thirst.看见了一大杯能解渴的水130–“Dear diary, Mike doesn’t even know I’m alive.”“亲爱的日记 麦克都不知道我的存在”131–Shut up.闭嘴132–If you want to date him, you’re going to have to ask him out.想跟他约会 得主动约他133–I keep hoping he’ll ask me out.我一直希望他能来约我134–How’s that going?结果呢135–Shouldn’t you be making brownies 你该给你的小朋友们做136–for your nerdy friends?巧克力蛋糕了吧137–I can’t find the measuring cup. Have you seen it?我找不到量杯 你见到了吗138–The measuring cup?量杯139–Yeah.是啊140–I – well, it’s – it’s got to be here somewhere.肯定就在附近141–Just keep looking.再找找看142–I know you’re awake.我知道你醒着143–I know you’re a jerk.我知道你是个混蛋144–Dinner with Tanaka ran long. I’m sorry.和塔纳卡的晚餐时间有点长 我很抱歉145–You know, Carlos, I didn’t marry you 卡洛斯 我跟你结婚并不是为了146–so I could have dinner by myself six times a week.一周有六天都是自己单独吃晚餐147–You know how bored I was today?你知道我今天有多无聊吗148–I came this close to actually cleaning the house.我就差这么点就要自己打扫房子了149–Don’t be that way. I got you a gift.别这样 我给你买礼物了150–Nope. No, no, no, no.不行 不不151–You’re not going to buy your way out of this one.你这次可不能这么轻易打发我152–It’s a good gift.是个好礼物哦153–Is that white gold?是白金的吗154–Yeah. Put it on…是 把这戴上155–and then make love to me.然后跟我做爱156–I’m not in the mood.没心情157–But we could stay up and talk.不过我们可以聊聊天158–When a man buys a woman expensive jewelry,当男人送女人如此昂贵的珠宝159–there are many things he may want in return, for future reference,想得到的回报160–conversation ain’t one of them.绝对不是聊天161— Hey, that was a joke. - Yeah, right.-我在开玩笑呢 -是啊162— What the hell is wrong with you? - Let go of me.-你到底怎么回事 -放开我163–Hey, you’ve been acting like a nightmare for a month. What’s wrong?你这个月一直很奇怪 怎 么了164–I can’t fix it unless you tell me.你得告诉我才能解决165–It’s not exciting anymore, Carlos.没有激情了 卡洛斯166–So what am I supposed to do?那我应该怎么做167–I don’t know.我不知道168–Be the way you used to be.像你以前那样169–Surprise me. Take my breath away.给我惊喜 让我激动170–Okay.好的171–Okay.好的172—Hey, Susan. - Mike.-嘿 苏珊 -麦克173–What’s wrong?怎么了174–I didn’t realize anybody was going to be out here.我没想到外面会有人175–I just sort of rolled out of bed.我刚从床上爬起来176–I’m sure you look fine.你看起来很好177–Oh, Bongo, stop.邦戈 别叫178–Sorry, uh… he scares easy.抱歉 他很容易受惊吓179–No, it– it’s fine. I-I get it.没关系 我懂180–I didn’t mean to disturb you.没想到会打扰你181–I’ll see you later.待会见182–Do you want to have dinner with me?你想和我一起吃晚饭吗183–Just the two of us?就我们俩184–Well… and Julie.还有朱莉185–It’s a thing we do when somebody new moves into the neighborhood,有新邻居搬进来的时候我 们就会这样186–we invite them over for a home-cooked meal.邀请他们来家里吃饭187–Sort of a tradition.算是种传统吧188–I thought you were a lousy cook.我记得你说你厨艺很烂189–Well, I order take-out.我可以叫外卖190–You invite ‘em for home-cooking and give ‘em take-out?用外卖招待请来的客人吗191–Yeah, ah, it’s sort of a new tradition.这是一种新传统192–I’m working out the kinks.我突发奇想的193–I’ll tell you what. How about I cook?这样吧 我来做饭194–You guys come over to my place.你们来我家吃饭195–Oh, great.太好了196— Friday night at six? - I’ll be there.-周五晚上六点 -我一定准时到197–Right. Come on.好的 走吧198–Bye, Bongo.拜拜 邦戈199–Julie! Mike Delfino just invited us 朱莉 麦克·德尔非诺邀请200–to dinner Friday night.我们周五去吃晚饭201–He did? Cool.是吗 太好了202–But only I’m going because you’re 但是只有我去203–gonna come down with something serious 因为你生重病204–that requires bed rest and fluids.需要卧床休息打吊瓶205–Julie was glad Susan was rekindling her love life.朱莉很高兴苏珊重新开始她的爱情生活206–Of course, she was unaware of her 当然 她还不知道207–mother’s recent track record with fire.她妈妈的纵火行为208–It’s all gone. Everything my ex-husband 都没了 我前夫多年的辛苦209–worked for all those years, gone.全都没了210–Don’t worry about clothing.别担心衣服211–I already started a collection from the neighborhood.我已经去邻居那募集了一些212–What? I don’t want to wear other people’s old crap.什么 我可不想穿别人的旧衣服213–Edie, you can be homeless or ungracious.伊迪你可以无家可归 也可以衣着寒酸214–You really can’t afford to be both.但是两者兼备可够你受的215–That reminds me. My insurance check still hasn’t come yet.这倒提醒我了 我保险的支票还没 到呢216–Could I stay with you a few more weeks?我能跟你多住几周吗217–Of course. What kind of christian would I be 当然没问题 如果我连个落难的朋友218–if I denied shelter to a friend in need?都不帮助 还算什么基督徒219–Oh, look. Here’s something we can salvage.看 还有些东西可以变废为宝220–Your measuring cup.你的量杯221–We can scrape of the burnt part and 只需擦掉烧焦的部分222–it’ll look good as new.它就会焕然一新223–That’s not my cup. Mine was plastic.那不是我的 我的是塑料的224–Well, how did it get in here?那它怎么在这里225–I don’t know. Who cares?不知道 管它呢226–Now, would you put that down and start looking for jewelry?能把那玩意放下然后帮我找找珠宝吗227–Dr. Albert Goldfine was the most accomplished 艾伯特·高德芬博士是城里228–marriage counselor in the city.最有名的婚姻顾问229–He had dealt with problems ranging from substance abuse…他处理过无数起婚姻问题 从吸毒230–…to infidelity…到婚外情231–…to domestic violence.还有家庭暴力232–Yes, Dr. Goldfine thought he had seen it all.高德芬博士以为他对婚姻了如指掌233–And then he met the Van de Kamps.直到他遇见范德坎普夫妇234–Hi. I’m Bree. And this is my husband Rex.你好 我是布里 这是我丈夫雷克斯235–And I brought you some homemade potpourri.我给你带了一些自制的香包236–The answer is yes.你想得没错237–You’re about to make a fortune off us.你要从我们身上赚大钱了238— Ah, get off! - Boys!-走开 -孩子们239–Guys, I’m begging you.孩子们 拜托240–Sit in your seats.乖乖坐好241–I’m not gonna tell you again. Buckle up.我不想重复 系上安全带242–I mean it, so help me…我说真的243–Oh, shoot. Crap!该死244–I was playing with it first!是我先玩的245–License and registration, please.请出示驾驶证和车辆登记证246–Ma’am, you know why I pulled you over?夫人 知道我为什么拦你吗247–I have a theory.我知道248–The kids should be sitting wearing seat belts.这些小家伙应该坐好系上安全带249–I yelled at them. They never listen. It’s very frustrating.我告诉他们不要 他们不听 没办法250–You have to find a way to control them.你应该好好管管他们251–After all, that’s your job.毕竟 这是你的分内事252–Though he’d been a policeman for six years,尽管他已经做了六年的警察253–officer Hayes had never found himself 海耶斯警官却不知道这次254–in a truly dangerous situation.他将身处险境255–Then again, he had never before told 他以前从来没告诉过一个女人256–a woman how to raise her children.该如何去管教孩子257–Are you saying I’m a bad mother?你说我是一个失败的母亲258–Get back in your car, please.夫人请回到车里去259–I have no help. My husband’s always away on business.我没有办法 我的丈夫总在外忙生意260–I’m gonna have to ask you to step back now.我必须警告你马上回到车里261–My babysitter joined the witness relocation program.我的保姆不干了262–I haven’t slept through the night…我已经有六年263–…in six years - Ma’am.没睡过好觉了 -夫人264–And for you to stand there and judge me…你还在这里对我指手画脚265–Ok. I’m not gonna give you a ticket.我不给你开罚单了266–I’m just gonna let you off with a warning.只给你一个警告267–I accept your apology.我接受你的道歉268–Mom! He’s kicking me again!妈妈 他又踢我269–Buckle up.系上安全带270— Mrs. Solis. - Hello, Jonathan.-索利斯夫人 -你好乔纳森271–Well, this is my room. Sorry about the mess.这是我房间 抱歉很乱272–Oh, uh, don’t worry about it.没关系273–You just missed my mom.我妈妈刚刚离开274–On friday,she coaches my sister’s soccer team.周五她要给我妹妹的足球队当教练275–Yes, I heard that.我听说了276–John, we need to talk about what happened the other day.约翰我们得谈谈前几天发生的事277–Mr. Solis isn’t catching on, is he?索利斯怀疑你了吗278–No, no, he doesn’t have a clue, god love him.没有 他没有证据279–It’s just I was thinking that when you come over to garden,我觉得你在花园里的时候280–you might actually have to garden.应该做点园艺活了281–Great, you’re breaking up with me.你是想跟我分手282–In my own bedroom.还在我的卧室里283–No, no. I’m not dumping you.不 没有 我没想甩你284–Lately, you’ve been the only thing keeping me going.这几天 只有你能让我开心285–But we can’t do it at my house anymore.但是我们不能在我家做爱了286–Oh, so then, where do you want to do it?那么 你想在哪里287–Well, what time does your mom get back from soccer practise?你妈妈什么时候从足球比赛回来288–Mrs. Solis!索利斯夫人289–Better hurry. We don’t have much time.最好快点 时间可不多290–And so there’s just the four of us.我们家有四口人291–Myolderson,Andrew,is 16,Danielleis 15 and…大儿子安德鲁 16 岁 丹妮尔 15 岁292–I don’t need to see pictures. Bree,布里我不用看照片293–you’ve spent most of the hour 你大部分时间294–engaging in small talk.都在说些题外话295— Oh, have I ? - Yes.-是吗 -没错296–Rex has been very vocal about his issues.雷克斯对他的问题畅所欲言297–Don’t you want to discuss your feelings about your marriage?你不想谈谈你对你婚姻的感受吗298–Um, doc…博士299–This is the thing you got to know about Bree.你必须了解布里这点300–She doesn’t like to talk about her feelings.她不愿意谈她的感受301–To be honest, it’s hard to know if she has any.实话说 很难知道她有没有感情302–Does she feel anger, rage, ecstasy?她会生气 暴怒 或者狂喜吗303–Who knows?没人见过304–She’s always pleasant, and I can’t 她总是表现的很开心305–tell you how annoying that is.你不知道我有多讨厌这点306–Whatever she feels, it’s so far below the surface,她把情感都藏在心里307–no one can see it.没人能知道308–I feel like she’s using all these…我觉得她一直在用这些309–Bree?布里310— Bree? - What? I’m sorry.-布里 -怎么了 抱歉311–Would you like to respond to what Rex just said?你愿意谈谈刚才雷克斯说的吗312— Oh, um… - Is there some truth there?-哦 -他说的都是真的吗313–Do you use housework as a way to disengage emotionally?你在用家务活掩盖你的情感吗314–Of course not!当然不是315–This is great. I got tons of homework tonight.真棒 我今天有很多作业316–It’s easy to concentrate after sex.做爱以后注意力会很集中317–I’m glad I could help.很高兴能帮上忙318–Education’s very important.教育很重要319–Oh, I got something for you.我有东西给你320–I was gonna give it to you next time I 我本来打算下次321–mowed your lawn, but since you’re here.去修剪草坪时候给你 既然你来了322— Oh, it’s a rose. - It’s not just any rose.-玫瑰 -它不是普通的玫瑰323–Look at all the petals. There’s no flaws.看这些花瓣 没有瑕疵324— It’s perfect. - Oh, John.-它很完美 -约翰325–Just like you.就像你一样326–The truth hit her like a thunderbolt.事实像雷电一样击中了她327–I spent days looking for just the right one.我找这样的花很久了328–I finally found it.终于找到了329–For John,对于约翰来说330–this was no longer a meaningless little affair.这已经不是简单的风流事了331–Gabrielle could now clearly see 加布丽尔明显地看出来332–he was falling in love with her.他已经爱上她了333–It’s just beautiful.太美了334–I… I got to go.我得走了335–Goodbye.再见336–Hey, you. What are we having?你都买什么了337–I talked to Julie and she suggested rib-eye steaks.我问过朱莉了 她建议做肋排338— She said that’s your favorite. - I love my steak.-她说那是她的最爱 -我喜欢吃排骨339–Hi, Mike.麦克好啊340–Susan.苏珊341–Edie.伊迪342–I’m sorry about your house. How you holding up?你房子的事情我很遗憾 还好吗343–All right, I guess. Oh, is somebody having a party?还行吧 有人要办派对吗344–No, Susan’s just throwing me 不是 苏珊邀请我345–a traditional welcome dinner.参加传统迎新邻居晚餐346–Only I’m cooking. And having it at my house.我负责做饭 就在我家347–Traditional? Hm! I didn’t get one.传统晚餐 我怎么不知道348–Oh, it’s a new tradition.是个新传统349–It won’t be anything fancy. Just a little home cooking.不会有什么新奇的东西 就是在家吃350–Mm. That sounds so good.听起来不错嘛351–Susan suddenly had an awful 苏珊突然觉得352–feling in the pit of her stomach.胃里有种不舒服的感觉353–I’ve been having nothing but fast food lately.我最近一直在吃快餐354–As if she was watching an accident in slow motion.她就好像在看一场事故的慢镜头355–She knew it would happen, but was powerless to stop it.眼睁睁看着一切发生 却无力阻止356–Edie, would you like to join us for dinner?伊迪 你愿意一块来吗357–Oh, that’s so sweet. No, I don’t 那真好 哦 不行358–want to intrude. Three’s a crowd.我可不想做电灯泡359–No, it’s not like that. I mean, Susan’s bringing Julie.不是你想的那样 朱莉也会来360–It’s not like that. The more the merrier.不是那样的 人越多越热闹361— Well, this’ll be fun. - All right. Tomorrow night.-那挺好的 -好 明晚见362— We’ll eat at six. - Great.-六点开饭 -好极了363— Oh, and Susan… - Yeah?-对了苏珊 -什么事364–This’ll make up for the dinner that you never threw me.这次就算你弥补欠我的那顿饭了365–Right.是啊366–Ta-ta.拜拜367–Should I have told her we were having steak.我应该告诉她我们会吃肋排吗368–She’s not a vegetarian or something?她看起来像是素食者什么的369–Oh, no.不用370–No, Edie’s definitely a carnivore.伊迪绝对是个肉食者[暗指伊迪风流成性]371–Here’s, um…这些是372–Here’s what I pulled for Edie.这些是我为伊迪准备的373–Most of the clothes aren’t that stylish.大部分衣服都不太时髦374–Don’t worry about it. Edie’s a beggar now,别担心 伊迪现在什么都没了375–which means she can’t be a chooser.她没资格挑三拣四的376–Of course, we don’t have to add salt to the wound.当然 我们也不能雪上加霜377–Listen, I was just getting dinner ready…我要去准备晚餐了378–Say no more. I’ll get out of your hair.不用招呼我 我就不打扰你了379–No, no.客气380–By the way, was that you I saw getting pulled 对了 那天我看到有人被警察拦下381–over by a policeman?是你吗382–Yeah, the boys were acting up in the car,是的 孩子们在车里捣乱383–I couldn’t get them to sit down.我没法让他们乖乖坐下来384–Young boys can be so willful.小孩子们就是这么任性的385–I try everything.我用尽了办法386–I scream. I threaten. I reason.我向他们大吼 威胁 讲道理387–I beg. Nothing works.甚至哀求 通通不管用388–I don’t know if it’s because 我不知道是不是389–they’re too young and they don’t understand,因为他们太小了根本就不懂390–or if they’re just getting some perverse joy out of testing me.还是他们以挑衅我取乐391–My mother used to have the worst time with me in the car,我妈妈也曾因我在车上捣乱头疼392–so one time when I was acting up,有一回我再次捣乱的时候393–she stopped and left me on the side of the road,她停下车 把我扔在路边394–and she drove off.然后就自己开车走了395–You’re kidding?开玩笑吧396–Oh, she came back immediately,当然 她很快就回来了397–but I never misbehaved in the car again.但从此我在车上就乖乖听话了398–You should try that.你应该试试399–Mrs. Huber, I could never leave 胡博太太 我永远不会400–my kids by the side of the road.把我的孩子们丢在路边的401–When it comes to discipline,当惩罚不管用的时候402–sometimes you must be creative.你就得想想别的法子403–My mother knew that. Smart lady.我母亲深知这点 她是个聪明的女人404–Of course, she’s in a home now.当然 她现在已经不在了405–And her mind has just turned to mush.但她的点子确实很管用406–Well, like I said, I should go back and get dinner ready.差点忘了 我要回去准备晚餐了407–Oh, right, well… Goodbye.是啊 再见408–Goodbye.再见409–Susan, have you been able to find old clothes for Edie?苏珊 你能给伊迪找些旧衣服吗410–She has nothing to wear.她没衣服穿了411–I thought that was the look she was going for.那不正如她所愿了412–Oh, Susan, Edie may be trash,苏珊 伊迪可能确实不怎么样413–but she’s still a human being.但她好歹也是个人啊414–[我知道你干的好事 真恶心 我要告诉别人]415–Zach, is your dad home? I need to talk to him.扎克 你爸爸在家吗 我想和他谈谈416–Hey, Paul, I hope I’m not interrupting.保罗 希望我没打扰你417–Actually, I was getting ready to go somewhere.事实上 我正要出门418–I just wanted to come by and say hello,我就是过来打个招呼419–you know, see how you guys are doing.看看你们好不好420–We’re trying to move on. It’s been pretty tough.我们是想让这事过去 但这太难了421–I can only imagine.我能想象那种感觉422–Not knowing why Mary Alice…不知道为什么玛丽·艾莉丝423— Why what? - Why she did it.-什么为什么 -为什么她自杀424— Oh. Here, let me help you. - I’ve got it. I’ve got it.-小心 我来帮你 -我自己来 我能搬动425–I’m sorry if I upset you.如果让你伤心了我很抱歉426–Can I be frank?我能坦率点吗427–Of course.当然可以428–I don’t care what her reasons were.我不在乎她自杀的原因是什么429–Maybe she was depressed, maybe she was bored.可能她很沮丧 可能她觉得很无聊430–It doesn’t matter.都不重要431–She abandoned her husband and her son 但她就这样抛弃了她的丈夫和孩子432–and I’ll never forgive her.我永远不会原谅她433–As I watched Susan, I couldn’t help feeling sorry for her.当我看着苏珊 我觉得很抱歉434–She wanted so much to know why I did it.她是如此的想要弄明白真相435–Why I killed myself.为什么我要自杀436–It’s not enough to want the truth.但仅仅想知道真相还远远不够437–You must know where to look for it.你必须知道如何去找438–And the truth is elusive 但真相是难以琢磨的439–because it knows where to hide.因为它知道如何隐藏自己440–Hello, Julie, I talked to your mom 朱莉 你好 我跟你妈妈说过441–about donating some clothes for Edie.捐点衣服给伊迪的事情442–She’s at Mrs. Van De Kamp’s,她在范德坎普太太家443–but I’ll see if she left some stuff upstairs.我上楼看看她有没有留下什么444–Oh, Julie, I-I was, um, just admiring your new measuring cup.朱莉 我只是在看你们的新量杯445— Yeah, we’ve lost ours. - Really?-我们之前的那个丢了 -是吗446–So I couldn’t find the clothes. Sorry.我没找到什么衣服 不好意思447–That’s ok.没关系448–If you want me to keep looking.你希望我再找找吗449–No. You’ve done more than enough.不用 你做的已经够多了450–Truly.真的451–Bree. Rex just called. He won’t be able to meet you here today.布里 雷克斯刚刚电话来说他今 天不能来了452–Apparently, there was an emergency at the hospital.可能是医院出了一些紧急事件453–Oh, well, I wish he’d called me.我希望他是给我打的电话454–He suggested perhaps you’d like to meet with me by yourself.他建议你或许可以自己先跟我谈 谈455–You’ve been very quiet in our joint sessions.在我们的会面中你一直说的很少456–What?什么457–Oh, oh, oh, no, thank you.哦 不不 谢谢你458–I have some things I need to do today.我今天还有别的事459— Are you sure? - Uh, yeah, I’m sure.-你确定吗 -是 我确定460–Ok.好的461–Dr. Goldfine, there is something you can do for me.高德芬博士 有一件事你可以帮我462— What’s that? - Take off your coat.-什么事 -把你的外套脱下来463–So you’re taking Julie on your dinner date with Mike?所以你得带上朱莉和麦克共进晚餐464–Well, if Edie’s gonna be there,是的 如果伊迪也在那的话465–I’ll need emotional support.我需要一些精神支持466–I can’t believe she wormed her way in.我真不敢相信她插手了467–How did you let her do that?你就让她这么做了吗468–I don’t know. I was going to take her out at the knees,我不知道 我正要把她踢开469–but it all happened so fast.但事情发生的太快了470–Well, you know what you need to do.你知道你要怎么做吗471–You need to get there early,你要尽早到那里472–spend a little time with Mike before the little barracuda gets there.在那个女人来之前跟麦克多 待一会473–That’s a good idea. Edie will get there at 5:45,好主意 伊迪五点四十五分到那474–which means her breasts will arrive at 5:30,那意味着她会猴急的五点半就到475–so I should shoot for 5:00.那我应该五点就出现476–That a girl.这才对477–I’m just going to take these upstairs.我把这些东西拿上楼478–I’m going to keep my one little bag and go home.我就拿这个小袋子回家了479–That is a beautiful rose. Where did you get it?这玫瑰真漂亮 你从哪弄来的480–Oh, John gave it to me.约翰送我的481–John… your gardener, he gave you a rose?约翰 你的园丁 他送你玫瑰482–Yes… I am having some new bushes planted outside,是的 我在外面弄了一块新的花园483–and he gave me that as a color palette.他就给了我这个来做些点缀484–Ok.好吧485–Sure is beautiful, isn’t it?这花真是太美了 对吧486–Yes, it is.是的 真的很美487–I’m sure Freud would not approve of this.我确定弗洛伊德不会赞成这个的488–Oh, who cares what he thinks?谁管弗洛伊德怎么想489–I took psychology in college.我大学时学过心理学490–We learned all about Freud.我们学的全是弗洛伊德491–A miserable human being.一个可悲的人492–What makes you say that?你为什么会这么说493–Think about it.想想看494–He grew up in the late 1800s.他生活在十八世纪晚期495–There were no appliances back then.那时候还没有任何电器496–His mother had to do everything by hand,他母亲不得不亲手做每一件事情497–just backbreaking work from sun up to sundown.忙忙碌碌从早到晚498–Not to mention the countless 更别提她为了照顾好她的家庭499–other sacrifices she had to make 而做出的其他那些500–to take care of her family, and what does he do?难以衡量的牺牲 而当时他在做什么501–He becomes famous peddling a theory 他发表了一种广为人知的理论502–that the problems of most adults 而这种理论就是 绝大多数成年人的问题503–can be traced back to 都可以归结到他们母亲做过的504–something awful their mother has done.某些可怕的事情上去505–She must’ve felt so betrayed.他母亲一定很难受506–He saw how hard she worked.他看到了她有多么辛苦507–He saw what she did for him.也看到了她为他所做的一切508–Did he even ever think to say thank you?他曾想过要对她说谢谢吗509–I doubt it.我很怀疑510–There you go.缝好了511–Just so you know, many of Freud’s 你要知道 弗洛伊德的很多理论512–theories have been discredited.都倍受怀疑和争议513–Good.很好514–Boys, I am not gonna tell you again. Sit.小子们 我再说最后一次 坐下515–I mean it. I am serious.我认真的516–You guys are gonna be in so much trouble 如果你们再不坐下517–if you don’t sit back in those seats.就会有大麻烦了518–For the first time,勒奈特第一次发现519–Lynette could see this was not the innocent play of children.这不仅仅是小孩们的游戏了520–She was being challenged.他们在挑战她的极限521–So she decided it was time to get creative.所以她决定是时候要用点办法了522–Out! Can’t behave,出来 我警告过523–you heard me, you cannot ride.不听话就不能坐车了524–You, out, move it.你 出来 快点525–Where is she going?她要去哪526–Ok. Mommy’s a genius.妈妈是个天才527–Five, six, all right.五 六 好了528–Uh, mommy’ll be right back.妈妈很快就回来529–Boys? Boys?孩子们 孩子们530–Boys?!宝贝们531–Porter! Preston! Parker!波特 普雷斯顿 帕克532–If you’re hiding, you’ve got to stop now,如果你们藏起来了 赶紧给我出来533–cause mommy doesn’t think it’s funny!妈妈觉得一点都不好玩534–Oh! excuse me.哦 不好意思535–I’m sorry. I’m looking for my boys.对不起 我在找我的孩子536–Three boys with red hair. Have you seen them?三个红色头发的男孩 你看见他们了吗537–Yeah. I also saw you drive away and leave them.当然 我还看见你把他们扔下自己开车走了538–I know. I was just trying to scare them into behaving.我只是想吓唬一下好让他们乖一点539–Did you see where they went?你看到他们去哪了吗540–Yeah, they’re in my kitchen.他们在我厨房里541–Listen, it seems to me that you 听着 在我看来542–have some anger management issues.你在情绪控制上有些问题543–I have four kids under six.我有四个不到六岁的孩子544–I absolutely have anger management issues.我当然得好好控制情绪545–I think you need to talk to somebody 我觉得你需要找人谈谈546–because abandoning your children…因为你居然遗弃了自己的孩子547–I didn’t abandon them. I came back.我没有遗弃他们 我回来了548–I’m just saying it’s not normal.我是说 这可不是件寻常小事549–My kids aren’t normal 我的孩子们本来就不寻常550–and now I don’t have time for this, lady, so –而且女士我现在真的没时间谈这个551–Boys, get out here.孩子们 出来552–I don’t think they should go anywhere 除非你冷静下来553–until you calm down.不然我不会让他们出来的554— Get in the car. - She’s got cookies.-上车 -她给了我们饼干555— Bring them, we’re leaving. - Stay put.-带上它们 我们要走了 -不许动556— I don’t think so. Oh! - Listen, lady…-我不同意 -听着 女士557— Leave my mommy alone. - Let go of me.-别碰我妈妈 -让我过去558— What’s the matter with you? - Son of bi… Ah!-你有什么神经病 -婊 噢559— Run, boys, run! - Come on!-快跑 孩子们 跑 -快560— Oh, crap. - Get back here.-糟了 -给我回来561–Boys, you’re gonna need to put on your…孩子们 你们需要系好562–Get back or I’m gonna call social services.给我回来 我要叫保安了563–Oh, my god! Carlos, what have you done?哦 上帝啊 卡洛斯你在干什么564–I saw it when I drove by the dealership.经过汽车经销店的时候我看到了它565–I thought Gabrielle will look beautiful in this.我想我的加布丽尔坐在里面肯定很漂亮566–Carlos!卡洛斯567–It cost me an arm and a leg.我可是花了大价钱568–It’s got GPS navigation, 200 watt stereo system…它有 GPS 自动搜寻系统569–It is beautiful.太漂亮了570–So did I take your breath away?算是一个惊喜了吧571–Absolutely.当然572–Is it the best gift you’ve ever gotten?这是不是你得过最好的礼物呢573–Gabrielle could see what this gesture had cost Carlos,加布丽尔知道这花了卡洛斯多少钱574–so she responded the only way she knew how.所以她用她唯一知道的方式来报答575–She had a feling the truth would’ve 她觉得反正她的丈夫永远576–been lost on her husband anyway.都不会知道真相577–After all, it’s the rare man who understands the value 毕竟 很少有人理解578–of a single perfect rose.一支完美玫瑰的含义579— Susan. - I hope you don’t mind.-苏珊 -我希望你不要介意580–I came by early to help you set up.我想早点过来帮忙581— Oh, um… - Hey, Susan.-这个 -嗨 苏珊582–Don’t worry, we have everything under control.别担心 一切都在我们的掌控之下583–Bongo! I don’t know why he barks at you.邦戈 我不明白它为什么老是冲你叫584–I wouldn’t take it personally.我不是针对你585–Dogs are very sensitive.狗是很敏感的动物586–What’s up, Bongo?怎么了 邦戈587–You never know what freaks them out, huh?你永远不知道是什么吓到了它们588–In the distance, Susan thought she heard a bell ring.远远的 苏珊仿佛听到了一声警报589–Is it a strange noise?是奇怪的响声吗590–What is it? A weird smell?还是什么 奇怪的味道591–Round one…had started.第一轮比赛开始592–All I’m saying is 我想说的是593–this whole it takes two to mess 婚姻是两个人的问题594–up a marriage theory is bull.这话纯属无稽之谈595–The problems that we have are because of her.我们的问题都在于她596–That is not true, Rex.不是这样的 雷克斯597–What have I been doing for the past 我在过去的 20 年598–20 years that’s been so awful?有做过什么糟糕的事吗599–You’re not saying anything because 你不能抱怨是因为600–I’ve been a great husband.我一直以来都是个好丈夫601–And it kills you to admit that.你却打死不愿意承认602–Rex, I’m curious.雷克斯 我很好奇603–Do you ever acknowledge the benefits of living with Bree?你有没有想过跟布里一起住的好处604— Huh? - By your own admission,-什么 -根据你的叙述605–your home’s always clean,你的家永远是干净的606–your clothes always freshly pressed,衣服永远是慰平的607–sounds like a wonderful cook,食物永远是好吃的608–despite her flaws,除了她本身的过错609–do you ever remember to say thank you?你有没有想过说声 谢谢610— Thank you? - Yes.-说谢谢 -是的611–Bongo! Get down! Down!邦戈 下去 下去612— Go away. - Down. I’m sorry. I’m sorry.-走开 -下去 不好意思613–So who’s the guy that lives across from Mrs. Huber again?那个 你刚说住在胡博太太街对面的 是谁614–That’s Mr. Mullen. If he invites you in,是缪伦先生 他想邀请你去他家615–you have to meet all of his pets.他会让你和所有的宠物打招呼616–That’s ok. I love animals.那没关系 我喜欢动物617–He’s a taxidermist.他收集动物标本618–Oh, ok, thanks for the warning.哦 这样 谢谢提醒619–Isn’t Mr. Mullen’s brother your divorce attorney?缪伦先生的兄弟是你的离婚律师吧620–Uh, yes, yes, he was.是 他是621–Can I say something?其实622–In my heart, I still believe that you 在我心里 我一直相信你623–and Karl are gonna get back together.和卡尔会最终复合624— Really? - Oh, yeah.-是吗 -是的625–I’ve never seen two people more in love.我再也没有见过比他们更相爱的了626–She’s never gonna find that kind of 她再也不能找到另一个627–chemistry with another man. Never.跟她有如此火花的男人 肯定不能628–It was everything Susan could do to keep a smile on her face.苏珊 所能做的就是尽力保持微笑629–Round two was underway,第二轮比赛开始630–and she was already taking a beating.她已经遭遇了重重一击631–You know, Mrs. Britt…你知道吗 布利特夫人632–What Edie hadn’t counted on…伊迪 没有料到的是633–I always liked…我很喜欢634–Susan had someone in her corner.苏珊还有个小帮手635–Mr. Rothwell, your fourth husband.罗斯威尔先生 你的第四任丈夫636–He was my second husband. I’ve only been married twice.他是我第二任 我只结过两次婚637–Twice? You weren’t married to the tattooed 两次吗 你没有跟那个满身纹身638–guy they took away in handcuffs?最后被手铐铐走的那个人结婚639–No, Julie, she wasn’t married to Javier.没有 朱莉 她没有跟哈维尔结婚640–That was just one of her special friends.他只是她一个特别的朋友641–I think we should change the subject.我觉得我们是不是应该换个话题642–Unless you want to keep talking about it.除非你还想谈643— Bongo, get down. - Wait.-邦戈 下去 -等一下644— Let me show you something. - He loves that gravy.-你快看 -他超喜欢这个肉汁645–Come. While you were in there tossing a salad,当你在那边做沙拉的时候646–I taught him something.我教了他一些东西647–Up. Oh…起来648–Susan was furious with Edie 苏珊很恼怒 伊迪用一只狗649–for using a dog to ingratiate herself with its owner.来博取他主人的好感650–She was also furious with Mike for not 她也恼怒麦克651–seing through this blatant maneuver.没有看出这一明显的作秀652–But mostly…但她最恼怒的是653–…I’m gonna get the desserts.我去拿甜点654–…She was furious with herself for not having thought of it first.她自己没有先想到这一招655–I can barely get him to sit.我连叫它坐下都不能656–Best dog ever. Yes, you are.它是最好的狗 没错657–I’ve never seen him walk on two legs.我从来没见它用两条腿走路过658–He knows who to come to.他知道该听谁的659–Here’s your dessert.甜点来了660–Thank you. Mike, this looks yummy.谢谢 麦克 看上去好吃极了661–Oh, look at that. Looks like bongo’s 看那 看上去邦戈662–finally warming up to Susan.终于跟苏珊亲密起来663–Ooh, we just got off on the wrong foot.我们只是一开始没有相处好664–We’re best buddies now.我们现在是好朋友了665–Oh, what a good boy!真乖666— Bango, are you ok? - What’s wrong with him?-邦戈 你还好吧 -它怎么了667–I don’t know.不知道668–I’ve never heard him make that sound.从来没有听过它发出这样的叫声669— You ok, fella? - Mom?-你还好吧 -妈妈670–You all right?你还好吗671–Where is your earring?你的耳环呢672–You ok?你还好吗673–Call the vet, the number’s on the fridge.打电话给兽医 电话在冰箱上674–Tell him I’ll be right there.告诉他我马上到675–Don’t worry.别着急676–I’ll stay here and get everything cleaned up.我会在这儿把一切整理干净的677–Thanks, Edie.谢谢 伊迪678–Is there anything I can do?我能做些什么吗679–No.不用了680–How’s Bongo doing?邦戈怎么样了681–I’m waiting to see if they’ll have to operate.我还在等 不知道要不要手术682–Oh, god!天啊683–I stopped and I got this for…我买了这个 给684–I am just so sorry for this.我很抱歉685–I’m really sorry I snapped at you. I just…对不起我吼了你 我只是686— Oh, no, it’s ok. - Good news.-哦 没关系 -好消息687— We won’t have to do surgery. - Oh, that’s great.-我们不用做手术了 -太好了688–We’ve given him something to help pass the earring.我们给了它点药让它排出耳环689–When he does, would you like us to retrieve it for you?你还想要你回你的耳环吗690–I’m gonna say no.我想不用了691–Ok. You should be able to take him home in about an hour.一小时后就可以带它回家了692–Wow. You must be so relieved.这下你放心了693–I’m sorry, I was just really worried.对不起 我只是太担心694–It was your dog. I get it.那是你的狗 我理解695–Actually, he was my wife’s dog,其实是我妻子的狗696–one of the last thing’s she said to 在医院她离开前交代的697–me in the hospital before she died 最后一件事698–was to be sure I looked after 就是让我照顾好它699–him and I promised her I would.我答应了她我会的700–And just like that,就这样701–Susan could suddenly see something she’d never seen before.苏珊明白了以前没有明白的事702–He, uh, meant so much to her.它 对她很重要703–Mike Delfino was still in love with his late wife.麦克·德尔非诺仍然爱着他死去的妻子704–And if something had happened,如果有事发生705–I would’ve felt like I’d failed her.我会觉得我让她失望了706–I know that sounds stupid, but…我知道这听上去很傻 但是707–And she knew right then,她现在明白708–neither she nor Edie would be laying 她和伊迪都不能709–claim to his heart any time soon.快速俘获他的心710–No, it doesn’t. Not at all.不 这不傻 一点也不711–So she decided, for now, she could 她决定 从现在开始712–settle for just being his friend.她可以仅仅只是做他的朋友713–This is for you.这是给你的714–Well, for Bongo. You give it to him.给邦戈的 你交给它715–Yes, as I look back at the world I left behind,没错 当我回头看这世界716–it’s all so clear to me.一切都很清楚717–The beauty that waits to be unveiled.那些等待被发现的美丽718–The mysteries that long to be uncovered 那些没被发现的秘密719–But people so rarely stop to take a look.但是人们很少停下来看一看720–They just keep moving.他们总是埋头前进721–It’s a shame, really.这真是个遗憾722–There’s so much to see 其实他们能看到更多" }, { "title": "Desperate Housewives S01E01", "url": "/posts/english-desperate-housewives-s01e01/", "categories": "English", "tags": "english", "date": "2022-04-19 20:00:00 +0800", "snippet": "Desperate Housewives S01E011–My name is Mary Alice Young.我叫玛丽·艾莉丝·杨2–When you read this morning’s paper,如果你看了今天的早报3–you may come across an article 可能会读到一篇报道4–about the unusual day I had last week.有关我上周异常的一天5–Normally, there’s never anything newsworthy about my life,通常 我的生活没有任何新闻价值6–but that all changed last Thursday.然而 直到上周四 一切都改变了7–Of course, everything seemed quite normal at first. 起初每件事情都显得很平常8–I made breakfast for my family. 我为家人准备早餐9–I performed my chores. 做家务10–I completed my projects.完成手工制作11–I ran my errands.取回干洗的衣服12–In truth, I spent the day as I spent every other day,事实上 这天太平常不过了13–quietly polishing the routine of my life 平静地打理着家里的一切14–until it gleamed with perfection.直至完美15–That’s why it was so astonishing when 这就是为什么16–I decided to go to my hallway closet 当我走向走廊的壁橱17–and retrieve a revolver 拿出从没用过的左轮手枪时18–that had never been used.会如此令人震惊了19–My body was discovered by my neighbor,第一个发现我尸体的是20–Mrs. Martha Huber,我的邻居玛莎·胡博太太21–who’d been startled by a strange popping sound.她被这突如其来的声音吓了一跳22–Her curiosity aroused, Mrs. Huber tried to think of a reason 受好奇心驱使 她想到一个23–for dropping in on me unannounced.不请自来的理由24–After some initial hesitation,片刻犹豫之后25–she decided to return the blender she 她决定把半年前26–had borrowed from me six months before.借去的搅拌机还给我27–It’s my neighbor. I think she’s been shot.我的邻居 她被枪击了28–There’s blood everywhere.地上全是血29–Yes, you’ve got to send an ambulance.是的 快派救护车过来30–You’ve got to send one right now.赶快31–And, for a moment,然后 有那么一会32–Mrs. Huber stood motionless in her kitchen,胡博太太静静地站在厨房里33–grief-stricken by this senseless tragedy.陷入了深深的悲伤34–But only for a moment.但 仅数秒而已35–If there was one thing Mrs. Huber was known for,如果说胡博太太有什么优点36–it was her ability to look on the bright side.那就是凡事她都往积极的一面去想37–I was laid to rest on a Monday.我的葬礼在星期一38–After the funeral, all the residents of Wisteria Lane 葬礼结束后 紫藤郡的邻居们39–came to pay their respects.都去我家表达他们的哀思40–And, as people do in these situations,他们按照惯例41–they brought food.带来了食物42–Lynette Scavo brought fried chicken.勒奈特·斯加沃带了炸鸡43–Lynette had a great family recipe for fried chicken.勒奈特家有很棒的炸鸡秘方44–Of course, she didn’t cook much 当然 当她还在职场打拼的时候45–while moving up the corporate ladder.她很少做饭46–She didn’t have the time.因为没时间47–But when her doctor announced she was pregnant,但当被告知怀孕后48–her husband Tom had an idea.她的老公汤姆有了主意49–“Why not quit your job?”“你不如辞职吧”50–“Kids do better with stay-at-home moms.”“全职妈妈有利于孩子的成长”51–“It would be so much less stressful.”“这样压力也会小很多”52–But this was not the case.现实却不尽如人意53–In fact, Lynette’s life had become so hectic 勒奈特的日子变得更加忙碌54–she was now forced to get her chicken 以至于她不得不去快餐店55–from the fast-food restaurant.点了份外卖炸鸡56–Lynette would’ve appreciated 如果勒奈特回头想想57–the irony if she’d thought about it.她会发现一切都背道而驰58–But she couldn’t. She didn’t have the time.可惜 她根本没时间59— Stop it, stop it, stop it. - But, mom.-都给我停下来 -但是 妈妈60–No. You are going to behave today.别这样 你们今天得乖乖的61–I am not going to be humiliated 我不想在整条街的邻居62–in front of the entire neighborhood.面前丢脸63–And, just so you know how serious I am…你们要知道 我不是说说而已64–What’s that?那是什么65–Santa’s cell-phone number.圣诞老人的手机号码66–How did you get that?你怎么得到的67–I know someone who knows someone who knows an elf.我朋友的朋友认识一个小精灵68–And if any of you acts up,如果今天你们谁捣蛋69–so help me, I will call Santa 相信我 我会打电话给圣诞老人70–and I will tell him you want socks for Christmas.告诉他 圣诞节你们只想要袜子71–Are you willing to risk that?想试试吗72–Ok. Let’s get this over with.好 那就乖乖的吧73–Gabrielle Solis who lives down the 住在街角的加布丽尔·索利斯74–block brought a spicy paella.带了西班牙辣味炒饭75–Since her modeling days in New York,自从在纽约做了模特后76–Gabrielle had developed a taste 她的品位有了很大的提升77–for rich food…只吃名贵食物78–…and rich men.只约有钱男人79–Carlos, who worked in mergers and acquisitions,卡洛斯 从事兼并与收购业务80–proposed on their third date.在第三次约会时向她求婚了81–Gabrielle was touched when tears welled up in his eyes.加布丽尔被他的泪水打动了82–But she soon discovered this happened 但她很快发现83–every time Carlos closed a big deal.卡洛斯每做成一笔大生意时都会这样84–Gabrielle liked her paella piping hot.加布丽尔喜欢热腾腾的炒饭85–However, her relationship with her 然而 她和丈夫的关系86–husband was considerably cooler.却日益冷淡87–If you talk to Al Mason at this thing,你跟艾尔·梅森聊天时88–I want you to casually mention 不妨顺便透露下89–how much I paid for your necklace.你项链的价钱90–Why not pin the receipt to my chest?干脆在我胸前贴上标签好了91–He let me know how much he paid 他故意告诉我 他为他老婆的92–for his wife’s convertible.敞篷车花了多少钱93–Look, just work it into the conversation.不经意提到就好94–There’s no way I can just work that in, Carlos.卡洛斯 我做不到很随意地插话95–Why not? At the Donahue party,怎么会呢 在唐纳修的宴会上96–everyone was talking mutual funds.每个人都在谈论公共基金97–You found a way to mentioned you slept with 而你却想方设法告诉大家你跟扬基队98–half the Yankee outfield.一半的外场手上过床99–I’m telling you, it came up in the context of the conversation.我再说一次 当时大家就是谈的这些100–Hey, people are starting to stare.人们在看我们了101–Can you keep your voice down, please?你能小点声吗102–Absolutely. We wouldn’t want 当然了 我们可不愿意103–them to think we’re not happy.被别人发现我们不愉快104–Bree Van De Kamp, who lives next door,住在隔壁的布里·范德坎普105–brought baskets of muffins she baked from scratch.带了两篮她亲手烤制的松饼106–Bree was known for her cooking,布里擅长烹饪107–and for making her own clothes,自己缝纫做衣108–and for doing her own gardening,亲手打理花园109–and for re-upholstering her own furniture.甚至自己翻新家具110–Yes, Bree’s many talents were known 是的 布里非常能干111–throughout the neighborhood.远近皆知112–Everyone on Wisteria Lane thought of 紫藤郡的每个人都觉得113–Bree as the perfect wife and mother.布里是个完美的妻子114–Everyone, that is, except her own family.每个人 不包括她的家人115–Paul. Zachary.保罗 扎克116–Hello, Mrs. Van De Kamp.你好 范德坎普太太117–Bree, you shouldn’t have gone to all this trouble.布里 不必这么麻烦的118–It was no trouble at all.一点都不麻烦119–Now, the basket with the red ribbon 扎红丝的这篮120–is filled with desserts for your guests,是为客人们准备的121–but the one with the blue ribbon 蓝丝带的这篮122–is just for you and Zachary.是特地为你和扎克准备的123–It’s got rolls, muffins,里面有面包圈 松饼124–breakfast type things.和一些早餐食物125–Thank you.谢谢126–Well, the least I could do is make sure 我能帮的就这些了127–you boys had a decent meal 至少明天早上128–to look forward to in the morning.你们还能吃上顿像样的早餐129–I know you’re out of your minds with grief.我知道你们悲痛万分130–Yes, we are.是的131–Of course, I will need the baskets back once you’re done.对了 吃完后请把篮子还给我132–Of course.当然133–Susan Mayer, who lives across the street,住在对街的苏珊·梅尔134–brought macaroni and cheese.带了乳酪通心粉135–Her husband, Karl, always teased her about her macaroni,她丈夫卡尔 总是嘲笑她136–saying it was the only thing she knew how 说她只会做乳酪通心粉137–to cook and she rarely made it well.却还做不好138–It was too salty the night she 在她和卡尔刚搬入新家的那晚139–and Karl moved into their house.她做的太咸了140–It was too watery the night she 在她发现卡尔的衣领上有口红印那晚141–found lipstick on Karl’s shirt.她做的又太淡了142–She burned it the night Karl told her 在卡尔为了他的秘书离开她的那晚143–he was leaving her for his secretary.她把通心粉烤糊了144–A year had passed since the divorce.离婚一年之后145–Susan had started to think how nice it 苏珊开始觉得146–would be to have a man in her life.生命中有个男人还是挺好的147–Even one who would make fun of her cooking.就算是个会嘲笑她厨艺的男人148–Mom, why would someone kill themselves?妈妈 为什么人们会自杀149–Well, sometimes people are so unhappy,因为有时候人们很不开心150–they think that’s the only way to solve their problems.觉得自杀是解决问题的唯一办法151— Mrs. Young always seemed happy. - Yeah.-杨太太看起来总是很开心啊 -没错152–Sometimes people pretend to be one way,有时候人们表现出一面153–when they’re totally different on the inside.而内心却是截然不同的一面154–Oh, you mean like how dad’s girlfriend always smiling and says 就像爸爸的女朋友满脸微笑155–nice things, but we know she’s a bitch.讲话动听 但我们都知道她是个贱女人156–I don’t like that word, Julie.朱莉 我不喜欢你用那个词157–But, yeah, that’s a great example.不过 这个例子很棒158–You’re welcome.感谢你们的到来159–What’s going on?怎么样了160–Sorry I’m late.对不起我来晚了161— Hi, Susan. - Hey.-嗨 苏珊 -嗨162–So, what did Karl say when you confronted him?当你跟卡尔对质的时候他怎么说163–You’ll love this. He said…说得可好了 他说164–“It doesn’t mean anything. It was just sex.”“这根本不能说明什么 仅仅是性而已”165–Ah, yes, page one of the philanderer’s handbook.哦 是啊 花花公子手册第一页166–Yeah, and then he got this zen look on his face,是啊 然后他就一脸无辜地对我说167–and he said, “you know, Susan,”你知道 苏珊168–most men live lives of quiet desperation.”大多数男人都生活在平静的绝望之中”169–Please tell me you punched him.告诉我你揍他了170–No. I said, “Really? And what do most women 没有 我说 “真的吗 那么大多数女人171–lead lives of noisy fulfillment?”吵吵闹闹的一生又算什么”172–Hmm. Good for you.说得好173–I mean, of all people,我是说 那么多人174–did he have to bang his secretary?你就非要搞上自己的秘书吗175–I had that woman over for brunch.我还给那女人做过早午餐176–It’s like my grandmother always said –正如我祖母常说的那样177–an erect penis doesn’t have a conscience.男人那儿硬的时候没有良知可言178–Even the limp ones aren’t that ethical.即使不硬也是没什么良知179–This is half the reason I joined the NRA.这也是我加入枪支协会的原因之一180–Well, when Rex started going to those medical conferences,当雷克斯开始参加那些医学会议时181–I wanted it in the back of his mind that 我希望他明白182–he had a loving wife at home 家里有个很爱他的妻子183–with a loaded Smith &amp;amp; Wesson.和一把上了膛的沃森左轮手枪184–Lynnie, Tom’s always away on business.勒奈特 汤姆总是出差185–Do you ever worry he might?你不担心他会发生什么事吗186–Oh, please, the man’s gotten me pregnant three times in four years.拜托 这个男人让我四年 里怀了三次孕187–I wish he was having sex with someone else.我倒希望他去和别人做爱188–So, Susan, is he gonna stop seeing that woman?所以 苏珊 他还会再见那个女人吗189–I don’t know.我也不知道190–I’m sorry, you guys, I just…抱歉 姐妹们 我只是191–I just don’t know how I’m gonna survive this.我不知道自己要怎么熬过去192–Listen to me.听我说193–We all have moments of desperation.我们都有绝望的时候194–If we can face them head-on, that’s when 当我们熬过去的时候195–we’d find out how strong we really are.就会发现自己有多强大196–Susan.苏珊197–Susan.苏珊198–I was just saying Paul wants us to go over on friday.我说保罗请我们周五过来199–He needs us to go to Mary Alice’s closet 帮他整理玛丽·艾莉丝的衣橱200–and help pack up her things.收拾下她的遗物201–He says he can’t face doing it by himself.他说他不能独自面对202— Sure. That’s fine. - Are you ok?-好啊 没问题 -你还好吧203–Yeah. I’m just so angry.没事 我就是太生气了204–If Mary Alice was having problems,如果玛丽·艾莉丝当时有问题205–she should have come to us. She should’ve let us help her.她应该告诉我们 让我们帮她206–What problems could she have had? She was healthy,她能有什么问题 她很健康207–had a great home, a nice family. Her life was…舒适的房子 和睦的家庭 她的人生就是208–Our life.我们的翻版209–No. If Mary Alice was having a crisis,不会的 如果当时玛丽·艾莉丝有危机210–we’d have known.我们会发现的211–She lives 50 feet away, for god sakes.她住的那么近212–Gabby, the woman killed herself.加布 那个女人都已经自杀了213–Something must’ve been going on.这事没这么简单214–I wouldn’t eat that if I were you. - Why?-如果我是你 我绝不吃那东西 -为什么215–I made it. Trust me.那是我做的 相信我216–Hey, hey, do you have a death wish?等等 你有什么遗愿吗217–No, I just refused to believe that anybody 没有 我不相信有人连218–can screw up macaroni and cheese.乳酪通心粉都不会做219–Oh, my god.哦 天哪220–How did you…? It tastes like 你怎么能 这吃起来就像221–it’s burnt and undercooked.烤焦了但又没熟222–Yeah, I get that a lot. Here you go.是啊 我经常这样 接着223–Thanks. I’m Mike Delfino.谢谢 我是麦克·德尔非诺224–I just started renting the Sims’ house next door.我刚租下隔壁赛蒙家的房子225–Susan Mayer. I live across the street.苏珊·梅尔 我住对面226–Mrs. Huber told me about you,胡博太太跟我说过你227–said you illustrate children’s books.说你为儿童书画插画228–Yeah, I’m very big with the under-five set.是啊 五岁以下的孩子都知道我229–What do you do?你是做什么的230–Plumber. So if you ever have a clog…水管工 所以万一你有东西堵住了231–…or something.或是别的什么232–Now that everybody’s seen that I brought something,现在大家都看到我带来的东西了233–I should probably just throw this out.我应该早点把它扔了234–Ease up, you little vampire.轻点 小冤家235–Lynette, I’ve been looking all over for you.勒奈特 我到处找你236–Are you aware of what your sons are doing?知道你的儿子们在干嘛吗237–Cannonball!大炮攻击238–Stop!停下来239–What are you doing? We are at a wake.你们在干什么 这可是个告别会240–Oh my god. You said we could go in the pool.天啊 你说我们可以游泳的241–I said you could go by the pool.我说的是你们可以在泳池旁边242–Do you have your swimsuits on?你们穿了泳衣243–Yeah, we put ‘em on ourselves before we left.穿了 出门前穿的244–You three planned this? All right. That’s it. Get out.你们三个计划好的是吧 够了 出来245— No. - No?-不要 -不要246–I am your mother. You have to do what I say. Come on.我是你们的妈妈 照我说的做 快点247–We want to swim and you can’t stop us!我们想游泳 你阻止不了我们248–Here.劳驾249— No! - Get out.-别过来 -快出来250–Think I won’t get in this pool and just grab you? Get out!以为我不会下来抓你们吗 出来251–Get over here.过来252–Get over here.过来253–All right, give me your arm.好的 胳膊伸过来254–You…你255–That’s right. Get over here.这就对了 过来256–Go, go, go, go, go. Move it.快快快 走257–Out. Get out.出来 给我出来258–Paul, we have to leave now.保罗 我们得走了259–Once again, I am so sorry for your loss.你妻子的事我很遗憾260–Go.走261–Lynette shouldn’t have been so concerned about my husband.勒奈特用不着这么关心我丈夫262–He had other things on his mind. Things below the surface.他所担心的是那些不会浮出水面的 秘密263–The morning after my funeral, my friends 我葬礼第二天的早上 我的朋友们264–and neighbors quietly went back 和邻居们就默默地回到了265–to their busy, busy lives.他们忙碌的生活中266–While some did their cooking…有的在做饭267–…And some did their cleaning…有的在打扫268–…And some did their yoga…有的在做瑜伽269–…Others…还有的270–…did their “homework”.在做”家庭作业”271–Hi…你好272–I’m Julie. I kicked my soccer ball into your backyard.我是朱莉 我把球踢到你家后院了273–Oh, ok. Well, let’s go round and get it.好的 那我们过去捡274–Stay 别出来275–His wife died a year ago. He wanted to stay in LA,他妻子一年前死了 他本想留在洛杉矶276–but here were too many memories.但是那有太多回忆了277–He’s renting for tax purposes,税务原因他现在只能租房278–but hopes to buy a place soon.但是他想尽快买一幢279–I can’t believe you went over there 我不敢相信你竟然去那了280–Hey, I saw you both flirting at the wake.我看到你们在告别会上调情了281–You are obviously into each other 你们双方都有好感282–Now you know he’s single, you can ask him out.既然知道他单身 你就能约他啦283–Julie, I like Mr. Delfino, I do.朱莉 我喜欢德尔菲诺先生 我承认284–I just… I don’t know if I’m ready to start dating yet.我只是不知道自己是否准备好约会了285–You need to get back out there.你需要回到社交圈去286–Come on. How long has it been since you’ve had sex?你上次做爱是什么时候287–Are you mad that I asked you that?你生气了288–No, I’m trying to remember.不是 我在想答案289–I don’t want to talk to you about my love life any more.我不想再跟你讨论我的情感生活了290–It warns me out 会刺激到我291–I wouldn’t have said anything.It’s just…我本来不应该说 只是292–What?什么293–I heard dad’s girlfriend ask if you’d 我听见爸爸的女朋友问294–dated anyone since the divorce.你离婚之后有没有约过谁295–And dad said he doubted it.爸爸说他很怀疑296–And then they both laughed.然后他们都笑了297–Hey, Susan.嗨 苏珊298–Hi, Mike. I brought you a little house-warming gift.嗨 麦克 我带了个搬家礼物给你299–I should’ve brought something by earlier, but 我应该早点送礼物过来的300— Actually, you’re the first to stop by. - Really?-实际上 你是第一个拜访的 -真的吗301–Susan knew she was lucky.苏珊知道自己很幸运302— An eligible bachelor had moved on to Wisteria Lane - Welcome-一个称心的单身汉搬到了紫 藤郡 -欢迎303–and she was the first to find out.而她又是第一个发现的304–But she also knew that good news…但她也知道 好消息305— Hello there. - …Travels quickly.-你们好啊 -总是不胫而走306–Edie Britt was the most predatory 伊迪·布利特是方圆五个街区内307–divorce in a five-block radius.最风骚的离异女子308–Her conquests were numerous.她的俘虏不计其数309–Varied.种类繁多310–and legendary.如传奇一般311–Hi, Susan. I hope I’m not interrupting.你好 苏珊 希望没打扰到你们312–You must be Mike Delfino.你一定就是麦克·德尔非诺313–Hi, I’m Edie… Britt.你好 我是伊迪·布利特314–I live over there.我住那315–Welcome to Wisteria Lane.欢迎搬来紫藤郡316–Susan had met the enemy. And she was a slut.苏珊碰到对手了 还是个荡妇317–Thank you. What’s this?谢谢 这是什么318–Sausage puttanesca.茄汁香肠319–It’s just something I threw together.不过是我随便做的320–Well, thanks, Edie.谢谢 伊迪321–That’s… great. I’d invite you both in,真好 我应该请你们进来的322–but I was sort of in the middle of something.但是我正在忙323–I’m late for an appointment.我赴约就要迟到了324–I just wanted to say hi.我就是过来打个招呼325–And just like that, the race for Mike Delfino had begun.就这样 麦克·德尔非诺之争开始了326–For a moment, Susan wondered if her rivalry with Edie 有一瞬间 苏珊想她和伊迪说不定327–would remain friendly.可以友好地竞争328–Oh, Mike, I heard you’re a plumber.哦 麦克 我听说你是个水管工329–But she was reminded that when it came to men…但是她想起来 在男人的问题上330–Do you think you could stop by later and take a look at my pipes?你一会能过来看看我家的管道 吗331— …Women don’t fight fair. - Sure.-女人不会公平竞争 -没问题332–Thanks.谢啦333–Bye, Susan.拜 苏珊334–You can’t order me around like I am a child.你别想像管小孩那样指挥我335–Gabrielle.加布丽尔336–No, no. I’m not going.不 我才不去337–It’s business. Tanaka expects everyone to bring their wives.这是生意 塔纳卡希望每人都携眷 出席338–Every time I’m around that man, he tries to grab my ass.每次我在那男人周围 他都想捏我的 屁股339–I made over 200,000 doing business with him last year.去年我从他那赚了二十万340–If he wants to grab your ass, you let him.如果他想捏你的屁股 让他捏341–John.约翰342–Mr. Solis, you scared me.索利斯先生 你吓到我了343–Why is that bush there? You were supposed to dig it up last week.那怎么还有杂草 你上周就 该除掉的344— I didn’t have time. - I don’t want to hear your excuses.-我没时间 -别找借口345–Just take care of it.把它处理好346–I really hate the way you talk to me.我讨厌你跟我说话的语气347–And I hate that I spent $15,000 on your diamond necklace 我讨厌花一万五千块买条348–which you couldn’t live without.没它你就活不下去的钻石项链349–But I’m learning to deal with it.但是我学着接受了350–So can I tell Tanaka we’ll be there tomorrow?我能告诉塔纳卡我们明晚都会去了吗351–John, we have bandages top shelf in the kitchen.约翰 邦迪在厨房的架子上352–Thanks, Mrs. Solis.谢谢 索利斯夫人353–Fine, I’ll go.好吧 我去354–But I’m keeping my back pressed 但是我会整晚355–against the wall the entire time.都靠墙站着的356–See, now this is what a marriage is all about.看到了吧 这就是婚姻的真谛357–Compromise.妥协358— Is your finger ok? - Yeah, it’s just a small cut.-你手指没事吧 -没事 一个小口子而已359–Let me see. Mmm.给我看看360–You know, Mrs. Solis, I really like it when we hook up,索利斯夫人 我喜欢和你亲热361–but, um, you know, I got to get my work done and…但是 我还有活要干362–…I can’t afford to lose this job.我可丢不起这份工作363–This table was hand-carved.这张桌子可是纯手工雕刻364–Carlos had it imported from Italy.卡洛斯从意大利进购的365–It cost him $23,000.花了他$23000366–You want to do it on the table this time?你这次想在桌子上做吗367–Absolutely.当然了368–Why can’t we ever have normal soup?我们不能喝普通一点的汤吗369–Danielle, there is nothing abnormal about basil puree.丹妮尔 罗勒汤就很普通啊370–Just once,就一次371–couldn’t we have a soup that people have heard of?喝一点大家都知道的汤372–Like French onion or navy bean.例如法式洋葱汤 或者菜豆汤373–First of all, your father can’t eat onions.首先 你爸爸对洋葱过敏374–He’s deathly allergic. And I won’t 那是致命的375–even dignify your navy bean suggestion.再说我也不认为菜豆汤是个好主意376–So… how’s the osso buco?炖小牛胫味道怎么样377— It’s ok. - It’s ok?-还可以 -只是还可以378–Andrew, I spent three hours cooking this meal.安德鲁 我花了三小时做这顿饭379–How do you think it makes me feel when you 但别人却随口敷衍一句380–say “it’s okay” in that sullen tone?”还可以” 想想我的感受381–Who asked you to spend three hours on dinner?没人让你花三小时准备晚饭382–Excuse me?你说什么383–Tim Harper’s mom gets home from work,汤姆·哈伯的妈妈工作回来后384–pops open a can of pork and beans,直接打开一些猪肉和豆子罐头385–and boom, they’re eating. Everyone’s happy.然后热热闹闹的吃饭 大家都很开心386–You’d rather I serve pork and beans?你宁愿我做猪肉和豆子吗387–Apologize now. I am begging.我求你赶紧道歉388–I’m saying,我的意思是389–do you always have to serve cuisine?有必要总是显摆你的厨艺吗390–Can’t we ever just have food?难道我们就不能简单地吃顿饭391— Are you doing drugs? - What?-你嗑药了么 -什么392–Change in behavior is one of the warning signs,行为异常就是嗑药的表现393–and you have been as fresh as 在此之前的394–paint for the last six months.半年里你都很正常395–That certainly would explain 我想这就是396–why you’re always locked in the bathroom.你经常躲在卫生间的原因397–Trust me, that is not what he is doing.相信我 他在卫生间可不是干这事398–Shut up.闭嘴399–Mom, I’m not the one with the problem here, all right?妈妈 有问题的不是我400–You’re the one always acting like 你才是那个表现得401–she’s running for mayor of Stepford.像要竞选市长的402–Rex… Seeing that you’re the head of this household,雷克斯 作为一家之主403–I would really appreciate you saying something.你得说些什么吧404–Pass thee salt?把盐给我405–Three days after my funeral,葬礼过去三天后406–Lynette replaced her grief with a much more useful emotion.勒奈特不再悲伤了407–Indignation.而是愤怒408–Tom, this is my fifth message,汤姆 这是我第五次给你留言了409–and you still haven’t called me back.可你还不回电话给我410–Well, you must be having a lot of fun 好吧 看来你这次出差其乐无穷411–on your business trip. I can only imagine.我只能这样想了412–Well, guess what – The kids and I want to have some fun, too,我想我和孩子们也要出去玩玩了413–so unless you call me back by noon,除非你在中午之前给我回电话414–we are getting on a plane and joining you.否则我们会坐飞机过来找你415–Mom.妈妈416–Not now. Mommy’s threatening daddy.现在不行 我正威胁爸爸呢417— Mom. - No, I…-妈妈 -不行418— Where are your brothers? - Noodles, my favorite.-哥哥们呢 -面条 我的最爱419— Lyneettee Scavo? - Crap.-勒奈特·斯加沃 -该死的420–Natalie Klein. I don’t believe it.娜塔丽·柯莱恩 真不敢相信421–Lynette. How long has it been?勒奈特 我们多久没见了422–Years. Uh, how are you?有些年头了 过的怎么样423–How’s the firm?公司还好吗424–Good. Everyone misses you.很好 大家都很想你425–We all say if you hadn’t quit,大家都说如果你不走的话426–you’d be running the place by now.现在肯定是老板了427–Yeah, well.是啊428–So… How’s domestic life?家庭生活怎么样429–Don’t you just love being a mom?做全职妈妈感觉怎样430–And there it was. The question that Lynette always dreaded.麻烦来了 勒奈特最怕别人问这个 问题431–Well, to be honest…说实话432–For those who asked it, only one answer was acceptable,对于这个问题 答案只有一个433–So Lynette responded as she always did. She lied.所以勒奈特和往常一样说了谎434–It’s the best job I’ve ever had.这是有史以来最棒的工作435— You know what I don’t get? - What?-知道我好奇什么吗 -什么436–Why you married Mr. Solis.你为什么要和索利斯先生结婚437–Well… He promised to give me 因为他能给我438–everything I’ve ever wanted.任何我想要的东西439— And did he? - Yes.-他做到了吗 -是的440–Then why aren’t you happy?那你为什么不开心441–Turns out I wanted all the wrong things.看来我得到的都不是真正想要的442–So do you love him?那你爱他吗443–I do.是的444–Well, then, why are we here? Why are we doing this?那我们为什么还在这偷情445–Because I don’t want to wake up one morning 因为我可不想某天醒来446–with a sudden urge to blow my brains out.想把自己的脑袋打爆447— Hey, can I have a drag? - Absolutely not.-我能抽根吗 -当然不行448–You are much too young to smoke.对你来说 抽烟还太早449–How would you feel about me using your 如果我用你的抚养费去做整形手术450–child-support payments for plastic surgery?你觉得怎样451–Stop being so nervous. You’re just 别那么紧张452–asking him to dinner. No big deal.你只是约他吃饭 没什么大不了的453–You’re right.你说的对454–So is that your project for school?那是你的作业吗455–You know, when I was in fifth grade,五年级的时候456–I made the White House out of sugar cubes.我用糖块做出了白宫457–Stop stalling and go.别磨蹭了 赶紧去458–Before Mike figures out he can do better.在麦克有更好的选择之前459–Tell me again why I fought for custody of you.我为什么要争夺你的抚养权460— You were using me to hurt dad. - Oh, that’s right.-你想气气爸爸 -说得好461–Oh, god.天哪462— Hi. - Hey, Susan.-嗨 -嗨 苏珊463–Are you busy?你在忙吗464–No, not at all. What’s up?不忙 怎么了465–Well, I… I just, uh, was wondering if…我只是在想466–…if there was any chance that you, uh…你是否有时间467–…I just wanted to ask if…我想问你468— Edie. - Hey, there, Susan.-伊迪 -嗨 苏珊469— What are you…? - I was making ambrosia.-你怎么 -我刚做了些食物470–And I made too much so I thought 不过我一个人吃不了471–I’d bring some over to Mike.所以就拿过来和麦克一起分享472–What’s going on?怎么了473–Susan was just going to ask me something.苏珊正打算问我什么474— I have a clog. - Excuse me?-我家水管堵住了 -什么475— And you’re a plumber, right? - Yeah.-你是个水管工 不是吗 -是的476— The clog’s in the pipe. - Yeah,-水管里有东西堵住了 -是啊477–That’s usually where they are.通常问题都在那478–Well, I’ve got one.是啊 就是这种情况479–Ok. Let me get my tools.好吧 我去拿下工具480–Now? You want to come over now? You have company.现在就过去修理吗 你这还有伴呢481–I don’t mind.我不介意482–Just give me two minutes. I’ll be right over.等我 2 分钟 马上就过来483–That’s it.就这样484— Just stuff the hair down there. - I stuffed it.-赶紧用头发把它塞满 -我塞了485— It’s not enough to clog it. - Here. Okay, look.-但还是不能堵住 -好吧486–Put in this peanut butter 把花生酱也倒进去487–and this cooking oil.还有烹饪油488— Mom - And these olives.-妈妈 -还有这些橄榄489–Mom, I’m telling you, it’s not working.妈妈 我说了 这些都没用490–Oh, god. That’s him.我的天哪 他来了491–How am I going to stop up the sink?我该怎么办492–Well, here’s your problem.好了 问题在这里493–Looks like somebody stuffed 看来有人把一堆冰棒棍子494–a bunch of popsicle sticks down here.扔了进来495–I’ve told Julie a million times 我告诉朱莉无数次496–not to play in the kitchen. Kids, you know.不要在厨房打闹 但是小孩都这样497–All right, I’ll go put in your orders,好的 我这就去做准备498–And I’ll be right back with your drinks 马上把你们的饮料499–and your plates for the salad bar.和装沙拉用的盘子拿来500–Thank you.谢谢501–Andrew, Danielle, napkins?安德鲁 丹妮尔 摆好餐巾502–They have video games.这儿有电视游戏503–Could we go play until our food gets here?我们能过去玩玩吗 菜上了就回来504–Andrew, this is family time. I think that we should all 安德鲁 这是家庭聚餐 我想我们505–Go ahead and play.去玩吧506–I know that you think I’m angry about coming here,也许你认为我不喜欢这种地方507–but I’m not.其实不是508–You and the kids wanted a change of pace,你和孩子们想换个有趣点的环境509–something fun I get it.我明白510–Probably we’ll want 说不定你们明天晚上511–something healthier tomorrow night, though.就想吃些健康点的食物了512–I’m thinking about chicken Saltimbocca.我打算做些煎鸡肉卷513–I want a divorcee.我们离婚吧514–I just can’t live in this…我实在不能忍受515–…this detergent commercial anymore 这种毫无瑕疵的生活516–The salad bar’s right over there. Help yourself.沙拉台就在那边 请随便享用517–Thank you.谢谢518–Um, I think I’ll go get your salad for you.我去帮你拿些沙拉519— Bree Van De Kamp. - Oh. Hello, Mrs. Huber.-布里·范德坎普 -你好 胡博太太520–We didn’t get a chance to talk at 在玛丽·艾莉丝的追思会上521–Mary Alice’s wake. How are you doing?我们都没有好好聊过 最近怎么样522–Bree longed to share the truth about 布里很想和她分享523–her husband’s painful betrayal,丈夫背叛了自己的事524–but sadly for Bree,悲哀的是525–admitting defeat was not an option.布里绝不会承认自己是失败者526–Great. Everything is just great.很好 一切都很好527–Okay, well, I got you the honey mustard dressing.我给你的沙拉浇了蜂蜜黄芥末酱528–The ranch looked just a little bit suspect.看起来很田园529–Are we going to talk about what I said?能继续刚才的谈话吗530–If you think I’m going to discuss the dissolution 我才不会在这个用”美眉”和”帅哥”531–of my marriage in a place 作为洗手间标示的地方532–where the restrooms are labeled “chicks” and “dudes”,讨论我们的婚姻问题533–you’re out of your mind.你疯了吧534–What’s in this?这里面有什么535–What do you mean, what’s in this? It’s salad.还能是什么 沙拉啊536— With… with onions. - What?-里面有洋葱 -什么537— You put onions in my salad. - No, I didn’t.-你在里面放了洋葱 -我没有538–Oh, wait.怎么会这样539–The sound that awakened my son was 惊醒我儿子的声音540–something he’d heard only once before.在他还很小的时候541–Many years ago when he was quite young.听到过一次542–But he recognized it instantly.但他马上就明白了543–It was the sound of a family secret.这声音是我们家的秘密544–Seven days after my funeral, life on Wisteria Lane 葬礼过去七天后545–finally returned to normal.紫藤郡人的生活重归正常546–Which, for some of my friends, was unfortunate.对于我的某些朋友来说 生活并不尽如人意547— Mommy, mommy! - Now what?-妈妈 妈妈 -又怎么了548–Daddy’s home!爸爸回来了549–Come on! Hey, is anybody home?过来 家里有人吗550–I wasn’t expecting you for a week.我以为你不打算回来了551–I have to go back to ‘Frisco in the morning.我今天上午得赶回旧金山552–But I got your call. You sounded frazzled.但我收到你的留言了 你听起来你很憔悴553–Yeah.没错554— It’s been a little rough. - Hi. Yeah. Peaches.-我的确有点累 -嗯 桃子味555–Did you buy us any presents?你给我们带礼物了吗556–Oh, god, presents. Wait up. Let me see.对了 礼物 等一下 我找找557— Ohhh! - Yeah!-在这儿 -太棒了558–But I’m not giving it to you unless 但你们得保证 现在就到外面去559–you promise to go outside right now 练二十分钟投球560–and practise throwing for 20 minutes. You promise?我才能把球给你们 行吗561— Yeah! Yeah! Yeah! - Punks. Get out!-好耶 好耶 -孩子们 快去吧562–Who’s open? Go out. Deeper. Deeper. Touchdown!谁来开球 出去 再远点儿 触地得分563–Oh, my god.天哪564–Oh, no.别这样565–You got to be kidding. I’m exhausted.你开玩笑吧 我累瘫了566–I look terrible. I’m covered in peaches.身上一团糟 还都是桃子味567–I’m sorry, baby. I got to have you.抱歉了 宝贝 我控制不了了568–Well, is it ok if I just lie here?我能不能就这么躺着569–Absolutely.当然可以570— I love you. - I love you more.-我爱你 -我更爱你571–Wait. I gotta tell you I was having trouble with swelling.等等 我有点肿胀的毛病572–The doctor took me off the pill.医生不让我吃避孕药了573–You just gotta put on a condom.你得把套子戴上574— A condom? - Yeah.-戴套子 -没错575–What’s the big deal? Let’s risk it.没什么大不了的 我们就赌一把吧576— Let’s risk it? - Yeah.-赌一把 -对啊577–I can’t believe you tried to kill me.真没想到你会想要杀了我578–Yes, well, I feel badly about that.我很抱歉579–I told you Mrs. Huber came over 我说过了 胡博太太当时走过来580–and I got distracted. It was a mistake.我走神了 是我不小心而已581–Since when do you make mistakes?你怎么会有疏忽的时候582–What does that mean?这话什么意思583–It means I’m sick of you being 你永远都让事情保持完美584–so damn perfect all the time.这让我无法忍受585–I’m sick of the bizarre way your hair doesn’t move.我讨厌你的头发总是一丝不苟586–I’m sick of you making our bed in the 我讨厌早晨我还没去洗手间587–morning before I’ve used the bathroom.你就已经把床铺好了588–You’re this plastic suburban housewife,你简直就是个人造的完美家庭主妇589–with her pearls and spatula,戴着珍珠项链 拿着刮铲590–who says things like “we owe the Hendersons a dinner.”嘴里说着饭”591–Where’s the woman I fell in love with…我一见倾心的女人去哪儿了592–…Who used to burn the toast and 那个会把面包烤焦593–drink milk out of the carton?喝纸盒牛奶的女人594–and laugh.会放声大笑的女人595–I need her.我想念她了596–Not this cold, perfect thing you’ve become.而不是现在这样完美却冷酷的597–These need water.这花该换水了598–Bree sobbed quietly in the restroom for five minutes,布里在洗手间里安静的抽泣了五分钟599–but her husband never knew.但她丈夫不知道600–Because when Bree finally emerged…因为当她出来的时候601–…she was perfect.她又完美如初602–I found my earrings. We can go now.我找到耳环了 可以走了603–Was John here today?约翰今天来过吗604–Well, yeah.来过啊605–The lawn hasn’t been mowed. I’ve had it.草坪根本没修剪 我受够了606–We’re getting a real gardener.得换个专业园丁了607— Why? - Are you deaf?-为什么 -你没听见吗608–I just said he’s not doing his job.他根本没完成他的活儿609–It’s dark. You just can’t see the lawn has been mowed.天太黑了 你看不出来草坪已经剪过了610–It hasn’t been. Feel this grass.就是没有 看看这草611–I’m not feeling the grass.我怎么看不到612–Let’s just get going. Come on, we’re late.快走吧 我们要迟到了613— Take care of it. - Yes, sir.-把车停好 -是 先生614–There’s Tanaka. Time for me to go and do my dance.塔纳卡在那边 轮到我大显身手了615–Good luck, sweetheart.祝你好运 甜心617— Excuse me. - Ma’am.-等一下 -你好618–You see that man just walked away?看到那个刚走开的男人了吗619–Can you make sure he has a drink in his hand all night long?你能保证他今晚手里一直都有酒吗620–Yes, ma’am.好的 女士621— Susan? Susan! - Mrs. Huber, how are you doing?-苏珊 苏珊 -胡博太太 近来可好622–Not too well, I’m afraid.不算太好623–I’m trying to find something to soothe my stomach.我想找点治胃病的药624— It’s upset? - Yeah.-胃不舒服 -对啊625–I had the worst macaroni and cheese at the wake.我在追思会上吃了超难吃的奶酪通心粉626–It’s been running through me ever since.然后胃就一直没舒服过627–And I need to be at my best.我得赶紧好起来628–Edie Britt’s son is spending the night tonight.伊迪·布利特的儿子今晚要来我家过夜629–He’s spending the night?他要在你家过夜630–Apparently Edie is having a gentleman friend over for dinner,伊迪要和一位先生共进晚餐631–and I think she plans on entertaining into the wee hours,我猜她打算狂欢一整夜632–if you know what I mean.你明白我的意思吧633–Oh, here’s some antacid. Have you ever tried this?这有些抗酸剂 你服过这种药吗634–I can’t believe it. This can’t be happening.难以置信 怎么可能呢635–Mike can’t like Edie better than me. He just can’t.比起我 麦克不会更喜欢伊迪的 不可能636–You don’t know what’s going on.你又不知道究竟会发生什么事637–Maybe they’re just having dinner.没准儿他们就是吃个饭而已638–You’re right. They’re doing it.你说得没错 他们要上床了639–Edie?伊迪640–Edie?伊迪641–Hello? Anybody home?有人在家吗642–I need to borrow sugar.我要借点糖643–Oh, my god! Oh, yes! Give it to me!上帝啊 就是这样 给我644–And just like that, the possibility Susan had clung to,就这样 苏珊对麦克·德尔非诺抱有的645–the maybe of Mike Delfino, was gone forever.最后一点幻想 也破灭了646–And despite the precariousness of her situation,尽管她心绪难平647–Susan took a moment to mourn her loss.苏珊还是坐下来伤了一会儿心648–It didn’t take Susan long to realize,苏珊马上就发现649–this was just not her night.今天晚上她注定倒霉650–Is somebody out there?是谁在楼下651–Oh, my god! That’s smoke!上帝啊 冒烟了652–Oh, my god.天哪653–She left candles unattended in the den.她把点燃的蜡烛丢在外间里654–Paramedic said she was lucky.医生说她已经很幸运了655–She could’ve been killed.她本来可能会死的656–She ran out with nothing on.她什么都没穿就跑了出来657–She was having sex with some guy when the fire started.起火的时候她和别人做爱呢658–What happened to him?那人怎么样了659–He got smoke inhalation. He’s at the hospital.他吸入了烟雾 送医院了660–Susan, are you all right? You look awful.苏珊 你没事吧 你脸色不对劲啊661–I’m fine. I’m fine. I just, uh, feel really bad for Edie.我没事 没事 我只是 为伊迪感到遗憾662–Oh, honey, don’t worry about Edie. She’s a strong lady.宝贝儿 不用为她担心 她很坚强的663–Absolutely. She’ll get through this.没错 她能挺过来的664–She’ll find a way to survive.她总有办法渡过难关665–We all do.我们都是如此666–Come on.走吧667— Wow! What happened? - Mike!-天啊 怎么回事 -麦克668–And suddenly there he was.突然间 他出现了669–Like a phoenix rising from the ashes.像是浴火重生的凤凰670–I… I thought you were… Uh… Where were you?我以为你在 你去哪儿了671–I just got back from the movies. Edie had a fire, huh?我刚从电影院回来 伊迪家着火了是吗672–Yeah. Yeah, but she’s fine now.是啊 不过她现在没事了673–Everything’s fine now.一切都没事了674–And just like that, Susan was happy.就这样 苏珊很高兴675–Life was suddenly full of… possibilities.她的生活又充满了无限可能676–Not to mention a few unexpected surprises.更别说一些意外的”惊喜”了677— Hello. - It’s me.-喂 -是我678— Have anything yet? - No, nothing yet.-有消息了吗 -还没有679–But don’t worry. I’m definitely getting closer.不过别着急 我快要得手了680–I brought some champagne.我带了些香槟681–I thought we should have a toast.我觉得我们应该喝一杯682–The next day my friends came together 第二天 我的朋友们一起过来683–to pack away my clothes,把我的衣服 私人物品684–my personal belongings and what was left of my life.还有我留下的一切痕迹都清理走685–All right, ladies, lift ‘em up.好了 姑娘们 举杯吧686–To Mary Alice, a good friend and neighbor.敬玛丽·艾莉丝 好朋友 好邻居687–Wherever you are, we hope you’ve found peace.无论你身在何处 愿你能寻得平静688— To Mary Alice. - To Mary Alice.-敬玛丽·艾莉丝 -敬玛丽·艾莉丝689–Let’s get this show on the road.好好整理一下吧690–You guys, check out Mary Alice’s clothes.你们快来看看玛丽·艾莉丝的衣服691–Size eight? Ha! She always told me she was a size six.八号的 她一直说她穿六号692–We found the skeleton in her closet.她的小秘密曝光了693–Not quite, Gabrielle, not quite.这不算秘密 加布丽尔 还有呢694— What’s that? - A letter addressed to Mary Alice.-那是什么 -一封给玛丽·艾莉丝的信695–How ironic.真是讽刺696–To have something I tried so desperately to keep secret,我一直以来要保守的秘密697–treated so casually.如此轻易地被发现了698–What are you doing? That’s private.你干什么呢 这是隐私699–It’s open. What’s the big deal?这已经打开了 没关系的700–我知道你干的好事 真恶心 我要告诉别人701–What does this mean?这是什么意思702–I don’t know. But check out the postmark.不知道 不过看这邮戳703–Oh, my god. She got it the day she died.天哪 是她自杀那天收到的704–Do you think this is why she…?会不会就是因为这个她705–I’m so sorry, girls.对不起 姐妹们706–I never wanted you to be burdened with this.我本不想让你们卷进来707–Oh, Mary Alice, what did you do?玛丽·艾莉丝 你做了什么" }, { "title": "读《应对孩子的愤怒与攻击》", "url": "/posts/book-mastering-anger-and-aggression/", "categories": "读书", "tags": "books", "date": "2022-04-02 20:00:00 +0800", "snippet": "随着生活环境的改变以及两个娃逐渐的长大，娃的教育问题愈加变得急迫起来，可以说每天都在困扰着我和我老婆。举一个几乎每天都在发生的事情作为例子：凡凡（二娃）把姐姐的玩具拆了，姐姐很生气，动手就去打弟弟。这样的场景我们不能说谁是错的，但是又该怎么处理才更好呢？怎么处理好姐姐生气的情绪以及带来的打人的行为，怎么处理不知所措的弟弟呢？作为新手爸妈，虽然把娃养到了 3 岁，但是教育问题，才刚刚开始。我们购买了一套家庭教育的书，分别是《读懂二孩心理》、《给孩子立规矩》、《应对孩子的愤怒与攻击》，最想让我先拿起的就是这本《应对孩子的愤怒与攻击》。第一章为情绪不分好坏，都是孩子成长的动力。作为开头，其实没讲什么，主旨就是告诉我们要肯定孩子的情绪，不论好坏，要去接纳孩子的坏情绪。第二章名为掌握发展关键点，变攻击为成长契机。这章主要介绍了小孩子从出生到 6 岁他的情绪发展的一个大概过程，以及各个阶段变化的关键节点在哪里。孩子在成长过程中会有数个猛涨期，在那几天他们会有些格外的烦躁和难带，往往会弄的我们精疲力尽，但是过了之后，会意外的发现他在某一方面突然像是长大了一样，这可能体现在身体的发育比如突然会坐或者会走，也可能体现在语言或者情绪方面，比如突然感觉可以和他像个大孩子一样交流了，他能懂得在和他说什么了。我想这个猛涨期，其实就是一些关键节点吧。在这一章中，让我印象深刻的，是两个点，一个是要帮助孩子处理他的情绪，而不是单纯地管控他的行为，第二个则是界限。情绪我女儿现在是 3 岁多，发怒和动手打人的行为非常常见，回想一下，我们大部分情况都是在她发怒打人之后，告诉她打人是不对的，弟弟会疼，就算是弟弟先不对，你打人也不对，你可以怎么怎么做，blabla… 不能再打人了，但其实并没有什么用。现在想来，我们的问题应该就是出在我们只关注了她的行为，希望通过说教去影响她的行为，而没有正确疏导她的情绪。打人只是她情绪积攒到一定程度的爆发，是表象，而她的负面情绪，其实一般都会提前有征兆的，这点我也深有体会。比如她为了保护自己的 “领地”，一般都会在感受到威胁之后，立马发出警告，但是弟弟还小，不能理解，闯入了她的 “领地” 之后，她就会很生气。那么作为父母，如果能够在她发怒之前，告诉她弟弟并不能理解，或者把弟弟带到别的地方玩儿，这样就能避免一场冲突。或者在冲突之后，我们应该做的是疏导她的情绪，教她识别自己的情绪，告诉她她刚刚为什么会生气，下次如果再生气的话，可以试试别的办法去发泄，比如发泄给小兔子等等办法。这样子不断地引导，我相信她能够处理好情绪之后，也就不会再动手打人了，毕竟那只是她发泄情绪的方式，因为她自己并不会处理她的情绪。儿子现在 1 岁多，还处在不满意就大哭，来表达自己情绪的阶段，但是也已经有了偶尔动手的迹象，所以是时候用书上的思路，去试着引导俩娃的情绪了。界限书中提到了家长给孩子提供的界限这个概念，确实给了我一个不一样的角度去看待管教这件事。孩子随着不断地成长，会不断地去试探新鲜事物，以及他所能做的事情的界限。而这个界限，正是我们在对他们的管教和约束中产生的，界限是有必要的并且对他们的发展是有正向作用的。为什么这让我深有感触，因为我曾经对我们的管教是有顾虑的，来自两方面，一方面是我们是不是限制了孩子的天性；另一方面是孩子在快两岁的时候是那么的 “叛逆”，任何事情都要和我们说不，这是不是和我们学来的。随着他们长大活动能力变强，我们确实会时常和他们说不，比如这个不可以放嘴里，不能动剪刀，不能去马桶玩。。。界限是会给孩子带来安全感的，他知道家长会确保他在一个安全的环境中，知道他是被在乎的。所以该管教的时候是需要适当的管教的，有一本《正面管教》的书，可以读一读。第三章在生活中帮助孩子掌控愤怒与攻击这一章写了孩子容易出现愤怒与攻击的一些场景，并分析了原因给出了应对办法，比如在咬人时、在出现霸凌或嘲弄时、在体育竞技中等等，总结来看，我觉得基本原则就是： 先肯定孩子的情绪，理解他在当时的愤怒； 然后帮助孩子冷静下来，如果是打架那就分开两个孩子； 冷静之后再帮孩子分析原因，帮他识别并理清楚情绪的来源； 然后帮助他练习应对情绪的方法。虽然是从一些场景展开介绍，比较实用，但是总觉得讲得不够深入，读下来给我的感觉就像是一本简单的工具书。方法先实践起来，看看能不能有所改观，育娃这件事本来就没有教科书可以参考，着实是一个很大的挑战。" }, { "title": "读《Fullstack React Native》（二）", "url": "/posts/book-fullstack-react-native-2/", "categories": "读书", "tags": "books", "date": "2022-03-24 20:00:00 +0800", "snippet": "七步法构建 RN 应用这本书的第二章，用了一个新的示例应用：计时器，介绍了构建 RN 应用的七步法，分别是： 把应用分解为不同的组件。 开始构建一个静态的应用。 决定哪些数据需要使用 state 来保存状态。 决定这些 state 应该存在在哪个组件中。 先用 hardcode 的初始状态。 添加数据流动逻辑，包括向上的数据流动。 添加和服务器的通信。这个计时器应用长这样子：整章主要是采用该七步法，去实际的写代码来实现这个计时器，使我们能够真正理解这个方法，没有介绍新的关于 RN 的核心概念，这里我对自认为有用的两点做了笔记。Class components vs Functional components在上一章中，我们创建组件使用的都是 Class components, 本章介绍了另外一种方式 Functional components 。下面通过一个简单的例子对比一下：class ClassComponent extends React.Component { render() { const { name } = this.props; return &amp;lt;Text&amp;gt;Hello, { name }&amp;lt;/Text&amp;gt;; }}const FunctionalComponent = ({ name }) =&amp;gt; { return &amp;lt;Text&amp;gt;Hello, {name}&amp;lt;/Text&amp;gt;;};Functional components 可以被认为是只需要实现 render() 方法的组件，他们不管理 state ，也不需要关注 React 特殊的生命周期。props 被作为第一个参数传入并解构。书中比较推荐的是 Functional components，有两个主要原因： 它能促使程序员在更少的地方管理 state，使程序更易懂。 它能使我们创建高可复用的组件，因为它所有的配置都需要从外面传进去。需要使用 State 的判定标准在第三步中，需要决定哪些数据需要使用 state，这里 Facebook 在 Thinking In React 这篇文章中，给了三个评判标准： 该数据是通过 props 从父组件中传入的吗？如果是，那它可能不是一个 state。 该数据会在后续被改变吗？如果不会，那它可能不是一个 state。 该数据可以根据组件中其他的 state 或者 props 计算得出吗？如果是，那它可能不是一个 state。Core ComponentsViewView 在 RN 中是被广泛使用的，它通常在以下两种情况下使用： 使用 View 来进行布局，对其中的子视图进行横向或纵向排列。 使用 View 来添加样式，例如添加边框、背景色等等。布局FlexRN 中的布局方式和前端类似，主要采用 flex 进行布局。在父视图上，有三个属性可供我们使用： flexDirection justifyContent alignItemsflexDirection 控制子组件的主轴方向，可选的值如下：justifyContent 控制子组件沿着主轴的排列方式，因此会受到主轴方向的影响，它可选的值如下：alignItems 控制子组件沿着交叉轴的排列方式，因此也会受到主轴方向的影响，它可选择的值如下：关于 flex 的使用，更详细的用法可以参考官方文档 Layout with FlexboxPositionPosition 这种布局方式是无视它的兄弟视图的，可能会使得视图重叠，它有两个值可以选择： relative：在视图被布局好之后，对其进行位置的调整 absolute：完全无视其他布局对它的影响，只相对于父视图进行布局比如如下的布局，会使得视图填充满父视图const absoluteFillStyle = { position: &#39;absolute&#39;, top: 0, right: 0, bottom: 0, left: 0,};Box ModelRN 中对于间距的设置和 Web 中是一样的，都是用 Box Model, 一般通过设置 margin 和 padding 就能满足我们的需求。当我们使用 width 和 height 时，指的是 content 的宽高加上 padding 和 border，不包括 margin。TextText 组件是有它的固有尺寸的，这和 iOS 开发中类似，渲染所需的文本所需要的宽高就是它默认的尺寸。Text 是比较简单的，那些常见的属性它都有，比如 color fontFamily fontSize textAlign numberOfLines 。TouchableOpacity这个组件和 View 类似，不同的是它可以接受点击事件，并且会在按下和释放的时候附带有动画效果，可以修改 activeOpacity 来调整动画对透明度的改变量。如果想要背景色改变的动画，可以使用 TouchableHighlight。这两个组件都只能有一个子组件，这是它们的一点限制。Image它可以通过 source 来渲染本地或者来自 URI 的图片。如果要设置图片的填充模式，可以使用 resizeMode。ActivityIndicator它会渲染 iOS 和 Android 平台上默认的 Loading 动画。FlatList这是用来渲染长列表的组件，它接受一个 data 的数据列表还有每个列表元素组件的构建方法 renderItem。它每次只会渲染一屏的组件来提升性能。TextInput文本输入框，主要用到的属性有 value，onChangeText，onSubmitEditing。ScrollView在渲染少量的需要滑动展示的视图时，可以使用 ScrollView，它不像 FlatList 那样每次只渲染一屏的组件，而是会将所有的组件全部渲染，所以只能用于少量数据的展示，否则会有性能问题。Modal用来展示模态视图的容器，用法如下，通过 visible 来控制其显示：&amp;lt;Modal visible={showModal} animationType=&quot;slide&quot; onRequestClose={this.closeCommentScreen}&amp;gt; &amp;lt;Comments/&amp;gt;&amp;lt;/Modal&amp;gt;Core APIs除了内置的组件之外，还有一些功能需要调用 API 来实现，比如存储、获取网络状况等。我们可以遵循以下方法来调用 RN 的 API： 先根据需求确定我们需要调用哪个 API 确定调用的位置，例如在某个生命周期的方法或者工具类中 调用 API，要注意是异步还是同步 在组件的 state 中存储返回的结果 根据最新的 state 来重新渲染 UIAsyncStorageRN 提供了 AsyncStorage 来做少量的字符串存储，它通过键值对然后序列化成 Json 去存储，基础的 API 是：AsyncStorage.getItem(key)AsyncStorage.setItem(key, value)如果要存储对象，需要先转成 Json 字符串，取出之后也需要解析成对象去使用。JSON.stringify(object)JSON.parse(jsonString)StatusBarRN 提供了两种方式来调整状态栏的 UI。一种是通过组件。这个组件可以放在任意的组件树中：const statusBar = ( &amp;lt;StatusBar backgroundColor={backgroundColor} barStyle={isConnected ? &#39;dark-content&#39; : &#39;light-content&#39;} animated={false} /&amp;gt;);第二种方法是调用 API：StatusBar.setBarStyle(info === &#39;none&#39; ? &#39;light-content&#39; : &#39;dark-content&#39;);NetInfo这是用来获取网络状态的 API下面这个 API 能够获取到当前的网络状态，返回的值可能为 wifi，cellular 或者 noneconst info = await NetInfo.getConnectionInfo();同时也可以监听网络的变化async componentWillMount() { this.subscription = NetInfo.addEventListener(&#39;connectionChange&#39;, this.handleChange);}componentWillUnmount() { this.subscription.remove();}handleChange = (info) =&amp;gt; { this.setState({ info });};Alert下面是 RN 中显示 Alert 的 API，会分别在 iOS 和 Android 上渲染 Alert 组件。handlePressMessage = () =&amp;gt; { Alert.alert( &#39;Delete message?&#39;, &#39;Are you sure you want to permanently delete this message?&#39;, [ { text: &#39;Cancel&#39;, style: &#39;cancel&#39;, }, { text: &#39;Delete&#39;, style: &#39;destructive&#39;, onPress: () =&amp;gt; { const { messages } = this.state; this.setState({ messages: messages.filter(message =&amp;gt; message.id !== id), }); }, }, ], );};Geolocation获取位置的 API：navigator.geolocation.getCurrentPosition(position =&amp;gt; { const { coords: { latitude, longitude } } = position;});Dimensions获取设备屏幕的宽高可以使用这个 API，要注意获取到的值是当前的屏幕宽高，如果旋转屏幕之后需要重新调用获取。const windowWidth = Dimensions.get(&#39;window&#39;).width;const windowHeight = Dimensions.get(&#39;window&#39;).height;组件生命周期参考 React Native Lifecycle" }, { "title": "读《Fullstack React Native》（一）", "url": "/posts/book-fullstack-react-native-1/", "categories": "读书", "tags": "books", "date": "2022-03-11 20:00:00 +0800", "snippet": "React Native 作为 Mobile 端的跨平台方案之一，有它独特的优势。之前虽然对其有所了解，但是不够系统和深入，这次借助工作的机会，从这本《Fullstack React Native》开始，加上项目的实践，得以对 React Native 有更深的理解。书中的第一个例子是一个天气应用，用户可以输入不同的城市，以得到相应的天气预报。第一个 ComponentApp 的入口是一个名为 App.js 的文件，我们一起来看看这个组件长什么样子。import React from &#39;react&#39;;import { StyleSheet, Text, View } from &#39;react-native&#39;;export default class App extends React.Component { render() { return ( &amp;lt;View style={styles.container}&amp;gt; &amp;lt;Text&amp;gt;Open up App.js to start working on your app!&amp;lt;/Text&amp;gt; &amp;lt;Text&amp;gt;Changes you make will automatically reload.&amp;lt;/Text&amp;gt; &amp;lt;Text&amp;gt;Shake your phone to open the developer menu.&amp;lt;/Text&amp;gt; &amp;lt;/View&amp;gt; ); }}const styles = StyleSheet.create({ container: { flex: 1, backgroundColor: &#39;#fff&#39;, alignItems: &#39;center&#39;, justifyContent: &#39;center&#39;, },});这里的 App 是一个继承自 React.Component 的类，这就是在 RN 里面定义组件的方式，render() 是唯一需要实现的方法，以返回需要显示的界面元素。&amp;lt;View&amp;gt; 组件接收的 style 参数是它的 props，这是 RN 提供的自定义组件的方式，通过传入不同的 props，来提供高复用性的组件。StyleSheet 是 RN 提供的供我们分离组件和其样式的 API，可以使代码更加整洁，便于关注业务逻辑。Custom componentsRN 提供了一些内置的组件，但是这还远远不能满足我们的需求，根据 《Atomic Design》 我们还可能会封装大量自定义的适合我们 App 的组件，下面是一个书中封装的自定义组件 SearchInput.import React from &#39;react&#39;;import { StyleSheet, TextInput, View } from &#39;react-native&#39;;export default class SearchInput extends React.Component { render() { return ( &amp;lt;View style={styles.container}&amp;gt; &amp;lt;TextInput autoCorrect={false} placeholder={this.props.placeholder} placeholderTextColor=&quot;white&quot; underlineColorAndroid=&quot;transparent&quot; style={styles.textInput} clearButtonMode=&quot;always&quot; /&amp;gt; &amp;lt;/View&amp;gt; ); }}它和 App.js 组件的结构看起来比较相似，主要的不同是使用了 this.props.placeholder ，这是在 RN 中数据从父组件传递到子组件的方式，就像这样子：&amp;lt;SearchInput placeholder=&quot;Search any city&quot; /&amp;gt;event-driven props上面的 SearchInput 只能展示，并不能接收用户的输入反馈。这里引入了一个概念叫 event-driven props , 下面通过书中的例子，来看具体如何使用。export default class SearchInput extends React.Component { handleChangeText = text =&amp;gt; { }; handleSubmitEditing = () =&amp;gt; { }; render() { return ( &amp;lt;View style={styles.container}&amp;gt; &amp;lt;TextInput ... onChangeText={this.handleChangeText} onSubmitEditing={this.handleSubmitEditing} /&amp;gt; &amp;lt;/View&amp;gt; ); }}此处的 onChangeText 和 onSubmitEditing 都是 event-driven props，它们会在特定事件触发时，调用传入的函数，具体到这里就是在每次输入的文本改变时，会调用 handleChangeText 方法，在提交更改时，调用 handleSubmitEditing 方法。State上面提到的 props 是被其父组件持有的，不能被修改，只能作为单向数据流从父组件向子组件传值。这就使得我们没办法将 SearchInput 的值向上传给父组件，以显示用户输入的值。这就得用到 state，它是被组件自己持有的，可以被修改，并且在修改的时候，要调用 setState() 方法，这不仅会修改 state，还会触发组件的 re-render 方法去更新 UI。使用 state 之后，SearchInput 看起来是这样的：export default class SearchInput extends React.Component { constructor(props) { super(props); this.state = { text: &#39;&#39;, }; } handleChangeText = text =&amp;gt; { this.setState({ text }); }; handleSubmitEditing = () =&amp;gt; { const { onSubmit } = this.props; const { text } = this.state; if (!text) return; onSubmit(text); this.setState({ text: &#39;&#39; }); }; render() { const { placeholder } = this.props; const { text } = this.state; return ( &amp;lt;View style={styles.container}&amp;gt; &amp;lt;TextInput autoCorrect={false} value={text} placeholder={placeholder} placeholderTextColor=&quot;white&quot; underlineColorAndroid=&quot;transparent&quot; style={styles.textInput} clearButtonMode=&quot;always&quot; onChangeText={this.handleChangeText} onSubmitEditing={this.handleSubmitEditing} /&amp;gt; &amp;lt;/View&amp;gt; ); }}在文本更改时，将其存储在 state 中，在点击提交时，调用父组件传入的 onSubmit() 方法，将 state 中的值向上传递给父组件，来完成数据的向上流动。现在 Weather App 可以接受用户输入并且把输入的文本显示出来，界面是这样的：但是天气信息都还是假数据，下面就介绍到了如何在 RN 里请求网络数据。NetworkingRN 里的网络请求看起来还是比较简单的，使用到的是 JS 的 await，放在 async function 中作为异步请求。这里放两个书中的例子，清晰明了：export const fetchLocationId = async city =&amp;gt; { const response = await fetch( `https://www.metaweather.com/api/location/search/?query=${city}`, ); const locations = await response.json(); return locations[0].woeid;};export const fetchWeather = async woeid =&amp;gt; { const response = await fetch( `https://www.metaweather.com/api/location/${woeid}/`, ); const { title, consolidated_weather } = await response.json(); const { weather_state_name, the_temp } = consolidated_weather[0]; return { location: title, weather: weather_state_name, temperature: the_temp, };};await 表达式会暂停当前 async function 的执行，等待 Promise 处理完成。若 Promise 正常处理(fulfilled)，其回调的resolve函数参数作为 await 表达式的值，继续执行 async function。上面的两个请求分别根据搜索的城市查询 locationID 以及根据 ID 查询其天气。具体的调用如下，在用户输入提交的回调中，发起异步请求，根据结果来更新 state 并刷新UI：handleUpdateLocation = async city =&amp;gt; { if (!city) return; this.setState({ loading: true }, async () =&amp;gt; { try { const locationId = await fetchLocationId(city); const { location, weather, temperature } = await fetchWeather( locationId, ); this.setState({ loading: false, error: false, location, weather, temperature, }); } catch (e) { this.setState({ loading: false, error: true, }); } });};至此，一个简单的天气应用就完成了，它非常简单，但是包括了 RN 中的几个核心要素：Component Props State Networking 。我们已经可以利用已有的知识，来完成一个单页面应用了。" }, { "title": "读《iOS Test-Driven Development》（一）", "url": "/posts/book-ios-tdd-1/", "categories": "读书", "tags": "books", "date": "2021-09-01 20:00:00 +0800", "snippet": "TDD(Test-driven development) 是我们常聊的一种开发方式，我曾在开发 BFF(Backend For Frontend) 时实践 TDD，大为受益，也在编写 iOS 的 ViewModel 层时略有实践，但除了 ViewModel 层以外的许多场景，我都困惑于怎么实践 TDD，所以我阅读了 iOS Test-Driven Development 这本书，希望能从中找到答案。本篇将不会介绍如何在 iOS 项目中编写单元测试等基础概念，而是着重于分享如何对我平时觉得难以测试的部分进行 TDD。什么是 TDDTDD 顾名思义，就是用测试驱动开发，先写测试程序，然后编码实现其功能。下图非常形象地展示了 TDD 的过程。本图片出自书中 先写一个失败的等待被实现的测试用例 然后编写实现代码使测试通过 重构代码 重复此过程针对什么是 TDD 以及它的优缺点和争论，在这儿就不展开讲了，如果不熟悉的同学可以在网上查阅一下资料。可遵循的一种测试编写规范func testAppModel_whenStarted_isInInProgressState() { // 1 given app in not started let sut = AppModel() // 2 when started sut.start() // 3 then it is in inProgress let observedState = sut.appState XCTAssertEqual(observedState, AppState.inProgress)} 首先是测试的命名，建议要描述出测试的条件和意图，可以使用 testgiven_when_then 的模式来对测试命名，这样在测试日志中就能轻易地看出是哪里出错了。 sut 是 system under test 的缩写，如果都遵循这个变量命名的话，是非常简洁易懂的。 最重要的是测试方法的结构，同样按照 given/when/then 来进行： given 一般即系统的初始状态 when 则是会影响系统的行为、事件或状态改变 then 则是对得到的结果和预期进行比对 第一个测试第一个测试，往往是从测试一个还没有的类开始的，比如我们希望测试一个类 AppModel 刚初始化完之后的状态func testAppModel_whenInitialized_isInNotStartedState() { let sut = AppModel() let initialState = sut.appState XCTAssertEqual(initialState, AppState.notStarted)}这个时候我们其实都还没有创建 AppModel 这个类，一定记住，测试先行，我们把编译错误也认为是测试失败，因此我们已经做到了 TDD 的第一步，Red，即写了一个失败的测试。怎么对 ViewController 进行测试 The important thing when testing view controllers is to not test the views and controls directly. This is better done using UI automation tests. Here, the goal is to check the logic and state of the view controller.我们测试的是 ViewController 的逻辑和状态，而视图和交互组件的测试则交给 UI 测试。怎么样才能使其中的逻辑和状态更容易被测试呢，想必对架构有所研究的同学们应该知道答案了，那就是使用 MVVM 或者 VIPER 等架构，把逻辑从 ViewController 中抽取出来，使得 ViewModel 变得容易被测试。这里我们还是先从 MVC 的架构入手，看看如何进行测试。如何获取正确加载的 ViewController 实例在测试中，如果我们使用 let sut = ViewController() 去实例化 ViewController 然后对其中的一些状态进行测试，那么和我们正常启动 App 运行 ViewController 的过程是不一样的，这个实例是没有被正确初始化的，因此在使用其测试时不能获取到它正确的子视图或者一些状态。因此我们需要找到一种办法获取正确的 ViewController 实例。从 App 的运行环境中获取其实在运行测试时，Xcode 是会运行一个 Host Application 的，默认会运行我们的 App Target，这就是有时候我们在跑测试时，会看到在模拟器运行 App 的原因，其实测试都是被运行在 App 的上下文中的，我们可以取到 UIApplication 对象以及整个视图层级。let window = UIApplication.shared.windows[0]let rootViewController = window.rootViewController// 取到 rootViewController 之后，根据你自己的视图层级，获取想要的 VClet yourViewController = rootViewController.children.first { $0 is YourViewController }通过上面的代码片段，我们即可取到 App 运行起来之后你想要的 ViewController 的正确实例。实例化并加载视图如果你的视图是从 Storyboard 加载的，那么可以使用以下方法正确的实例化一个 ViewControllerlet storyboard = UIStoryboard(name: &quot;Main&quot;, bundle: nil)let yourViewController = storyboard.instantiateViewcontroller(withIdentifier: &quot;yourViewController&quot;) as! YourViewControlleryourViewController.loadViewIfNeeded()从 xib 加载也是类似的。测试 ViewController 中的状态或逻辑获取到 ViewController 的实例后，然后我们就要甄别出 UI 之外的状态和逻辑，这样测试起来就和 ViewModel 很类似了。比如对其中的某个方法进行测试，期望它正确的修改了 ViewController 中的变量：func testDataModel_whenGoalUpdate_updatesToNewGoal() { // given let sut = yourViewController // when sut.updateGoal(newGoal: 50) // then XCTAssertEqual(sut.goal, 50)}我们对 ViewController 的测试，不需要追求 100% 的测试覆盖率，因为视图部分的测试将被 UI automation 测试所覆盖。对异步事件进行测试在上个例子中使用 XCTAssert 断言语句时，我们测试的是同步事件，那么如何对异步耗时事件进行测试呢？这也是 iOS 测试中需要面临的重要问题。XCTestExpectation 为我们测试异步事件提供了很好的能力，它主要分别两部分：expectation 和 waiter。waiter 会一直等待 expectation 被 fulfill，然后再继续执行；或者在等不到的某个时间之后超时失败。func testStoryLoading() throws { let parser = FeedParser() // create the expectation let exp = expectation(description: &quot;Loading stories&quot;) // call my asynchronous method parser.loadStories { // when it finishes, mark my expectation as being fulfilled exp.fulfill() } // wait three seconds for all outstanding expectations to be fulfilled waitForExpectations(timeout: 3) // our expectation has been fulfilled, so we can check the result is correct XCTAssertEqual(parser.stories.count, 20, &quot;We should have loaded exactly 20 stories.&quot;)}这就是我们如何测试异步事件的。一些特殊异步事件的测试XCTestExpectation 还有一些别的方法，可以用来方便的测试一些其它的异步场景，比如下面的方法可以用来针对性的测试通知事件。func expectation(forNotification notificationName: NSNotification.Name, object objectToObserve: Any?, handler: XCTNSNotificationExpectation.Handler? = nil) -&amp;gt; XCTestExpectation使用 XCTKVOExpectation 可以观察某一个 keyPath 的改变；使用 XCTNSPredicateExpectation 可以监听某一个 predicate 是否为真。在使用 expectation 时的一个好的实践是：总是在异步回调中调用 fulfill()，就算是对于一些异步事件中的错误，也不要依赖超时去抛出错误，而是应该在 fulfill 之后，使用断言语句检查期望的错误。等待 wait 超时是非常浪费时间的。Dependency Injection &amp;amp; Mocks我们在对系统进行测试时，难免会遇到受外部依赖的限制这种情况，比如依赖网络请求获取到的数据，依赖三方库提供的能力等等。这种依赖是不稳定的，并且我们如果在测试时真正去做发起网络请求类似的事情，会非常浪费时间，因此我们会把依赖分离开来，通过注入的方式，给系统提供某种能力，然后在测试时，使用 Test Doubles 来模仿出这种能力，进而不影响系统的测试。Mock 是 Test Double 的非正式叫法。提到 Test Doubles，不得不说一下它的几种不同类型：Stub、Spy、Mock、Fake。Test Doubles 的不同类型以下例子来自 The Little Mocker，为 Java 代码。假设现在有一个接口interface Authorizer { public Boolean authorize(String username, String password);}如果希望创建该接口的 test doubles 的话，我们分别来看几种不同的形式。Stub用来返回 hard coded 的数据，推荐使用。public class AcceptingAuthorizerStub implements Authorizer { public Boolean authorize(String username, String password) { return true; }}Spy用来返回 hard coded 的数据，并且记录一些信息，不推荐使用但对于复杂情况可以接受，容易使测试和代码实现强耦合。public class AcceptingAuthorizerSpy implements Authorizer { public boolean authorizeWasCalled = false; public Boolean authorize(String username, String password) { authorizeWasCalled = true; return true; }}Mock用来返回 hard coded 的数据，同时记录一些信息，并且进行断言验证。Mock 总是包含 Spy 的，它更多的是验证行为，哪些函数被调用了、都有哪些参数、何时以及调用次数等行为。不推荐使用，因为它讲断言的验证隐藏在了 Mock 中。public class AcceptingAuthorizerVerificationMock implements Authorizer { public boolean authorizeWasCalled = false; public Boolean authorize(String username, String password) { authorizeWasCalled = true; return true; } public boolean verify() { return authorizedWasCalled; }}Fake根据不同的逻辑返回不同的假数据，完全不推荐，因为它包含了真正的业务逻辑在里面，还需要给 Fake 再写测试。public class AcceptingAuthorizerFake implements Authorizer { public Boolean authorize(String username, String password) { return username.equals(&quot;Bob&quot;); }}Dependency Injection现在假设我们正在做一个计步器的 App，我们获取步数的数据来源是 Apple 的 CoreMotion 框架提供给我们的 CMPedometer 类。一个预期的功能是，当点击开始时，来启动 CMPedometer 服务。根据这个 case，可以写出一个下面这样的测试：func testAppModel_whenStarted_startsPedometer() { //given let sut = AppModel() let exp = expectation(for: NSPredicate(block: { thing, _ -&amp;gt; Bool in return (thing as! AppModel).pedometerStarted }), evaluatedWith: sut, handler: nil) // when sut.start() // then wait(for: [exp], timeout: 1) XCTAssertTrue(sut.pedometerStarted)}基于以上测试，AppModel 的实现可以是这样的：class AppModel { let pedometer = CMPedometer() private(set) var pedometerStarted = false func start() { pedometer.startEventUpdates { event, error in if error == nil { self.pedometerStarted = true } } }}如果我们在真实的设备上执行测试，并且给予了获取步数的权限，这个测试是可以通过的。但是请注意我们给测试通过加了两个前提，这是不正常的，这时候就该 Test Doubles 出场了，创建 Mock 的对象，来摆脱外部的依赖。一起来看看怎么做吧！我们希望测试的是点击了 start 之后，之后的行为是正确的。那么可以通过模拟 start() 函数，来验证期望的行为。怎么将 CMPedometer 这个外部依赖进行分离呢，一个好的方式就是通过注入的方式提供给消费它的对象。首先创建一个协议，来提供 start() 应该有的行为，并让 CMPedometer 实现这个协议。protocol Pedometer { func start()}extension CMPedometer: Pedometer { func start() { startEventUpdates { event, error in // do nothing here for now } }}然后来重构 AppModel，注入 Pedometer 服务。class AppModel { let pedometer: Pedometer init(pedometer: Pedometer = CMPedometer()) { self.pedometer = pedometer } func start() { pedometer.start() }}然后再去重构测试，创建 PedometerSpy。class PedometerSpy: Pedometer { private(set) var started: Bool = false func start() { started = true }}func testAppModel_whenStarted_startsPedometer() { //given var pedometerSpy = PedometerSpy() let sut = AppModel(pedometer: pedometerSpy) // when sut.start() // then XCTAssertTrue(pedometerSpy.started)}这样就完成了外部依赖的分离，成功的创建一个 Mock 的对象，来完成我们的测试。其它的外部依赖，比如网络请求，都可以用这种模式进行分离。参考 How to test asynchronous functions using expectation() The Little Mocker" }, { "title": "iOS Combine：核心概念", "url": "/posts/ios-combine-core-concepts/", "categories": "iOS", "tags": "combine", "date": "2021-07-05 20:00:00 +0800", "snippet": "Combine 是 iOS13 新加入的库，它的出现主要是为了解决当前我们在进行异步编程时遇到的痛点，各种 Delegate, Callback, Notification 混杂在我们的 App 中，导致异步事件混乱，难以调试代码，下图展示了当前常用的异步 API：本图片来自 Combine 书籍Combine 和 RxSwift 中的核心思想和概念是一致的，所以如果你使用过 RxSwift，那么学习并使用 Combine 对你来说将是轻而易举的。核心Combine 的核心是 Publisher, Operator 和 Subscriber。Publisher：负责发送消息Operator：负责对消息进行处理，比如 map, filter 等Subscriber：接收消息进行消费大概流程如下图：本图中的素材来自 Combine 书籍从 Publisher 到 Operator 再到 Subscriber 的调用是链式的，Operator 的输入是 Publisher，输出仍然是 Publisher，得益于 Operator 的高度解耦，我们可以对数据进行多次处理，并且对其的测试也是比较容易的。下面分别对 Combine 中的几个核心概念进行说明，以下内容翻译自 Using CombinePublisher and Subscriber两个关键概念，publisher 和 subscriber，在 Swift 中被描述为协议。当你谈论编程（尤其是 Swift 和 Combine）时，类型描述了很多。 当你说一个函数或方法返回一个值时，该值通常被描述为“此类型之一”。Combine 就是定义随着时间的推移使用许多可能的值进行操作的过程。 Combine 还不仅仅是定义结果，它还定义了我们如何处理失败。 它不仅讨论可以返回的类型，还讨论可能发生的失败。现在我们要引入的第一个核心概念是发布者。 当其被订阅之后，根据请求会提供数据， 没有任何订阅请求的发布者不会提供任何数据。 当你表达一个 Combine 的发布者时，应该用两种相关的类型来描述它：一种用于输出，一种用于失败。这些通常使用泛型语法编写，该语法在描述类型的文本周围使用&amp;lt; 和 &amp;gt; 符号。这表示我们正在谈论这种类型的值的通用实例。例如，如果发布者返回了一个 String 类型的实例，并且可能以 URLError 实例的形式返回失败，那么发布者可能会用 &amp;lt;String, URLError&amp;gt; 来描述。与发布者匹配的对应概念是订阅者，是第二个要介绍的核心概念。订阅者负责请求数据并接受发布者提供的数据（和可能的失败）。 订阅者同样被描述为两种关联类型，一种用于输入，一种用于失败。 订阅者发起数据请求，并控制它接收的数据量。 它可以被认为是在 Combine 中起“驱动作用”的，因为如果没有订阅者，其他组件将保持闲置状态，没有数据会流动起来。发布者和订阅者是相互连接的，它们构成了 Combine 的核心。 当你将订阅者连接到发布者时，两种类型都必须匹配：发布者的输出和订阅者的输入以及它们的失败类型。 将其可视化的一种方法是对两种类型进行一系列并行操作，其中两种类型都需要匹配才能将组件插入在一起。第三个核心概念是操作符——一个既像订阅者又像发布者的对象。操作符是同时实现了订阅者协议和发布者协议的类。 它们支持订阅发布者，并将结果发送给任何订阅者。你可以用这些创建成链，用于处理和转换发布者提供的数据和订阅者请求的数据。我称这些组合序列为管道。操作符可用于转换值或类型 - 输出和失败类型都可以。 操作符还可以拆分或复制流，或将流合并在一起。 操作符必须始终按输出/失败这样的类型组合对齐。 编译器将强制执行匹配类型，因此错误将导致编译器错误（如果幸运的话，会有一个有用的 fixit 片段建议给你解决方案）。用 swift 编写的简单的 Combine 管道如下所示：let _ = Just(5) (1) .map { value -&amp;gt; String in (2) // do something with the incoming value here // and return a string return &quot;a string&quot; } .sink { receivedValue in (3) // sink is the subscriber and terminates the pipeline print(&quot;The end result was \\(receivedValue)&quot;) } 管道从发布者 Just 开始，它用它定义的值（在本例中为整数 5）进行响应。输出类型为 &amp;lt;Integer&amp;gt;，失败类型为 &amp;lt;Never&amp;gt;。 然后管道有一个 map 操作符，它在转换值及其类型。 在此示例中，它忽略了发布者发出的输入并返回了一个字符串。 这也将输出类型转换为 &amp;lt;String&amp;gt;，并将失败类型仍然保持为 &amp;lt;Never&amp;gt;。 然后管道以 sink 订阅者结束。当你去尝试理解管道时，你可以将其视为由输出和失败类型链接的一系列操作。 当你开始构建自己的管道时，这种模式就会派上用场。 创建管道时，你可以选择操作符来帮助你转换数据、类型或两者同时使用以实现最终目的。 最终目标可能是启用或禁用用户界面的某个元素，或者可能是得到某些数据用来显示。 许多 Combine 的操作符专门设计用来做这些转换。有许多操作符是以 try 为前缀的，这表示它们返回一个 &amp;lt;Error&amp;gt; 的失败类型。 例如 map 和 tryMap。 map 操作符可以转换输出和失败类型的任意组合。 tryMap 接受任何输入和失败类型，并允许输出任何类型，但始终会输出 &amp;lt;Error&amp;gt; 的失败类型。像 map 这样的操作符，你在定义返回的输出类型时，允许你通过基于你在提供给操作符的闭包中返回的内容推断输出类型。 在上面的例子中，map 操作符返回一个 String 的输出类型，因为这正是闭包返回的类型。为了更具体地说明更改类型的示例，我们扩展了值在传输过程中的转换逻辑。此示例仍然以提供类型 &amp;lt;Int, Never&amp;gt; 的发布者开始，并以订阅类型为 &amp;lt;String, Never&amp;gt; 的值结束。SwiftUI-NotesTests/CombinePatternTests.swiftlet _ = Just(5) &amp;lt;1&amp;gt; .map { value -&amp;gt; String in &amp;lt;2&amp;gt; switch value { case _ where value &amp;lt; 1: return &quot;none&quot; case _ where value == 1: return &quot;one&quot; case _ where value == 2: return &quot;couple&quot; case _ where value == 3: return &quot;few&quot; case _ where value &amp;gt; 8: return &quot;many&quot; default: return &quot;some&quot; } } .sink { receivedValue in &amp;lt;3&amp;gt; print(&quot;The end result was \\(receivedValue)&quot;) } Just 是创建一个 &amp;lt;Int, Never&amp;gt; 类型组合的发布者，提供单个值然后完成。 提供给 .map() 函数的闭包接受一个 &amp;lt;Int&amp;gt; 并将其转换为一个 &amp;lt;String&amp;gt;。由于 &amp;lt;Never&amp;gt; 的失败类型没有被改变，所以就直接输出了。 sink 作为订阅者，接受 &amp;lt;String, Never&amp;gt; 类型的组合数据。 当你在 Xcode 中创建管道，类型不匹配时，Xcode 中的错误消息可能包含一个有用的修复建议 fixit。 在某些情况下，例如上个例子，当提供给 map 的闭包中不指定特定的返回类型时，编译器就无法推断其返回值类型。 Xcode (11 beta 2 and beta 3) 显示此为错误消息： Unable to infer complex closure return type; add explicit type to disambiguate。 在上面示例中，我们用 value → String in 明确指定了返回的类型。你可以将 Combine 的发布者、操作符和订阅者视为具有两种需要对齐的平行类型 —— 一种用于成功的有用值，另一种用于错误处理。 设计管道时经常会选择如何转换其中一种或两种类型以及与之相关的数据。发布者和订阅者的生命周期订阅者和发布者以明确定义的顺序进行通信，因此使得它们具有从开始到结束的生命周期：一个 Combine 管道的生命周期 当调用 .subscribe(_: Subscriber) 时，订阅者被连接到了发布者。 发布者随后调用 receive(subscription: Subscription) 来确认该订阅。 在订阅被确认后，订阅者请求值 N，此时调用 request(_: Demand)。 发布者可能随后（当它有值时）发送 N 或者更少的值，通过调用 receive(_: Input)。 发布者不会发送超过需求量的值。 订阅确认后的任何时间，订阅者都可能调用 .cancel() 来发送 cancellation 发布者可以选择性地发送 completion：receive(completion:)。 完成可以是正常终止，也可以是通过 .failure 完成，可选地传递一个错误类型。 已取消的管道不会发送任何完成事件。在上述图表中包含了一组堆积起来的弹珠图， 这是为了突出 Combine 的弹珠图在管道的整体生命周期中的重点。 通常，图表推断所有的连接配置都已完成并已发送了数据请求。 Combine 的弹珠图的核心是从请求数据到触发任何完成或取消之间的一系列事件。发布者发布者是数据的提供者。 当订阅者请求数据时， publisher protocol 有严格的返回值类型约定，并有一系列明确的完成信号可能会终止它。你可以从 Just 和 Future 开始使用发布者，它们分别作为单一数据源和异步函数来使用。当订阅者发出请求时，许多发布者会立即提供数据。 在某些情况下，发布者可能有一个单独的机制，使其能够在订阅后返回数据。 这是由协议 ConnectablePublisher 来约定实现的。 遵循 ConnectablePublisher 的发布者将有一个额外的机制，在订阅者发出请求后才启动数据流。 这可能是对发布者单独的调用 .connect() 来完成。 另一种可能是 .autoconnect()，一旦订阅者请求，它将立即启动数据流。Combine 提供了一些额外的便捷的发布者： Convenience publishers     Just Future Deferred Empty Sequence Fail Record Share Multicast ObservableObject @Published   Combine 之外的一些苹果的 API 也提供发布者。 SwiftUI 使用 @Published 和 @ObservedObject 属性包装，由 Combine 提供，含蓄地创建了一个发布者，用来支持它的声明式 UI 的机制。 Foundation URLSession.dataTaskPublisher .publisher on KVO instance NotificationCenter Timer Result 操作符操作符是苹果参考文档中包含的一些预构建功能的便捷名称。 操作符用来组合成管道。 许多操作符会接受开发人员的一个或多个闭包，以定义业务逻辑，同时保持并持有发布者/订阅者的生命周期。一些操作符支持合并来自不同管道的输出、更改数据的时序或过滤所提供的数据。 操作符可能还会对操作类型有限制， 还可用于定义错误处理和重试逻辑、缓冲和预先载入以及支持调试。 Mapping elements     scan tryScan setFailureType map tryMap flatMap Filtering elements     compactMap tryCompactMap replaceEmpty filter tryFilter replaceError removeDuplicates tryRemoveDuplicates   Reducing elements     collect reduce tryReduce ignoreOutput     Mathematic operations on elements     max tryMax count min tryMin   Applying matching criteria to elements     allSatisfy tryAllSatisfy contains containsWhere tryContainsWhere   Applying sequence operations to elements     firstWhere tryFirstWhere first lastWhere tryLastWhere last dropWhile tryDropWhile dropUntilOutput prepend drop prefixUntilOutput prefixWhile tryPrefixWhile output Combining elements from multiple publishers     combineLatest merge zip Handling errors     catch tryCatch assertNoFailure retry mapError   Adapting publisher types     switchToLatest eraseToAnyPublisher   Controlling timing     debounce delay measureInterval throttle timeout   Encoding and decoding     encode decode   Working with multiple subscribers     multicast     Debugging     breakpoint handleEvents print SubjectsSubjects 是一种遵循 Subject 协议的特殊的发布者。 这个协议要求 subjects 有一个 .send(_:) 方法，来允许开发者发送特定的值给订阅者或管道。Subjects 可以通过调用 .send(_:) 方法来将值“注入”到流中， 这对于将现有的命令式的代码与 Combine 集成非常有用。一个 subject 还可以向多个订阅者广播消息。 如果多个订阅者连接到一个 subject，它将在调用 send(_:) 时向多个订阅者发送值。 一个 subject 还经常用于连接或串联多个管道，特别是同时给多个管道发送值时。Subject 不会盲目地传递其订阅者的需求。 相反，它为需求提供了一个聚合点。 在没有收到订阅消息之前，一个 subject 不会向其连接的发布者发出需求信号。 当它收到订阅者的需求时，它会向它连接的发布者发出 unlimited 需求信号。 虽然 subject 支持多个订阅者，但任何未请求数据的订阅者，在请求之前均不会给它们提供数据。Combine 中有两种内建的 subject : CurrentValueSubject 和 PassthroughSubject。 它们的行为类似，但不同的是 CurrentValueSubject 需要一个初始值并记住它当前的值，PassthroughSubject 则不会。 当调用 .send() 时，两者都将向它们的订阅者提供更新的值。在给遵循 ObservableObject 协议的对象创建发布者时，CurrentValueSubject 和 PassthroughSubject 也很有用。 SwiftUI 中的多个声明式组件都遵循这个协议。订阅者虽然 Subscriber 是用于接收整个管道数据的协议，但通常 the subscriber 指的是管道的末端。Combine 中有两个内建的订阅者： Assign 和 Sink。 SwiftUI 中有一个订阅者： onReceive。订阅者支持取消操作，取消时将终止订阅关系以及所有流完成之前，由发布者发送的数据。 Assign 和 Sink 都遵循 Cancellable 协议.当你存储和自己订阅者的引用以便稍后清理时，你通常希望引用销毁时能自己取消订阅。 AnyCancellable 提供类型擦除的引用，可以将任何订阅者转换为 AnyCancellable 类型，允许在该引用上使用 .cancel()，但无法访问订阅者本身（对于实例来说可以，但是需要更多数据）。 存储对订阅者的引用非常重要，因为当引用被释放销毁时，它将隐含地取消其操作。Assign 将从发布者传下来的值应用到由 keypath 定义的对象， keypath 在创建管道时被设置。 一个在 Swift 中这样的例子：.assign(to: \\.isEnabled, on: signupButton)Sink 接受一个闭包，该闭包接收从发布者发送的任何结果值。 这允许开发人员使用自己的代码终止管道。 此订阅者在编写单元测试以验证发布者或管道时也非常有帮助。 一个在 Swift 中这样的例子：.sink { receivedValue in print(&quot;The end result was \\(String(describing: receivedValue))&quot;)}其他订阅者是其他 Apple 框架的一部分。 例如，SwiftUI 中的几乎每个 control 都可以充当订阅者。 SwiftUI 中的 View 协议 定义了一个 .onReceive(publisher) 函数，可以把视图当作订阅者使用。 onReceive 函数接受一个类似于 sink 接受的闭包，可以操纵 SwiftUI 中的 @State 或 @Bindings。一个在 SwiftUI 中这样的例子：struct MyView : View { @State private var currentStatusValue = &quot;ok&quot; var body: some View { Text(&quot;Current status: \\(currentStatusValue)&quot;) .onReceive(MyPublisher.currentStatusPublisher) { newStatus in self.currentStatusValue = newStatus } }}对于任何类型的 UI 对象 (UIKit、AppKit 或者 SwiftUI)， Assign 可以在管道中使用来更新其属性。参考 Combine: Asynchronous Programming with Swift Using Combine " }, { "title": "读《大话数据结构》", "url": "/posts/book-play-with-data-structure/", "categories": "读书", "tags": "books", "date": "2021-04-25 20:00:00 +0800", "snippet": "最近看了《大话数据结构》 这本书，补了补自己在这方面知识不够系统的欠缺，里面的概念还是挺多的。我尝试着以思维导图加说明的方式，来梳理一遍我所掌握的各种数据结构，希望能给大家带来一个更直观的认识。数据结构是相互之间存在一种或多种特定关系的数据元素的集合，它是一门研究非数值计算的程序设计问题中的操作对象，以及它们之间的关系和操作等相关问题的学科。算法 算法是解决特定问题求解步骤的描述，在计算机中表现为指令的有限序列，并且每条指令表示一个或多个操作。为什么要在数据结构中提算法呢，因为 程序设计 = 数据结构 + 算法，它俩是不能割裂的。之所以要设计不同的数据结构，是因为各个数据结构在解决不同的问题时，有各自的优缺点，而通过算法能更科学的反应它们的优缺点。这里先简单给出一些必要的算法概念，更详细的算法部分，建议大家找算法书籍再去阅读。算法的特性输入输出、有穷性、确定性、可行性算法设计的要求正确性、可读性、健壮性、时间效率高和存储量低其中正确性中有提到四个层次，我们除了需要处理正确路径外，尤其要注意的是 算法程序对于非法的输入数据能够得出满足规格说明的结果 算法程序对于精心选择的，甚至刁难的测试数据都有满足要求的输出结果。算法时间复杂度 O(n)首先根据算法，推导出其命令的执行次数 T(n) 和问题规模 n 的对应关系函数 f(n)，然后对 f(n) 进行下列处理： 用常数 1 取代运行实践中的所有加法常数； 在修改后的运行次数函数中，只保留最高阶项； 如果最高阶项存在且不是 1，则去除与这个项相乘的常数。得到的结果即是算法的时间复杂度 O(n)。大家结合下面的例子，可以更好的理解：线性表 线性表是零个或多个数据元素的有限序列。栈 栈是限定仅在表尾进行插入和删除操作的线性表。后进先出（Last In First Out）是栈最主要的特点。队列 队列是只允许在一端进行插入操作，而在另一端进行删除操作的线性表。先进先出（First In First Out）是队列的特点。串 串是由零个或多个字符组成的有限序列，又名字符串。串本质上是一种线性表的扩展。树 树是 n (n&amp;gt;=0) 个结点的有限集。 n = 0 时称为空树。 在任意一颗非空树中：1. 有且仅有一个特定的称为根的结点；2. 当 n &amp;gt; 1 时，其余结点可分为 m (m &amp;gt; 0) 个互不相交的有限集，其中每一个集合本身又是一棵树，并且称为根的子树。树的概念和术语比较多，其中比较重要的是二叉树的遍历。遍历二叉树前序遍历 对于非空二叉树，先访问根结点，然后前序遍历左子树，再前序遍历右子树。中序遍历 对于非空二叉树，从根结点开始（并不是先访问根结点），中序遍历根结点的左子树，然后是访问根结点，最后中序遍历右子树。后序遍历 对于非空二叉树，从左到右先叶子后结点的方式遍历访问左右子树，最后是访问根结点。层序遍历 对于非空二叉树，从树的第一层（也就是根结点）开始访问，从上而下逐层遍历，在同一层中，按从左到右的顺序对结点逐个访问。图 图是由顶点的有穷非空集合和顶点之间边的集合组成，通常表示为：G(V,E)，其中 G 表示一个图，V 是图 G 中顶点的集合，E 是图 G 中边的集合。图的深度优先遍历类似于树的前序遍历，广度优先遍历类似于树的层序遍历。两种遍历在时间复杂度上是一样的，所以它们在全图遍历上没有优劣之分，深度优先更适合目标比较明确，以找到目标为主要目的的情况，而广度优先更适合在不断扩大遍历范围时找到相对最优解的情况。算法图解了解了数据结构，就能更好的学习和理解各种算法，等看完《算法图解》一书之后，再写一篇读书笔记加以总结。" }, { "title": "读《程序员的职业素养》：The Clean Coder", "url": "/posts/book-the-clean-coder/", "categories": "读书", "tags": "books", "date": "2021-03-24 20:00:00 +0800", "snippet": "这几天看了《The Clean Coder》：A code of Conduct for Professional Programmers 这本书，是《Clean Code》这本书的作者所著，有一些自己认为颇为受益的点，这里分享给大家。每个专业软件开发人员必须精通的事项 设计模式。必须能描述 GOF 书中的全部 24 种模式，同时还要有 POSA 书中的多数模式的实战经验。 设计原则。必须了解 SOLID 原则，而且要深刻理解组件设计原则。 方法。必须理解 XP、Scrum、精益、看板、瀑布、结构化分析及结构化设计等。 实践。必须掌握测试驱动开发、面向对象设计、结构化编程、持续集成和结对编程。 工具。必须了解如何使用 UML 图、DFD 图、结构图、Petri 网络图、状态迁移图表、流程图和决策表。拒绝和承诺 能就是能，不能就是不能，不要说“试试看”。作为软件开发人员，我们经常会面对的情况就是对需求进行评估并估算时间，在这个过程中想必大家都会相对谨慎的进行考虑，并给自己留出一点浮动时间，最终产出一份开发计划，到这里问题并不大。下面来具体到其中的某一个任务上： 如果产品经理想要增加一点额外工作而不改变交付时间，哪怕他坚持说只是增加一个文本框这样的简单功能，那么我们改怎么办呢？ 一口答应下来那绝对是愚蠢的，是极其不专业的行为，因为增加工作量一定会需要更多的时间，将会打乱原来的计划，给项目的按时交付带来风险； 或者可能会说那我试试看吧，这就意味着你承认自己之前未尽全力，现在还有余力可施； 或者想着我可以少写点测试，或者加加班，大量的经验告诉我们，牺牲专业原则以求全，并非问题的解决之道，舍弃这些原则，只会制造出更多的麻烦。 作为专业的开发人员，不应该屈从于权势，应当有勇气说“不”，只有会说“不”字的专业人员，他作出的承诺才更有价值。 那么这里应该怎么做呢？重新评估开发时间，让产品经理能够根据新的开发时间去安排计划，早做打算。 另外一种情况是，我们已经承诺了这项任务会在5天内完成，可是在第2天遇到了意料之外的坑，这时应该怎么办呢？ 硬着头皮做下去，希望事情会有转机，这无异于在给项目增加风险，因为预估的时间并不包含处理某个坑，寄希望于某种运气并不靠谱； 或者想着我可以少写点测试，或者加加班，这和上面的情况一样。 如果你无法兑现承诺，那么最重要的就是尽早向你的承诺对象发出预警，越快越好，越早越好，让别人调整对你的预期，这样他们也好重新尽早改变计划。这里我们不妨想象一下，自己是铁路工人，承诺2个月内能把铁路修好，计划第3个月的第1天火车就会开过来，如果自己意识到了延期风险，却到了最后关头才告诉大家，这时就面临着大量乘客退票投诉风险，如果及早通知，那么工作人员就可以延迟开放购票，乘客们也会相应的尽早改变自己的计划。 结对编程程序员编程时的状态，对于代码质量的影响是巨大的。书中列举了焦虑时、听音乐、时常被中断、完全没思路的阻塞状态等，都是不利于产出高质量代码的，还有一种状态：流态。 这是程序员在编写代码时会进入的一种意识高度专注但思维视野却会收拢到狭窄的状态，在这种状态下，他们会感到效率极高，在这种状态中，他们会感到绝无错误。因此他们一直苦苦追求进入这种状态，并经常以能在那种状态下维持多久来衡量自我价值。之前虽不知道这个名词，但是我自己确实会经常有这种状态，在这种状态中会感觉一切代码逻辑都了如于心，输出效率非常之高，能够“自信”到一次编写完所有代码再运行，并确信绝无错误。书中提到流态也并非一种完美的状态，这其实只是一种“浅层冥想”状态，在这种状态下，为了追求所谓的速度，理性思考的能力会下降，其实放弃了顾全全局，因此我们也要去避免进入流态。那么怎么样能够保证编程时的状态呢？结对编程！结对编程时，任一方都不可能进入流态，并且如果遇到一方被中断的情况，那么另一方很容易将当时的上下文维护起来，并在你回来之后帮你恢复状态。如果你状态不好，没有思路或者理不清头绪，那么找一个搭档来结对吧，你们想法的碰撞，会让你渐入佳境，创造出好的代码来。TDDTDD在早期刚被提出时，还颇具争议，但是到现在，TDD的可行性和好处，已无可争议。上面提到了如果你写代码时经常被打断，那么TDD也是一个很好的维护上下文状态的办法，当你回来继续编码时，看到尚未通过的测试，就知道自己该干什么了。为什么要先写测试再写实现呢？事后写的测试只是一种防守，而先行编写的测试则是进攻，它会迫使你去考虑什么是好的设计，因为坏的高耦合的代码，是很难被测试的。关于TDD的好处，这里就不详述了，网上有很多这样的文章，这里重点写一下TDD的三项法则： 在编好失败单元测试之前，不要编写任何产品代码； 只要有一个单元测试失败了，就不要再写测试代码，无法通过编译也是一种失败情况； 产品代码恰好能够让当前失败的单元测试成功通过即可，不要多写。测试验收测试在开发中，各方（开发方、业务方、测试方）想要真正对需求理解一致，最终实现出来业务方想要的功能，真的非常困难，因此专业开发人员既要做好开发，也要做好沟通。这里非常有用的方法是编写验收测试，确保在开发之前大家对验收测试达成共识，这其实就是我们在敏捷实践中所做的 Kick off，在开发之前明确开发 Scope，细化需求，这样才能确定需求何时算完成，QA 才能在测试的时候更加明确。我们一般使用的验收测试编写模版是 Given, When, Then, 例如：Given: 根目录不存在文件夹 logsWhen: 点击新建文件夹按钮Then: 会在根目录创建一个空的名为 logs 的文件夹单元测试是程序员写给程序员的，而验收测试则是写给业务方的，由业务方测试 “正确路径”，QA 测试 “错误路径”，边界条件、异常、例外情况。测试策略单元测试单元测试通常由程序员使用与系统开发相同的语言编写，目的是在最底层去定义系统，确保程序员的代码意图被正确实现且没有随着代码的改动被破坏。组件测试组件测试是对组件封装的业务规则进行测试，一般是向组件中传入数据，然后收集输出数据。其中需要使用合适的 Mocking 等辅助技术，与系统其它组件解耦。组件测试主要测的是成功路径的情况，大多数异常由单元测试来覆盖。集成测试集成测试只对那些组件很多的较大系统才有意义，测试的是组件之间能够正常通信，它们并不会测试业务规则，因此它们其实是装配测试。系统测试系统测试是针对整个集成完毕的系统来进行的自动化测试，是最终的集成测试，应该包含吞吐率测试和性能测试，其目的不是要确保正确的系统行为，而是要确保正确的系统构造。人工探索式测试此类测试是要在验证预期行为的时候，探索系统预期之外的行为。探索型测试不是要证明每条业务规则、每条运行路径都正确，而是要确保系统在人工操作下表现良好，同时富有创造性地找出尽可能多的古怪之处。预估关于预估，不同的人对其有不同的看法，业务方觉得预估就是承诺，开发方认为预估就是猜测，两者相差迥异。当我们开发不能百分百有把握时，就不要作出承诺。预估其实是一种类似于正态分布的概率分布，并不是个定数。我们预估的往往是那个均值，而乐观估计的最小时长和悲观估计的最大时长，也都是有可能发生的。书中提到了几种方法，这里介绍其中的两种：PERT全称是 Program Evaluation and Review Technique, 该方法比较适用于单人预估，对某项任务，会有三个预估数字： O：乐观估计 N：标称估计 P：悲观估计乐观估计和悲观估计都是最极端的情况，为了保证它们是有意义的，这个数字对应的发生概率都应该小于1%。得到三个数字之后，就可以计算出该项任务的期望完成时间了：( O + 4N + P ) / 6　标准差为：( P - O ) / 6比如一项任务的 O = 1, N = 3, P = 12, 那么大概完成时间需要 4.2 天，标准差大概是 1.8 天。标准差越大说明不确定性越大。亮手指该方法适合多人合作，一起估算时。大家围坐在桌旁，每次讨论一项任务，针对每项任务，都必须讨论清楚这个任务涉及什么，有哪些不确定因素，该怎么实现，然后主持人喊到 3，大家一起伸出1～5个手指，代表预估点数，这个点数具体对应到几天，可以事先商定好。如果大家的预估很相似，那么可以按多数人的意见来；如果有人的预估和大家想差较大，那么可能是他考虑到了大家没考虑到的，或者有其他因素，这时一定要讨论清楚，然后重新预估，最终达成一致。这个方法最大的好处就是，别人可以看到你自己看不到的东西，大家聚在一起，就可以把问题看的更全面，使预估更精确。在预估时，一定要把任务尽可能的拆分成小任务，这样不仅更利于理解任务，而且某一两个小任务的预估错误，相对所有任务来讲，不会对总的结果产生明显影响。其他点书中还提到了什么才是“专业”，专业人员需要不断练习，应该如何管理自己的时间，怎么避免和应对压力，怎么和他人更好的协作，怎么给团队调配项目，以及专业人员的理想成长过程等，如果大家感兴趣的话，可以翻看书籍。" }, { "title": "iOS 动态库 Dynamic library", "url": "/posts/ios-dynamic-library/", "categories": "iOS", "tags": "library", "date": "2021-01-26 20:00:00 +0800", "snippet": "动态库可以在 app launch time 或者 runtime 被加载，也就是说代码可以只在需要的时候被加载，这就减少了可执行文件的大小和 App 启动时的内存消耗。App 的功能本质是通过可执行代码来实现的，在使用静态库时，代码是被全部复制到了生成的可执行代码中去，并且在 App 启动的时候，一次性全部加载到内存中去，因此会使得文件变大，也更消耗内存。下图展示了静态库是如何被链接到 App 的：相比之下，动态库只加载了对其的引用而非库本身： 区别   动态库可以在运行时再加载 静态库不可以 动态库更新时 App 不必升级也能使用最新的功能 使用静态库的话 App 必须升级 动态库可以在加载时初始化，在 App 终止前做一些 clean-up 的工作 静态库不可以 动态库在更新时必须保证向下兼容性 静态库不需要 动态库是怎么被加载的在 App 启动时，系统会把代码和数据加载到一个新进程的地址空间中，同时也会把动态加载器 ( /usr/lib/dyld ) 加载到进程中。App 记录每个动态库的文件名，动态加载器会在需要的时候根据文件名加载动态库。动态库会被分成必备的和可选的，如果必备的动态库在初始化的时候加载失败了，dyld 将会杀死进程，终止程序的运行；如果可选库加载失败了，程序会继续运行，只是不会执行到相应库的代码。其实大家在开发中进行 iOS 版本判断，进而选择性的使用某些新的框架（比如 Combine, SwiftUI）时，就是加载了可选库。下面用例子详细看一下：新建一个工程，添加一个必备库和一个可选库：编译一下工程，然后在 Products 下面找到编译好的 .app 包，右键选择 Show Package Contents，找到可执行文件。下一步我们使用 otool 来查看包引用的动态库：➜ ~ otool -L /Users/**/Debug-iphonesimulator/Demo-Framework.app/Demo-Framework/Users/**/Debug-iphonesimulator/Demo-Framework.app/Demo-Framework: /System/Library/Frameworks/CoreLocation.framework/CoreLocation (compatibility version 1.0.0, current version 2420.12.14) /System/Library/Frameworks/CallKit.framework/CallKit (compatibility version 1.0.0, current version 1.0.0, weak) /System/Library/Frameworks/Foundation.framework/Foundation (compatibility version 300.0.0, current version 1770.255.0) /usr/lib/libobjc.A.dylib (compatibility version 1.0.0, current version 228.0.0) /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1292.60.1) /System/Library/Frameworks/UIKit.framework/UIKit (compatibility version 1.0.0, current version 4003.1.101) /usr/lib/swift/libswiftCore.dylib (compatibility version 1.0.0, current version 1200.2.41) /usr/lib/swift/libswiftCoreFoundation.dylib (compatibility version 1.0.0, current version 1.6.0, weak) /usr/lib/swift/libswiftCoreGraphics.dylib (compatibility version 1.0.0, current version 2.0.0, weak) /usr/lib/swift/libswiftCoreImage.dylib (compatibility version 1.0.0, current version 1.0.0, weak) /usr/lib/swift/libswiftCoreLocation.dylib (compatibility version 1.0.0, current version 5.0.0, weak) /usr/lib/swift/libswiftDarwin.dylib (compatibility version 1.0.0, current version 0.0.0, weak) /usr/lib/swift/libswiftDispatch.dylib (compatibility version 1.0.0, current version 4.40.2, weak) /usr/lib/swift/libswiftFoundation.dylib (compatibility version 1.0.0, current version 20.0.0) /usr/lib/swift/libswiftMapKit.dylib (compatibility version 1.0.0, current version 2.0.0, weak) /usr/lib/swift/libswiftMetal.dylib (compatibility version 1.0.0, current version 1.3.1, weak) /usr/lib/swift/libswiftObjectiveC.dylib (compatibility version 1.0.0, current version 1.0.0) /usr/lib/swift/libswiftQuartzCore.dylib (compatibility version 1.0.0, current version 1.0.0, weak) /usr/lib/swift/libswiftUIKit.dylib (compatibility version 1.0.0, current version 19.0.0)从上面能够发现，Foundation UIKit 等系统必备的库已经自动引用了，我们自己添加的 CoreLocation CallKit 也被引用了，不同的是 CallKit 后面有一个 weak ，表明是可选库。系统库是被所有应用所共用的，在 App 运行时动态加载。CocoaPods 引入的动态库和静态库首先怎么看一个库是静态库还是动态库呢，后缀为 .a 的是静态库，.dylib 是动态库，.framework 可以是动态库也可以是静态库，可以通过 file 命令查看可执行文件获取信息：➜ GoogleMaps.framework git:(main) ✗ cd /Users/zhiying.fan/Library/Developer/Xcode/DerivedData/Demo-Framework-cqyqoilkxvbzuwcjdiccbzbutijf/Build/Products/Debug-iphonesimulator/Demo-Framework.app/Frameworks/Alamofire.framework➜ Alamofire.framework file AlamofireAlamofire: Mach-O 64-bit dynamically linked shared library x86_64➜ Alamofire.framework cd /Users/zhiying.fan/Desktop/repos/demos/Demo-Framework/Pods/GoogleMaps/Maps/Frameworks/GoogleMaps.framework➜ GoogleMaps.framework git:(main) ✗ file GoogleMapsGoogleMaps: Mach-O universal binary with 4 architectures: [arm_v7:Mach-O object arm_v7] [i386] [x86_64] [arm64]GoogleMaps (for architecture armv7): Mach-O object arm_v7GoogleMaps (for architecture i386): Mach-O object i386GoogleMaps (for architecture x86_64): Mach-O 64-bit object x86_64GoogleMaps (for architecture arm64): Mach-O 64-bit object arm64 动态库会显示 dynamically linked shared library 静态库则会显示是基于什么架构生成的下面看一下使用 CocoaPods 引入动态库和静态库有什么区别：作为例子，引入 Alamofire （动态库）和 GoogleMaps （静态库），编译之后来看一下包内容。然后再用命令看一下链接的动态库➜ ~ otool -L /Users/zhiying.fan/Library/Developer/Xcode/DerivedData/Demo-Framework-cqyqoilkxvbzuwcjdiccbzbutijf/Build/Products/Debug-iphonesimulator/Demo-Framework.app/Demo-Framework/Users/zhiying.fan/Library/Developer/Xcode/DerivedData/Demo-Framework-cqyqoilkxvbzuwcjdiccbzbutijf/Build/Products/Debug-iphonesimulator/Demo-Framework.app/Demo-Framework: /usr/lib/libc++.1.dylib (compatibility version 1.0.0, current version 904.4.0) /usr/lib/libz.1.dylib (compatibility version 1.0.0, current version 1.2.11) /System/Library/Frameworks/Accelerate.framework/Accelerate (compatibility version 1.0.0, current version 4.0.0) @rpath/Alamofire.framework/Alamofire (compatibility version 1.0.0, current version 1.0.0) /System/Library/Frameworks/CFNetwork.framework/CFNetwork (compatibility version 1.0.0, current version 1209.0.0) /System/Library/Frameworks/CoreData.framework/CoreData (compatibility version 1.0.0, current version 1044.3.0) /System/Library/Frameworks/CoreGraphics.framework/CoreGraphics (compatibility version 64.0.0, current version 1463.2.1) /System/Library/Frameworks/CoreImage.framework/CoreImage (compatibility version 1.0.0, current version 5.0.0) /System/Library/Frameworks/CoreLocation.framework/CoreLocation (compatibility version 1.0.0, current version 2420.12.14) /System/Library/Frameworks/CoreTelephony.framework/CoreTelephony (compatibility version 1.0.0, current version 0.0.0) /System/Library/Frameworks/CoreText.framework/CoreText (compatibility version 1.0.0, current version 1.0.0) /System/Library/Frameworks/GLKit.framework/GLKit (compatibility version 1.0.0, current version 124.0.0) /System/Library/Frameworks/ImageIO.framework/ImageIO (compatibility version 1.0.0, current version 1.0.0) /System/Library/Frameworks/Metal.framework/Metal (compatibility version 1.0.0, current version 244.40.1) /System/Library/Frameworks/OpenGLES.framework/OpenGLES (compatibility version 1.0.0, current version 1.0.0) /System/Library/Frameworks/QuartzCore.framework/QuartzCore (compatibility version 1.2.0, current version 1.11.0) /System/Library/Frameworks/SystemConfiguration.framework/SystemConfiguration (compatibility version 1.0.0, current version 1109.60.2) /System/Library/Frameworks/UIKit.framework/UIKit (compatibility version 1.0.0, current version 4003.1.101) /System/Library/Frameworks/CallKit.framework/CallKit (compatibility version 1.0.0, current version 1.0.0, weak) /System/Library/Frameworks/Foundation.framework/Foundation (compatibility version 300.0.0, current version 1770.255.0) /usr/lib/libobjc.A.dylib (compatibility version 1.0.0, current version 228.0.0) /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1292.60.1) /System/Library/Frameworks/CoreFoundation.framework/CoreFoundation (compatibility version 150.0.0, current version 1770.255.0) /System/Library/Frameworks/Security.framework/Security (compatibility version 1.0.0, current version 59754.62.1) /usr/lib/libc++abi.dylib (compatibility version 1.0.0, current version 904.4.0) /usr/lib/swift/libswiftCore.dylib (compatibility version 1.0.0, current version 1200.2.41) /usr/lib/swift/libswiftCoreFoundation.dylib (compatibility version 1.0.0, current version 1.6.0, weak) /usr/lib/swift/libswiftCoreGraphics.dylib (compatibility version 1.0.0, current version 2.0.0, weak) /usr/lib/swift/libswiftCoreImage.dylib (compatibility version 1.0.0, current version 1.0.0, weak) /usr/lib/swift/libswiftCoreLocation.dylib (compatibility version 1.0.0, current version 5.0.0, weak) /usr/lib/swift/libswiftDarwin.dylib (compatibility version 1.0.0, current version 0.0.0, weak) /usr/lib/swift/libswiftDispatch.dylib (compatibility version 1.0.0, current version 4.40.2, weak) /usr/lib/swift/libswiftFoundation.dylib (compatibility version 1.0.0, current version 20.0.0) /usr/lib/swift/libswiftMapKit.dylib (compatibility version 1.0.0, current version 2.0.0, weak) /usr/lib/swift/libswiftMetal.dylib (compatibility version 1.0.0, current version 1.3.1, weak) /usr/lib/swift/libswiftObjectiveC.dylib (compatibility version 1.0.0, current version 1.0.0) /usr/lib/swift/libswiftQuartzCore.dylib (compatibility version 1.0.0, current version 1.0.0, weak) /usr/lib/swift/libswiftUIKit.dylib (compatibility version 1.0.0, current version 19.0.0)从包内容可以发现，Alamofire 被放在了 Frameworks 文件夹下，动态库加载器会从 @rpath/Alamofire.framework/Alamofire 去链接它。@rpath 代表的是已经被嵌入到应用程序的本地列表。而对于静态库 GoogleMaps ，在包内容中只能看到它的资源文件 GoogleMaps.bundle ，在动态链接库中也看不到它。因为它是被拷贝到可执行文件中去了。在自己的库中引用动态库和静态库 参考 Using Pod Lib Create 创建自己的库 Maps 在自己的框架中引入 Alamofire 和 GoogleMaps 将新创建的框架引入到 Demo 工程中去 在上面三步做完并且执行 pod install 时，遇到了报错：➜ Demo-Framework git:(main) ✗ pod installAnalyzing dependenciesDownloading dependenciesInstalling Alamofire (5.4.1)Installing GoogleMaps (4.1.0)Installing Maps 0.1.0[!] The &#39;Pods-Demo-Framework&#39; target has transitive dependencies that include statically linked binaries: (/Users/zhiying.fan/Desktop/repos/demos/Demo-Framework/Pods/GoogleMaps/Base/Frameworks/GoogleMapsBase.framework, /Users/zhiying.fan/Desktop/repos/demos/Demo-Framework/Pods/GoogleMaps/Maps/Frameworks/GoogleMaps.framework, and /Users/zhiying.fan/Desktop/repos/demos/Demo-Framework/Pods/GoogleMaps/Maps/Frameworks/GoogleMapsCore.framework)因为我们引用的 GoogleMaps 是静态库，所以自己的库也必须是静态库，CocoaPods 指定静态库的语法为：spec.static_framework = true加上之后再执行 pod install ，然后去看动态库链接，会发现和之前直接在工程中引用并没有什么不同。静态库中的资源文件静态库在打包时，资源文件是不会被一起打包进去的，CocoaPods 会将包的资源文件拷贝到项目中去。CocoaPods 在对包的资源文件进行拷贝时，有两种选择可以配置：resources 和 resource_bundles resources: 把所有库的资源文件直接拷贝到项目中。 resource_bundles: 把所有资源文件放在一个 .bundle 的文件夹下，然后再拷贝到项目中，使用这种方式可以避免文件名冲突的问题。获取资源文件因为 resources 和 resource_bundles 对资源文件的不同处理方式，我们在获取这些资源的时候，也需要区别对待： var mapsResourceBundle: Bundle { let codeBundle = Bundle(for: MapView.self) guard let resourceBundlePath = codeBundle.path(forResource: &quot;Maps&quot;, ofType: &quot;bundle&quot;), let resourceBundle = Bundle(path: resourceBundlePath) else { return codeBundle } return resourceBundle } 如果使用的是 resources 方式进行资源文件的打包，那么用 codeBundle 就可以获取到 mainBundle，资源文件就直接放置在其中。 如果使用的是 resource_bundles 方式进行资源文件的打包，那么获取到 mainBundle 之后，还需要找到自己库的 bundle 文件，然后才能在其中找到想要的资源。Demo参考 Dynamic Library Programming Topics Dynamic Frameworks" }, { "title": "iOS 地图 MapKit - 搜索与路径", "url": "/posts/ios-map-advanced/", "categories": "iOS", "tags": "map", "date": "2020-12-25 20:00:00 +0800", "snippet": "使用地图来搜索感兴趣的地方，并且获取到达该地方的路径，想必是我们经常使用到的功能，那么在 MapKit 中如何实现呢，下面一起来看看吧。写下该文章的时候，计算路径的 API 在国内还是不可用的，具体的可用区域可以查看 iOS and iPadOS Feature Availability搜索MapKit 中实现搜索功能的类是 MKLocalSearch，主要有三个方法：// 初始化init(request: MKLocalSearch.Request)init(request: MKLocalPointsOfInterestRequest)// 开始搜索func start(completionHandler: @escaping MKLocalSearch.CompletionHandler)// 取消搜索func cancel()我们分别来看下初始化和搜索方法初始化初始化的时候传入 MKLocalSearch.Request，可以配置以下信息： 配置信息 说明 naturalLanguageQuery 搜索关键字 region 搜索区域 resultTypes 想要搜索的结果类型，可以选择 address , pointOfInterest pointOfInterestFilter POI的类型筛选，比如 airport , bank , cafe 等等 MKLocalPointsOfInterestRequest 是针对只搜索 POI 的情况，和 Request 比较类似。开始搜索初始化配置完成之后，就可以开始搜索了，搜索回调返回的是 MKLocalSearch.Response 或者 Error 。Response 中包含了结果数组 [MKMapItem] 和边界区域 MKCoordinateRegion ，我们就可以根据结果展示在地图上了。这里需要注意的是，如果是在搜索中，那么调用 start 方法将会返回失败信息，可以使用 isSearching 属性判断是否正在搜索中。搜索自动补全自动补全也是比较实用的功能，实现类是 MKLocalSearchCompleter配置信息和 MKLocalSearch.Request 非常类似，配置好之后，每次设置 queryFragment 值，都可以在 MKLocalSearchCompleterDelegate 中得到结果。func completerDidUpdateResults(_ completer: MKLocalSearchCompleter) { // results 中是 MKLocalSearchCompletion，只包含 title, subtitle 和相应的 Ranges 信息 results = completer.results.map { $0.title } tableView.reloadData()}有了自动补全的 title 之后，就可以调用前面介绍过的搜索方法，拿到具体的地理位置信息了。计算路径在搜索到我们感兴趣的地方之后，下一步就是计算到达路径了，用到的类是 MKDirections ，主要方法有：// 初始化init(request: MKDirections.Request)// 开始计算func calculate(completionHandler: @escaping MKDirections.DirectionsHandler)func calculateETA(completionHandler: @escaping MKDirections.ETAHandler)// 取消计算func cancel()还是分别来看下初始化和计算方法初始化初始化的时候传入 MKDirections.Request，可以配置以下信息： 配置信息 说明 source 出发地 destination 目的地 transportType 交通方式，可选的有 automobile , walking , transit , any 目前还没有 Cycling requestsAlternateRoutes 是否允许多条路径，默认为 false departureDate 出发时间 arrivalDate 到达时间 开始计算初始化配置完成之后，就可以开始计算路径了，回调返回的是 MKDirections.Response 或者 Error 。Response 中包含了结果数组 [MKRoute] 和起点终点信息，来看看 MKRoute 都包含了哪些信息： 字段 说明 name 路径名字 advisoryNotices 重要的公告，比如修路、封路等信息 distance 距离 expectedTravelTime 预计花费时间 transportType 交通方式 polyline 用来在地图上绘制路径信息 steps [MKRoute.Step] 详细的路径步骤，比如到路口左转 拿到以上信息，就可以根据需要展示给用户了，使用 polyline 绘制在地图上，或者用列表展示 steps 信息。如果只想要获取预计花费时间，那么使用 calculateETA 方法，将不包含 polyline , steps 等信息。这里需要注意的是，如果是在计算中，那么调用 calculate 方法将会返回失败信息，可以使用 isCalculating 属性判断是否正在计算中。地理编码地理编码即根据地址名获取经纬度等信息，反地理编码则反之，常用在获取到用户定位之后进行反地理编码。编码CLGeocoder().geocodeAddressString(&quot;故宫博物院&quot;, in: region, preferredLocale: locale) { (placemarks, error) in}反编码CLGeocoder().reverseGeocodeLocation(location, preferredLocale: locale) { (placemarks, error) in}参考 Routing With MapKit and Core Location" }, { "title": "iOS 地图 MapKit - 显示与交互", "url": "/posts/ios-map-basic/", "categories": "iOS", "tags": "map", "date": "2020-12-22 20:00:00 +0800", "snippet": "我们在使用地图服务时，需要结合 Core Location 和 MapKit 两个框架，Core Location 主要是提供用户当前的位置和方向等信息，MapKit 用来显示地图、标注点、路径等信息。可以把 MapKit 理解为 View 层用来展示 Core Location 获取到的数据。获取位置权限在使用位置服务前，首先需要获取权限，并在每次使用前都检查权限，因为用户可以自己在设置中开关权限。目前权限有 5 种状态，定位精度有两种状态：enum CLAuthorizationStatus { // 用户还未做出选择 case notDetermined = 0 // 受限制，可能是家长控制等 case restricted = 1 // 用户明确拒绝 case denied = 2 // 始终允许 case authorizedAlways = 3 // 只在使用App时允许 case authorizedWhenInUse = 4}enum CLAccuracyAuthorization : Int { // 精确定位 case fullAccuracy = 0 // 降低精准度，定位水平精度大概在5km case reducedAccuracy = 1}在 Info.plist 中添加描述根据自己的需求，在 Info.plist 中添加需要获取位置权限的描述，该描述会在请求权限时展示给用户。例如添加&amp;lt;key&amp;gt;NSLocationWhenInUseUsageDescription&amp;lt;/key&amp;gt;&amp;lt;string&amp;gt;我们会在导航时使用您的位置信息&amp;lt;/string&amp;gt;如果需要 AlwaysUsage 权限的话，还需要在 Target - Signing &amp;amp; Capabilities 中添加 Background Modes 并勾选 Location updates请求权限let locationManager = CLLocationManager()// 先检查权限if locationManager.authorizationStatus == .authorizedWhenInUse || locationManager.authorizationStatus ==.authorizedAlways { // 已经获取到权限} else { locationManager.requestWhenInUseAuthorization()}请求权限之后就会出现如下弹窗，用户可以选择是否允许以及定位精度地图配置显示定位蓝点显示用户定位点非常简单，设置 mapView.showsUserLocation = true ，然后开始获取位置更新就可以了：locationManager.startUpdatingLocation()切换地图图层目前有6种图层类型可供切换，只需要修改 mapType 就可以了mapView.mapType = .satellite调整 Logo 和 Legal 的位置目前 MapKit 还没有官方可用的 API 来调整 Logo 的位置，如果想要调整其位置，可以通过添加 Margins 的方式：mapView.layoutMargins = UIEdgeInsets(top: 0, left: 0, bottom: 48, right: 0)需要注意的是，需要遵守苹果官方的设计规范，即放在用户可见的地方，只可以暂时被遮挡。改变显示区域我们可以通过设置中心点以及离中心点的距离来改变地图显示的区域以及缩放级别，比如获取到用户的位置 location 之后，将地图以用户位置为中心点显示：let region = MKCoordinateRegion(center: location.coordinate, latitudinalMeters: 1000, longitudinalMeters: 1000)mapView.setRegion(region, animated: true)限制显示区域如果只在某些特定区域提供服务，想要局部限制用户拖动地图的行为，那么可以使用如下方法限制地图的区域，也可以限制缩放级别，个人感觉这个使用场景并不多。let center = CLLocation(latitude: 34.2596292, longitude: 108.6870159)let region = MKCoordinateRegion(center: center.coordinate, latitudinalMeters: 5_000_000,longitudinalMeters: 5_000_000)mapView.setCameraBoundary( MKMapView.CameraBoundary(coordinateRegion: region), animated: true)let zoomRange = MKMapView.CameraZoomRange(maxCenterCoordinateDistance: 1_000_000)mapView.setCameraZoomRange(zoomRange, animated: true)在地图上绘制绘制标记点绘制点标记调用的方法是 func addAnnotation(annotation: MKAnnotation)，这里需要添加的 MKAnnotation 是一个协议：public protocol MKAnnotation : NSObjectProtocol { var coordinate: CLLocationCoordinate2D { get } optional var title: String? { get } optional var subtitle: String? { get }}我们实现这个协议，提供必备的坐标点，然后就可以添加到地图上了。如果想要改变标记点的UI，那么可以实现 MKMapViewDelegate 中的方法，返回 MKAnnotationView 的子类或者自定义类继承于它。func mapView(_ mapView: MKMapView, viewFor annotation: MKAnnotation) -&amp;gt; MKAnnotationView? { if annotation is MallAnnotation { let mallIdentifier = &quot;MallIdentifier&quot; var annotationView = mapView.dequeueReusableAnnotationView(withIdentifier: mallIdentifier) as?MKMarkerAnnotationView if annotationView == nil { annotationView = MKMarkerAnnotationView(annotation: annotation, reuseIdentifier: mallIdentifier) annotationView?.glyphImage = UIImage(systemName: &quot;cart&quot;) } return annotationView } return nil}使用标记点簇如果有多个标记点出现在相近的地方，那么当用户缩小地图时就会出现大量标记点叠在一起的现象，并且如果有大量标记点，有可能会有性能问题，解决这个问题的好办法就是使用标记点簇，效果如下：需要添加如下设置：annotationView?.clusteringIdentifier = &quot;MallCluster&quot;Identifier 相同的标注点都会被自动的聚集在一起。自定义气泡如果想要自定义点击标注点弹出的气泡，可以将自定义的 View 设置给 AnnotationView，并设置 canShowCallout = true ，这里简单实现了显示副标题的气泡。annotationView?.canShowCallout = truelet label = UILabel()label.font = UIFont.systemFont(ofSize: 12)label.text = &quot;营业时间: \\(annotation.subtitle ?? &quot;暂无&quot;)&quot;annotationView?.detailCalloutAccessoryView = label绘制线在地图上绘制其他图形，使用的是 addOverlay(overlay: MKOverlay) 方法，如果需要绘制线，可以使用 MKPolyline ，它实现了 MKOverlay 协议。let polyline = MKPolyline(coordinates: viewModel.coordinates, count: viewModel.coordinates.count)mapView.addOverlay(polyline)和绘制标记点一样，还需要通过代理提供视图，告诉地图我们想要绘制的线长什么样子，MKPolyline 对应的 Renderer 是 MKPolylineRendererfunc mapView(_ mapView: MKMapView, rendererFor overlay: MKOverlay) -&amp;gt; MKOverlayRenderer { if let polyline = overlay as? MKPolyline { let polylineRenderer = MKPolylineRenderer(polyline: polyline) polylineRenderer.lineWidth = 5 polylineRenderer.strokeColor = .systemBlue return polylineRenderer } return MKOverlayRenderer()}绘制相关类的关系图在地图上绘制的子类比较多，所以这里画了一个简单的图，看起来更清晰，虚线框代表里面的类实现了相应的协议。到这里，涉及到 MapKit 的显示以及交互部分基本就都覆盖到了，下一篇文章会介绍如何利用 MapKit 搜索感兴趣的地方，并进行路径规划，显示在地图上。参考 MapKit Location and Maps Programming Guide MapKit Tutorial: Getting Started " }, { "title": "iOS 项目国际化 Localization", "url": "/posts/ios-localization/", "categories": "iOS", "tags": "localization", "date": "2020-12-15 20:00:00 +0800", "snippet": "随着 Apple 对多语言用户使用体验的不断提升，从 iOS13 开始用户可以在应用设置中单独设置区别于系统的语言，同时对于开发者来说，对于多语言的适配体验也在不断的得到提升，本文将逐步说明如何对 iOS 项目做国际化支持。添加支持的语言支持国际化的第一步是添加我们想要支持的语言，选中 Project - Info ，在 Localizations 下面可以添加语言。如果项目中存在可国际化的文件，比如 Storyboard / xib，下一步会让我们选择需要创建的文件，这时我们选择 Localizable Strings，如果选择 Interface Builder Storyboard 将会新建额外的 Storyboard ，意味着我们在支持不同语言的同时，还要为不同的语言创建不同的界面，这一般不是我们想要的。完成之后，将会为每一个 Storyboard / xib 新建一个 strings 文件，并统一放在该语言的文件下，我们暂时不去翻译它们。为你的资源添加国际化支持项目中使用的图片、颜色、音频、视频等资源文件，可能都需要支持国际化，选中资源，在 Inspector - Localization 下面，可以添加我们想要支持的语言。添加对应语言的资源文件，到这我们完成了项目中所有资源的国际化支持。导出需要支持国际化的文件在添加完资源文件之后，接下来就是对字符串进行国际化支持了。选中 Project - Editor - Export for Localization，导出 .xcloc (Xcode Localization Catalog) 文件。导出的 zh-Hans.xcloc 包含以下内容： 文件 描述 contents.json 一个包含目录元数据的 json 文件，例如开发工具信息，目录版本等 Localized Contents 包含需要国际化支持资源的文件夹，重要的 xliff 文件就在这里 Source Contents 包含生成国际化资源的源文件，主要是为翻译人员提供上下文 Notes 给翻译人员提供的附加信息，例如截屏等 Xcode 将我们源代码中传给 SwiftUI Text , NSLocalizedString 以及类似 API 中的字符串，storyboard, XIB, strings 等中的字符串提取出来，放在了一个 xliff (XML Localization Interchange File Format) 文件中。下一步就是对这个文件中的字符串进行翻译了。翻译字符这一步我们使用 Poedit 进行翻译，一个开源的跨平台翻译编辑器。可以看到这个文件包含了我们在代码中用到的字符串、在 Storyboard 中用到的字符串、应用的名称以及获取权限时的说明，非常的全面，我们对它们逐一进行翻译。导入支持国际化之后的文件选中 Project - Editor - Import Localizations，导入 .xcloc 文件。如果存在没有国际化的信息，Xcode 会有 Warning 提示。如果我们想要在导入之前查看所有改动，点击文件图标，选中对应的文件就能看到，左边是我们即将导入的文件，右边是当前项目的文件。导入之后 Xcode 为我们新建了 InfoPlist.strings 文件，包含了 CFBundleName 以及 NSPhotoLibraryUsageDescription Localizable.strings 文件，包含了我们代码中用到的字符我们以后有新的字符串需要支持国际化时，也可以直接修改以上的文件，在文件中定义 key 和相应的文字。App Store 信息我们还应该为我们应用在 App Store 中展示的信息做国际化支持，如果我们只提供一种语言支持，那么在所有应用可销售区域，将只显示一种语言。添加语言在 App Store 中选中 App，点击右上角的首选语言，可以添加我们想要支持的语言编辑信息在相应的语言对应的界面中，编辑应用信息，包含不同的 Screenshots。修改首选语言在添加过语言之后，可以在 App 的 General Information 信息中，修改首选语言。Demo参考 Creating Great Localized Experiences with Xcode 11 Localizing Your App Xcode Help: Localize your app" } ]
